<?xml version="1.0" encoding="utf-8"?>
<package xmlns="http://ns.saxonica.com/xslt/export" xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:vv="http://saxon.sf.net/generated-variable" xmlns:java-type="http://saxon.sf.net/java-type" version="30" packageVersion="1" saxonVersion="9.8.0.12" target="JS" targetVersion="1" relocatable="true">
 <co id="0" binds="1 2">
  <template name="Q{}getItemForBinding" flags="os" line="3375" module="saxon-xforms.xsl" slots="4">
   <sequence role="body" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="3376">
    <param name="Q{}bindingi" slot="0" as="node()?">
     <empty role="select"/>
     <treat role="conversion" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="8|0|XTTE0590|bindingi">
      <check card="?" diag="8|0|XTTE0590|bindingi">
       <supplied slot="0"/>
      </check>
     </treat>
    </param>
    <param line="3377" name="Q{}instances" slot="1" flags="t" as="element()*">
     <empty role="select"/>
     <treat role="conversion" as="element()" jsTest="return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1;" diag="8|0|XTTE0590|instances">
      <supplied slot="1"/>
     </treat>
    </param>
    <choose line="3379">
     <and op="and">
      <fn name="exists">
       <varRef name="bindingi" slot="0"/>
      </fn>
      <fn name="exists">
       <slash simple="1">
        <varRef name="bindingi" slot="0"/>
        <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
       </slash>
      </fn>
     </and>
     <let line="3380" var="instance-map" as="map(xs:string, xs:string)" slot="2" eval="7">
      <ufCall name="Q{http://www.w3.org/2002/xforms}getInstanceMap" tailCall="false" bSlot="0" eval="4">
       <check card="1" diag="0|0||xforms:getInstanceMap">
        <cvUntyped to="xs:string">
         <data>
          <slash simple="1">
           <varRef name="bindingi" slot="0"/>
           <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
          </slash>
         </data>
        </cvUntyped>
       </check>
      </ufCall>
      <let line="3384" var="this-instance" as="element()?" slot="3" eval="9">
       <callT line="3385" name="getInstance" bSlot="1">
        <withParam name="Q{}instance-id" flags="c" as="xs:string">
         <check line="3386" card="1" diag="8|0|XTTE0590|instance-id">
          <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
           <varRef name="instance-map" slot="2"/>
           <str val="instance-id"/>
          </ifCall>
         </check>
        </withParam>
       </callT>
       <evaluate line="3392" dxns="">
        <check role="xpath" card="1" diag="4|0||xsl:evaluate/xpath">
         <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
          <varRef name="instance-map" slot="2"/>
          <str val="xpath"/>
         </ifCall>
        </check>
        <varRef role="cxt" name="this-instance" slot="3"/>
        <str role="sa" val="no"/>
        <map role="wp" size="0"/>
       </evaluate>
      </let>
     </let>
     <true/>
     <slash line="3397" simple="1">
      <first>
       <varRef name="instances" slot="1"/>
      </first>
      <axis name="child" nodeTest="element()" jsTest="return item.nodeType===1;"/>
     </slash>
    </choose>
   </sequence>
  </template>
 </co>
 <co id="3" binds="">
  <mode name="Q{}xforms-action-map" onNo="TC" flags="W" patternSlots="0">
   <templateRule prec="0" prio="-0.25" seq="0" rank="0" minImp="0" slots="2" flags="s" line="2825" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="Q{http://www.w3.org/2002/xforms}*" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1&amp;&amp;q.uri==='http://www.w3.org/2002/xforms'"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2826">
     <param name="Q{}nodeset" slot="0">
      <str role="select" val=""/>
      <supplied role="conversion" slot="0"/>
     </param>
     <ifCall line="2827" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
      <fn name="local-name">
       <dot type="Q{http://www.w3.org/2002/xforms}*"/>
      </fn>
      <let line="2829" var="array" as="map(xs:string, xs:string)*" slot="1" eval="8">
       <forEach line="2830">
        <currentGroup/>
        <ifCall line="2834" name="Q{http://www.w3.org/2005/xpath-functions/map}merge" type="map(*)">
         <sequence>
          <choose>
           <fn name="exists">
            <slash simple="1">
             <treat as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="14|2|XPTY0020|">
              <dot/>
             </treat>
             <axis name="attribute" nodeTest="attribute(Q{}value)" jsTest="return item.name==='value'"/>
            </slash>
           </fn>
           <ifCall line="2835" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
            <str val="@value"/>
            <fn name="string">
             <slash simple="1">
              <treat as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="14|2|XPTY0020|">
               <dot/>
              </treat>
              <axis name="attribute" nodeTest="attribute(Q{}value)" jsTest="return item.name==='value'"/>
             </slash>
            </fn>
           </ifCall>
          </choose>
          <choose line="2838">
           <and op="and">
            <fn name="empty">
             <slash simple="1">
              <treat as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="14|2|XPTY0020|">
               <dot/>
              </treat>
              <axis name="attribute" nodeTest="attribute(Q{}value)" jsTest="return item.name==='value'"/>
             </slash>
            </fn>
            <fn name="exists">
             <slash simple="1">
              <treat as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="1|0|XPTY0019|/">
               <dot/>
              </treat>
              <axis name="child" nodeTest="text()" jsTest="return item.nodeType===3;"/>
             </slash>
            </fn>
           </and>
           <ifCall line="2839" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
            <str val="value"/>
            <fn name="string">
             <dot/>
            </fn>
           </ifCall>
          </choose>
          <choose line="2842">
           <fn name="exists">
            <slash simple="1">
             <treat as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="14|2|XPTY0020|">
              <dot/>
             </treat>
             <axis name="attribute" nodeTest="attribute(Q{}ref)" jsTest="return item.name==='ref'"/>
            </slash>
           </fn>
           <ifCall line="2843" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
            <str val="ref"/>
            <fn name="string">
             <slash simple="1">
              <treat as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="14|2|XPTY0020|">
               <dot/>
              </treat>
              <axis name="attribute" nodeTest="attribute(Q{}ref)" jsTest="return item.name==='ref'"/>
             </slash>
            </fn>
           </ifCall>
          </choose>
          <choose line="2846">
           <fn name="exists">
            <slash simple="1">
             <treat as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="14|2|XPTY0020|">
              <dot/>
             </treat>
             <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
            </slash>
           </fn>
           <ifCall line="2847" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
            <str val="ref"/>
            <fn name="string">
             <slash simple="1">
              <treat as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="14|2|XPTY0020|">
               <dot/>
              </treat>
              <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
             </slash>
            </fn>
           </ifCall>
          </choose>
          <choose line="2850">
           <fn name="exists">
            <slash simple="1">
             <treat as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="14|2|XPTY0020|">
              <dot/>
             </treat>
             <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
            </slash>
           </fn>
           <ifCall line="2851" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
            <str val="position"/>
            <fn name="string">
             <slash simple="1">
              <treat as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="14|2|XPTY0020|">
               <dot/>
              </treat>
              <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
             </slash>
            </fn>
           </ifCall>
          </choose>
          <choose line="2855">
           <fn name="exists">
            <slash simple="1">
             <treat as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="14|2|XPTY0020|">
              <dot/>
             </treat>
             <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
            </slash>
           </fn>
           <ifCall line="2856" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
            <str val="at"/>
            <fn name="string">
             <slash simple="1">
              <treat as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="14|2|XPTY0020|">
               <dot/>
              </treat>
              <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
             </slash>
            </fn>
           </ifCall>
          </choose>
          <choose line="2859">
           <fn name="exists">
            <slash simple="1">
             <treat as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="14|2|XPTY0020|">
              <dot/>
             </treat>
             <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
            </slash>
           </fn>
           <ifCall line="2860" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
            <str val="if"/>
            <fn name="string">
             <slash simple="1">
              <treat as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="14|2|XPTY0020|">
               <dot/>
              </treat>
              <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
             </slash>
            </fn>
           </ifCall>
          </choose>
          <choose line="2863">
           <fn name="exists">
            <slash simple="1">
             <treat as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="14|2|XPTY0020|">
              <dot/>
             </treat>
             <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
            </slash>
           </fn>
           <ifCall line="2864" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
            <str val="while"/>
            <fn name="string">
             <slash simple="1">
              <treat as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="14|2|XPTY0020|">
               <dot/>
              </treat>
              <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
             </slash>
            </fn>
           </ifCall>
          </choose>
          <choose line="2868">
           <fn name="exists">
            <slash simple="1">
             <treat as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="14|2|XPTY0020|">
              <dot/>
             </treat>
             <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
            </slash>
           </fn>
           <ifCall line="2869" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
            <str val="event"/>
            <fn name="string">
             <check card="?" diag="0|0||fn:string">
              <slash simple="1">
               <treat as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="14|2|XPTY0020|">
                <dot/>
               </treat>
               <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
              </slash>
             </check>
            </fn>
           </ifCall>
          </choose>
         </sequence>
         <map size="2">
          <str val="duplicates"/>
          <str val="reject"/>
          <str val="duplicates-error-code"/>
          <str val="XTDE3365"/>
         </map>
        </ifCall>
       </forEach>
       <ifCall line="2876" name="Q{http://www.w3.org/2005/xpath-functions/array}_from-sequence" type="array(*)">
        <varRef name="array" slot="1"/>
       </ifCall>
      </let>
     </ifCall>
    </sequence>
   </templateRule>
  </mode>
 </co>
 <co id="4" binds="5">
  <mode name="Q{}form-check-initial" onNo="TC" flags="W" patternSlots="0">
   <templateRule prec="0" prio="-0.5" seq="0" rank="0" minImp="0" slots="1" flags="s" line="3027" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element()" jsTest="return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1;"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="3028">
     <param name="Q{}pendingUpdates" slot="0" as="map(xs:string, xs:string)?">
      <empty role="select"/>
      <treat role="conversion" as="map(xs:string, xs:string)" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.Atomic.string.matches(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|pendingUpdates">
       <check card="?" diag="8|0|XTTE0590|pendingUpdates">
        <supplied slot="0"/>
       </check>
      </treat>
     </param>
     <copy line="3034" flags="cin">
      <applyT role="content" mode="Q{}form-check" bSlot="0">
       <dot role="select" type="element()"/>
       <withParam name="Q{}pendingUpdates" as="map(xs:string, xs:string)?">
        <varRef line="3035" name="pendingUpdates" slot="0"/>
       </withParam>
      </applyT>
     </copy>
    </sequence>
   </templateRule>
  </mode>
 </co>
 <co id="5" binds="5 6 5 5 6">
  <mode name="Q{}form-check" onNo="TC" flags="W" patternSlots="0">
   <templateRule prec="0" prio="-0.5" seq="0" rank="0" minImp="0" slots="10" flags="s" line="3040" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element()" jsTest="return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1;"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="3041">
     <param name="Q{}curPath" slot="0">
      <str role="select" val=""/>
      <supplied role="conversion" slot="0"/>
     </param>
     <param line="3042" name="Q{}position" slot="1">
      <int role="select" val="0"/>
      <supplied role="conversion" slot="1"/>
     </param>
     <param line="3043" name="Q{}pendingUpdates" slot="2" as="map(xs:string, xs:string)?">
      <empty role="select"/>
      <treat role="conversion" as="map(xs:string, xs:string)" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.Atomic.string.matches(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|pendingUpdates">
       <check card="?" diag="8|0|XTTE0590|pendingUpdates">
        <supplied slot="2"/>
       </check>
      </treat>
     </param>
     <let line="3055" var="updatedPath" as="xs:string" slot="3" eval="7">
      <choose>
       <gc op="&gt;" card="N:1" comp="GAC|http://www.w3.org/2005/xpath-functions/collation/codepoint">
        <data>
         <varRef name="position" slot="1"/>
        </data>
        <int val="0"/>
       </gc>
       <fn name="concat">
        <atomSing card="?" diag="0|0||fn:concat">
         <varRef name="curPath" slot="0"/>
        </atomSing>
        <fn name="local-name">
         <dot type="element()"/>
        </fn>
        <str val="["/>
        <atomSing card="?" diag="0|3||fn:concat">
         <varRef name="position" slot="1"/>
        </atomSing>
        <str val="]"/>
       </fn>
       <true/>
       <fn name="concat">
        <atomSing card="?" diag="0|0||fn:concat">
         <varRef name="curPath" slot="0"/>
        </atomSing>
        <fn name="local-name">
         <dot type="element()"/>
        </fn>
       </fn>
      </choose>
      <sequence line="3063">
       <applyT mode="Q{}form-check" bSlot="0">
        <axis role="select" name="attribute" nodeTest="attribute()" jsTest="return SaxonJS.U.isAttr(item)"/>
        <withParam name="Q{}curPath" as="xs:string">
         <fn line="3064" name="concat">
          <varRef name="updatedPath" slot="3"/>
          <str val="/"/>
         </fn>
        </withParam>
        <withParam name="Q{}pendingUpdates" as="map(xs:string, xs:string)?">
         <varRef line="3065" name="pendingUpdates" slot="2"/>
        </withParam>
       </applyT>
       <let line="3071" var="associated-form-control" as="node()*" slot="4" eval="8">
        <slash>
         <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}page" type="document-node()?"/>
         <fn name="key">
          <str val="Q{http://saxon.sf.net/}kk101"/>
          <varRef name="updatedPath" slot="3"/>
          <dot type="document-node()"/>
         </fn>
        </slash>
        <sequence line="3074">
         <choose>
          <fn name="exists">
           <varRef name="associated-form-control" slot="4"/>
          </fn>
          <valueOf line="3078">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <applyT mode="Q{}get-field" bSlot="1">
                <varRef role="select" name="associated-form-control" slot="4"/>
               </applyT>
              </mergeAdj>
             </data>
            </convert>
            <str val=""/>
           </fn>
          </valueOf>
          <and line="3081" op="and">
           <fn name="exists">
            <varRef name="pendingUpdates" slot="2"/>
           </fn>
           <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}contains" type="xs:boolean">
            <check card="1" diag="0|0||map:contains">
             <varRef name="pendingUpdates" slot="2"/>
            </check>
            <varRef name="updatedPath" slot="3"/>
           </ifCall>
          </and>
          <valueOf line="3089">
           <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
            <check card="1" diag="0|0||map:get">
             <varRef name="pendingUpdates" slot="2"/>
            </check>
            <varRef name="updatedPath" slot="3"/>
           </ifCall>
          </valueOf>
          <true/>
          <valueOf line="3099">
           <fn name="normalize-space">
            <fn name="string-join">
             <data>
              <axis name="child" nodeTest="text()" jsTest="return item.nodeType===3;"/>
             </data>
             <str val=""/>
            </fn>
           </fn>
          </valueOf>
         </choose>
         <forEachGroup line="3106" algorithm="by">
          <axis role="select" name="child" nodeTest="element()" jsTest="return item.nodeType===1;"/>
          <fn role="key" name="local-name">
           <dot type="element()"/>
          </fn>
          <str role="collation" val="http://www.w3.org/2005/xpath-functions/collation/codepoint"/>
          <let role="content" line="3108" var="updatedChildPath" as="xs:string" slot="5" eval="8">
           <fn name="concat">
            <varRef name="updatedPath" slot="3"/>
            <str val="/"/>
            <check card="?" diag="0|2||fn:concat">
             <currentGroupingKey/>
            </check>
           </fn>
           <let line="3113" var="vv:v0" as="xs:string" slot="6" eval="13">
            <fn name="concat">
             <varRef name="updatedChildPath" slot="5"/>
             <str val="["/>
            </fn>
            <let var="dataRefWithFilter" as="element()*" slot="7" eval="8">
             <filter flags="b">
              <slash simple="1">
               <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}page" type="document-node()?"/>
               <axis name="descendant" nodeTest="element()" jsTest="return item.nodeType===1;"/>
              </slash>
              <fn name="starts-with">
               <cvUntyped to="xs:string">
                <attVal name="Q{}data-ref" chk="0"/>
               </cvUntyped>
               <varRef name="vv:v0" slot="6"/>
              </fn>
             </filter>
             <choose line="3116">
              <or op="or">
               <fn name="exists">
                <tail start="2">
                 <currentGroup/>
                </tail>
               </fn>
               <fn name="exists">
                <varRef name="dataRefWithFilter" slot="7"/>
               </fn>
              </or>
              <let line="3121" var="vv:v1" as="xs:string" slot="8" eval="13">
               <fn name="concat">
                <varRef name="updatedPath" slot="3"/>
                <str val="/"/>
               </fn>
               <forEach line="3118">
                <currentGroup/>
                <copy line="3120" flags="cin">
                 <applyT role="content" mode="Q{}form-check" bSlot="2">
                  <dot role="select"/>
                  <withParam name="Q{}curPath" as="xs:string">
                   <varRef line="3121" name="vv:v1" slot="8"/>
                  </withParam>
                  <withParam name="Q{}position" as="xs:integer">
                   <fn line="3122" name="position"/>
                  </withParam>
                  <withParam name="Q{}pendingUpdates" as="map(xs:string, xs:string)?">
                   <varRef line="3123" name="pendingUpdates" slot="2"/>
                  </withParam>
                 </applyT>
                </copy>
               </forEach>
              </let>
              <true/>
              <let line="3135" var="vv:v2" as="xs:string" slot="9" eval="13">
               <fn name="concat">
                <varRef name="updatedPath" slot="3"/>
                <str val="/"/>
               </fn>
               <forEach line="3132">
                <currentGroup/>
                <copy line="3134" flags="cin">
                 <applyT role="content" mode="Q{}form-check" bSlot="3">
                  <dot role="select"/>
                  <withParam name="Q{}curPath" as="xs:string">
                   <varRef line="3135" name="vv:v2" slot="9"/>
                  </withParam>
                  <withParam name="Q{}pendingUpdates" as="map(xs:string, xs:string)?">
                   <varRef line="3136" name="pendingUpdates" slot="2"/>
                  </withParam>
                 </applyT>
                </copy>
               </forEach>
              </let>
             </choose>
            </let>
           </let>
          </let>
         </forEachGroup>
        </sequence>
       </let>
      </sequence>
     </let>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="-0.5" seq="1" rank="0" minImp="0" slots="4" flags="s" line="3149" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="attribute()" jsTest="return SaxonJS.U.isAttr(item)"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="3150">
     <param name="Q{}curPath" slot="0">
      <str role="select" val=""/>
      <supplied role="conversion" slot="0"/>
     </param>
     <param line="3151" name="Q{}pendingUpdates" slot="1" as="map(xs:string, xs:string)?">
      <empty role="select"/>
      <treat role="conversion" as="map(xs:string, xs:string)" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.Atomic.string.matches(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|pendingUpdates">
       <check card="?" diag="8|0|XTTE0590|pendingUpdates">
        <supplied slot="1"/>
       </check>
      </treat>
     </param>
     <let line="3152" var="updatedPath" as="xs:string" slot="2" eval="8">
      <fn name="concat">
       <atomSing card="?" diag="0|0||fn:concat">
        <varRef name="curPath" slot="0"/>
       </atomSing>
       <str val="@"/>
       <fn name="local-name">
        <dot type="attribute()"/>
       </fn>
      </fn>
      <let line="3161" var="associated-form-control" as="node()*" slot="3" eval="8">
       <slash>
        <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}page" type="document-node()?"/>
        <fn name="key">
         <str val="Q{http://saxon.sf.net/}kk101"/>
         <varRef name="updatedPath" slot="2"/>
         <dot type="document-node()"/>
        </fn>
       </slash>
       <choose line="3164">
        <fn name="exists">
         <varRef name="associated-form-control" slot="3"/>
        </fn>
        <compAtt line="3167">
         <fn role="name" name="local-name">
          <dot type="attribute()"/>
         </fn>
         <fn role="select" line="3169" name="string-join">
          <convert from="xs:anyAtomicType" to="xs:string">
           <data>
            <mergeAdj>
             <applyT mode="Q{}get-field" bSlot="4">
              <varRef role="select" name="associated-form-control" slot="3"/>
             </applyT>
            </mergeAdj>
           </data>
          </convert>
          <str val=""/>
         </fn>
        </compAtt>
        <and line="3172" op="and">
         <fn name="exists">
          <varRef name="pendingUpdates" slot="1"/>
         </fn>
         <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}contains" type="xs:boolean">
          <check card="1" diag="0|0||map:contains">
           <varRef name="pendingUpdates" slot="1"/>
          </check>
          <varRef name="updatedPath" slot="2"/>
         </ifCall>
        </and>
        <compAtt line="3173">
         <fn role="name" name="local-name">
          <dot type="attribute()"/>
         </fn>
         <ifCall role="select" line="3174" name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
          <check card="1" diag="0|0||map:get">
           <varRef name="pendingUpdates" slot="1"/>
          </check>
          <varRef name="updatedPath" slot="2"/>
         </ifCall>
        </compAtt>
        <true/>
        <forEach line="3178">
         <dot type="attribute()"/>
         <copy flags="cin">
          <empty role="content"/>
         </copy>
        </forEach>
       </choose>
      </let>
     </let>
    </sequence>
   </templateRule>
  </mode>
 </co>
 <co id="7" binds="7">
  <mode name="Q{}update-ref" onNo="TC" flags="W" patternSlots="0">
   <templateRule prec="0" prio="-0.5" seq="2" rank="0" minImp="0" slots="2" flags="s" line="2078" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element()" jsTest="return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1;"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2079">
     <param name="Q{}path" slot="0" as="xs:string">
      <str role="select" val=""/>
      <treat role="conversion" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="8|0|XTTE0590|path">
       <check card="1" diag="8|0|XTTE0590|path">
        <cvUntyped to="xs:string">
         <data>
          <supplied slot="0"/>
         </data>
        </cvUntyped>
       </check>
      </treat>
     </param>
     <param line="2080" name="Q{}position" slot="1">
      <int role="select" val="0"/>
      <supplied role="conversion" slot="1"/>
     </param>
     <copy line="2083" flags="cin">
      <applyT role="content" mode="Q{}update-ref" bSlot="0">
       <sequence role="select">
        <axis name="attribute" nodeTest="attribute()" jsTest="return SaxonJS.U.isAttr(item)"/>
        <axis name="child" nodeTest="( element() | text() | comment() | processing-instruction() )" jsTest="return SaxonJS.U.isNode(item) &amp;&amp; (item.nodeType===1 || item.nodeType===3 || item.nodeType===7 || item.nodeType===8);"/>
       </sequence>
       <withParam name="Q{}path" as="xs:string">
        <varRef line="2084" name="path" slot="0"/>
       </withParam>
       <withParam name="Q{}position">
        <varRef line="2085" name="position" slot="1"/>
       </withParam>
      </applyT>
     </copy>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="-0.5" seq="1" rank="0" minImp="0" slots="3" flags="s" line="2059" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="attribute()" jsTest="return SaxonJS.U.isAttr(item)"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2060">
     <param name="Q{}path" slot="0" as="xs:string">
      <str role="select" val=""/>
      <treat role="conversion" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="8|0|XTTE0590|path">
       <check card="1" diag="8|0|XTTE0590|path">
        <cvUntyped to="xs:string">
         <data>
          <supplied slot="0"/>
         </data>
        </cvUntyped>
       </check>
      </treat>
     </param>
     <param line="2061" name="Q{}position" slot="1">
      <int role="select" val="0"/>
      <supplied role="conversion" slot="1"/>
     </param>
     <let line="2063" var="path-updated" as="xs:string" slot="2" eval="7">
      <choose>
       <gc op="&gt;" card="N:1" comp="GAC|http://www.w3.org/2005/xpath-functions/collation/codepoint">
        <data>
         <varRef name="position" slot="1"/>
        </data>
        <int val="0"/>
       </gc>
       <fn name="concat">
        <varRef name="path" slot="0"/>
        <str val="["/>
        <atomSing card="?" diag="0|2||fn:concat">
         <varRef name="position" slot="1"/>
        </atomSing>
        <str val="]"/>
       </fn>
       <true/>
       <varRef name="path" slot="0"/>
      </choose>
      <choose line="2067">
       <vc op="eq" onEmpty="0" comp="CCC">
        <fn name="substring">
         <cvUntyped to="xs:string">
          <data>
           <dot type="attribute()"/>
          </data>
         </cvUntyped>
         <int val="1"/>
         <fn line="2064" name="string-length">
          <varRef name="path" slot="0"/>
         </fn>
        </fn>
        <varRef name="path" slot="0"/>
       </vc>
       <compAtt line="2068">
        <fn role="name" line="2062" name="name">
         <dot type="attribute()"/>
        </fn>
        <convert role="select" line="2069" from="xs:untypedAtomic" to="xs:string">
         <cast as="xs:untypedAtomic" emptiable="0">
          <fn name="concat">
           <varRef name="path-updated" slot="2"/>
           <fn name="substring">
            <cvUntyped to="xs:string">
             <data>
              <dot type="attribute()"/>
             </data>
            </cvUntyped>
            <arith op="+" calc="i+i">
             <fn name="string-length">
              <varRef name="path-updated" slot="2"/>
             </fn>
             <int val="1"/>
            </arith>
           </fn>
          </fn>
         </cast>
        </convert>
       </compAtt>
       <true/>
       <copyOf line="2073" flags="vc">
        <dot type="attribute()"/>
       </copyOf>
      </choose>
     </let>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="2.0" seq="0" rank="1" minImp="0" slots="3" flags="s" line="2045" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="attribute(Q{}data-action)" jsTest="return SaxonJS.U.isAttr(item) &amp;&amp; item.name==='data-action'"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2046">
     <param name="Q{}path" slot="0" as="xs:string">
      <str role="select" val=""/>
      <treat role="conversion" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="8|0|XTTE0590|path">
       <check card="1" diag="8|0|XTTE0590|path">
        <cvUntyped to="xs:string">
         <data>
          <supplied slot="0"/>
         </data>
        </cvUntyped>
       </check>
      </treat>
     </param>
     <param line="2047" name="Q{}position" slot="1">
      <int role="select" val="0"/>
      <supplied role="conversion" slot="1"/>
     </param>
     <let line="2049" var="myid" as="xs:string" slot="2" eval="8">
      <fn name="concat">
       <fn name="generate-id">
        <dot type="attribute(Q{}data-action)"/>
       </fn>
       <atomSing card="?" diag="0|1||fn:concat">
        <varRef name="position" slot="1"/>
       </atomSing>
      </fn>
      <sequence line="2051">
       <att name="data-old-action">
        <convert from="xs:untypedAtomic" to="xs:string">
         <data>
          <dot type="attribute(Q{}data-action)"/>
         </data>
        </convert>
       </att>
       <att line="2054" name="data-action">
        <convert from="xs:untypedAtomic" to="xs:string">
         <cast as="xs:untypedAtomic" emptiable="0">
          <choose>
           <fn name="exists">
            <slash>
             <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}page" type="document-node()?"/>
             <fn name="key">
              <str val="Q{http://saxon.sf.net/}kk102"/>
              <varRef name="myid" slot="2"/>
              <dot type="document-node()"/>
             </fn>
            </slash>
           </fn>
           <fn name="concat">
            <fn name="generate-id">
             <dot type="attribute(Q{}data-action)"/>
            </fn>
            <fn name="generate-id">
             <dot type="attribute(Q{}data-action)"/>
            </fn>
           </fn>
           <true/>
           <varRef name="myid" slot="2"/>
          </choose>
         </cast>
        </convert>
       </att>
      </sequence>
     </let>
    </sequence>
   </templateRule>
  </mode>
 </co>
 <co id="8" binds="1 2">
  <template name="Q{}getReferencedInstanceField" flags="os" line="3403" module="saxon-xforms.xsl" slots="4">
   <sequence role="body" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="3404">
    <param name="Q{}refi" slot="0" as="xs:string">
     <str role="select" val=""/>
     <treat role="conversion" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="8|0|XTTE0590|refi">
      <check card="1" diag="8|0|XTTE0590|refi">
       <cvUntyped to="xs:string">
        <data>
         <supplied slot="0"/>
        </data>
       </cvUntyped>
      </check>
     </treat>
    </param>
    <param line="3405" name="Q{}instances" slot="1" flags="t" as="element()*">
     <empty role="select"/>
     <treat role="conversion" as="element()" jsTest="return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1;" diag="8|0|XTTE0590|instances">
      <supplied slot="1"/>
     </treat>
    </param>
    <choose line="3407">
     <varRef name="refi" slot="0"/>
     <let line="3408" var="instance-map" as="map(xs:string, xs:string)" slot="2" eval="7">
      <ufCall name="Q{http://www.w3.org/2002/xforms}getInstanceMap" tailCall="false" bSlot="0" eval="6">
       <varRef name="refi" slot="0"/>
      </ufCall>
      <sequence line="3409">
       <message>
        <sequence role="select">
         <valueOf>
          <str val="[getReferencedInstanceField] instance-map = "/>
         </valueOf>
         <valueOf>
          <fn name="serialize">
           <varRef name="instance-map" slot="2"/>
          </fn>
         </valueOf>
        </sequence>
        <str role="terminate" val="no"/>
        <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
       </message>
       <let line="3414" var="this-instance" as="element()?" slot="3" eval="9">
        <callT line="3415" name="getInstance" bSlot="1">
         <withParam name="Q{}instance-id" flags="c" as="xs:string">
          <check line="3416" card="1" diag="8|0|XTTE0590|instance-id">
           <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
            <varRef name="instance-map" slot="2"/>
            <str val="instance-id"/>
           </ifCall>
          </check>
         </withParam>
        </callT>
        <evaluate line="3422" dxns="">
         <check role="xpath" card="1" diag="4|0||xsl:evaluate/xpath">
          <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
           <varRef name="instance-map" slot="2"/>
           <str val="xpath"/>
          </ifCall>
         </check>
         <varRef role="cxt" name="this-instance" slot="3"/>
         <str role="sa" val="no"/>
         <map role="wp" size="0"/>
        </evaluate>
       </let>
      </sequence>
     </let>
    </choose>
   </sequence>
  </template>
 </co>
 <co id="9" binds="">
  <function name="Q{http://www.w3.org/2002/xforms}resolveXPathStrings" line="696" module="saxon-xforms.xsl" eval="7" flags="pU" as="xs:string" slots="6">
   <arg name="base" as="xs:string"/>
   <arg name="relative" as="xs:string"/>
   <let role="body" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="701" var="parentCallCount" as="xs:integer" slot="2" eval="7">
    <choose>
     <fn name="contains">
      <varRef name="relative" slot="1"/>
      <str val="/"/>
     </fn>
     <fn name="count">
      <filter flags="b">
       <fn name="tokenize">
        <varRef name="relative" slot="1"/>
        <str val="/"/>
        <str val=""/>
       </fn>
       <vc op="eq" comp="CCC">
        <dot type="xs:string"/>
        <str val=".."/>
       </vc>
      </filter>
     </fn>
     <fn name="contains">
      <varRef name="relative" slot="1"/>
      <str val=".."/>
     </fn>
     <int val="1"/>
     <true/>
     <int val="0"/>
    </choose>
    <let line="704" var="slashes" as="xs:integer*" slot="3" eval="3">
     <choose>
      <fn name="contains">
       <varRef name="base" slot="0"/>
       <str val="/"/>
      </fn>
      <fn name="index-of">
       <fn name="string-to-codepoints">
        <varRef name="base" slot="0"/>
       </fn>
       <int val="47"/>
      </fn>
      <true/>
      <int val="0"/>
     </choose>
     <check line="706" card="1" diag="5|0|XTTE0780|xforms:resolveXPathStrings">
      <sequence>
       <message>
        <sequence role="select">
         <valueOf>
          <str val="resolveXPathString base ="/>
         </valueOf>
         <valueOf>
          <varRef name="base" slot="0"/>
         </valueOf>
         <valueOf>
          <str val=" &#xA;            relative "/>
         </valueOf>
         <valueOf line="707">
          <varRef name="relative" slot="1"/>
         </valueOf>
         <valueOf>
          <str val="&#xA;            parentCallCount = "/>
         </valueOf>
         <valueOf line="708">
          <convert from="xs:integer" to="xs:string">
           <varRef name="parentCallCount" slot="2"/>
          </convert>
         </valueOf>
         <valueOf>
          <str val="&#xA;            slashes = "/>
         </valueOf>
         <valueOf line="709">
          <fn name="string-join">
           <convert from="xs:integer" to="xs:string">
            <varRef name="slashes" slot="3"/>
           </convert>
           <str val=" "/>
          </fn>
         </valueOf>
        </sequence>
        <str role="terminate" val="no"/>
        <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
       </message>
       <let line="713" var="parentSlash" as="xs:integer" slot="4" eval="7">
        <choose line="715">
         <and op="and">
          <vc op="ge" onEmpty="0" comp="CAVC">
           <fn name="count">
            <varRef name="slashes" slot="3"/>
           </fn>
           <varRef name="parentCallCount" slot="2"/>
          </vc>
          <compareToInt op="gt" val="0">
           <varRef name="parentCallCount" slot="2"/>
          </compareToInt>
         </and>
         <let line="716" var="vv:v0" as="xs:integer" slot="5" eval="13">
          <arith op="-" calc="i-i">
           <varRef name="parentCallCount" slot="2"/>
           <int val="1"/>
          </arith>
          <check card="1" diag="3|0|XTTE0570|parentSlash">
           <filter flags="p">
            <varRef name="slashes" slot="3"/>
            <arith op="-" calc="i-i">
             <fn name="last"/>
             <varRef name="vv:v0" slot="5"/>
            </arith>
           </filter>
          </check>
         </let>
         <true/>
         <check line="719" card="1" diag="3|0|XTTE0570|parentSlash">
          <lastOf>
           <varRef name="slashes" slot="3"/>
          </lastOf>
         </check>
        </choose>
        <sequence line="723">
         <message>
          <sequence role="select">
           <valueOf>
            <str val="resolveXPathString base ="/>
           </valueOf>
           <valueOf>
            <varRef name="base" slot="0"/>
           </valueOf>
           <valueOf>
            <str val=" lastSlash "/>
           </valueOf>
           <valueOf>
            <convert from="xs:integer" to="xs:string">
             <varRef name="parentSlash" slot="4"/>
            </convert>
           </valueOf>
           <valueOf>
            <str val=" relative "/>
           </valueOf>
           <valueOf>
            <varRef name="relative" slot="1"/>
           </valueOf>
           <valueOf>
            <str val=" &#xA;        &#xA;        countparent = "/>
           </valueOf>
           <valueOf line="725">
            <convert from="xs:integer" to="xs:string">
             <varRef name="parentCallCount" slot="2"/>
            </convert>
           </valueOf>
           <choose line="726">
            <compareToInt op="gt" val="0">
             <varRef name="parentCallCount" slot="2"/>
            </compareToInt>
            <sequence>
             <valueOf>
              <str val="&#xA;                base without parent nodes = "/>
             </valueOf>
             <valueOf line="727">
              <fn name="substring">
               <varRef name="base" slot="0"/>
               <int val="1"/>
               <varRef name="parentSlash" slot="4"/>
              </fn>
             </valueOf>
             <valueOf>
              <str val="&#xA;                relativeCut = "/>
             </valueOf>
             <valueOf line="728">
              <fn name="replace">
               <varRef name="relative" slot="1"/>
               <str val="\.\./"/>
               <str val=""/>
               <str val=""/>
              </fn>
             </valueOf>
            </sequence>
           </choose>
          </sequence>
          <str role="terminate" val="no"/>
          <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
         </message>
         <choose line="734">
          <compareToInt op="gt" val="0">
           <varRef name="parentCallCount" slot="2"/>
          </compareToInt>
          <fn line="738" name="concat">
           <fn name="substring">
            <varRef name="base" slot="0"/>
            <int val="1"/>
            <varRef name="parentSlash" slot="4"/>
           </fn>
           <fn name="replace">
            <varRef name="relative" slot="1"/>
            <str val="\.\./"/>
            <str val=""/>
            <str val=""/>
           </fn>
          </fn>
          <true/>
          <fn line="741" name="concat">
           <varRef name="base" slot="0"/>
           <str val="/"/>
           <varRef name="relative" slot="1"/>
          </fn>
         </choose>
        </sequence>
       </let>
      </sequence>
     </check>
    </let>
   </let>
  </function>
 </co>
 <co id="10" binds="">
  <function name="Q{http://saxonica.com/ns/forms-local}current-date" line="78" module="xforms-function-library.xsl" eval="7" flags="pU" as="xs:string" slots="0">
   <treat role="body" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="79" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="3|0|XTTE0570|today">
    <check card="1" diag="3|0|XTTE0570|today">
     <cvUntyped to="xs:string">
      <data>
       <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
        <check card="1" diag="0|0||ixsl:call">
         <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
        </check>
        <str val="getCurrentDate"/>
        <arrayBlock/>
       </ifCall>
      </data>
     </cvUntyped>
    </check>
   </treat>
  </function>
 </co>
 <co id="11" binds="12 13">
  <template name="Q{}main2" flags="os" line="32" module="sample3.xsl" slots="0">
   <callT role="body" ns="xsl=~ xforms=http://www.w3.org/2002/xforms array=http://www.w3.org/2005/xpath-functions/array f=http://www.saxonica.com/local/functions ixsl=~ js=~ xs=~ saxon=~ map=http://www.w3.org/2005/xpath-functions/map" line="33" name="xformsjs-main" bSlot="0" flags="t">
    <withParam name="Q{}xforms-doc" flags="c" as="document-node()">
     <fn line="34" name="doc">
      <gVarRef name="Q{}sampleForm" bSlot="1"/>
     </fn>
    </withParam>
    <withParam name="Q{}xFormsId" flags="c" as="xs:string">
     <str val="xForm"/>
    </withParam>
   </callT>
  </template>
 </co>
 <co id="14" binds="14 14">
  <mode name="Q{}insert-node" onNo="TC" flags="W" patternSlots="0">
   <templateRule prec="0" prio="-0.5" seq="0" rank="0" minImp="0" slots="11" flags="s" line="1956" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element()" jsTest="return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1;"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="1957">
     <param name="Q{}insert-node" slot="0" flags="i" as="node()">
      <treat role="conversion" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="8|0|XTTE0590|insert-node">
       <check card="1" diag="8|0|XTTE0590|insert-node">
        <supplied slot="0"/>
       </check>
      </treat>
     </param>
     <param line="1958" name="Q{}path" slot="1" as="xs:string">
      <str role="select" val=""/>
      <treat role="conversion" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="8|0|XTTE0590|path">
       <check card="1" diag="8|0|XTTE0590|path">
        <cvUntyped to="xs:string">
         <data>
          <supplied slot="1"/>
         </data>
        </cvUntyped>
       </check>
      </treat>
     </param>
     <param line="1959" name="Q{}current-path" slot="2" as="xs:string">
      <str role="select" val=""/>
      <treat role="conversion" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="8|0|XTTE0590|current-path">
       <check card="1" diag="8|0|XTTE0590|current-path">
        <cvUntyped to="xs:string">
         <data>
          <supplied slot="2"/>
         </data>
        </cvUntyped>
       </check>
      </treat>
     </param>
     <let line="1960" var="updatedPath" as="xs:string" slot="3" eval="8">
      <fn name="concat">
       <varRef name="current-path" slot="2"/>
       <str val="/"/>
       <fn name="local-name">
        <dot type="element()"/>
       </fn>
      </fn>
      <let line="1962" var="name" as="xs:string" slot="4" eval="8">
       <fn name="local-name">
        <dot type="element()"/>
       </fn>
       <let line="1964" var="currentPosition" as="xs:integer" slot="5" eval="7">
        <let var="vv:current585323788" as="element()" slot="6" eval="7">
         <dot type="element()"/>
         <let var="vv:v0" as="xs:string" slot="7" eval="13">
          <fn name="local-name">
           <varRef name="vv:current585323788" slot="6"/>
          </fn>
          <arith op="+" calc="i+i">
           <fn name="count">
            <filter flags="b">
             <slash simple="1">
              <dot type="element()"/>
              <axis name="preceding-sibling" nodeTest="element()" jsTest="return item.nodeType===1;"/>
             </slash>
             <vc op="eq" comp="CCC">
              <fn name="local-name">
               <dot type="element()"/>
              </fn>
              <varRef name="vv:v0" slot="7"/>
             </vc>
            </filter>
           </fn>
           <int val="1"/>
          </arith>
         </let>
        </let>
        <let line="1967" var="updatedPath2" as="document-node()" slot="8" eval="7">
         <doc line="1968" flags="t" validation="preserve">
          <sequence>
           <valueOf flags="l">
            <varRef name="updatedPath" slot="3"/>
           </valueOf>
           <choose line="1970">
            <fn name="exists">
             <let var="vv:current-28121473" as="element()" slot="9" eval="7">
              <dot type="element()"/>
              <let var="vv:v1" as="xs:string" slot="10" eval="13">
               <fn name="local-name">
                <varRef name="vv:current-28121473" slot="9"/>
               </fn>
               <filter flags="b">
                <union op="|">
                 <fn name="reverse">
                  <slash simple="1">
                   <dot type="element()"/>
                   <axis name="preceding-sibling" nodeTest="element()" jsTest="return item.nodeType===1;"/>
                  </slash>
                 </fn>
                 <axis name="following-sibling" nodeTest="element()" jsTest="return item.nodeType===1;"/>
                </union>
                <vc op="eq" comp="CCC">
                 <fn name="local-name">
                  <dot type="element()"/>
                 </fn>
                 <varRef name="vv:v1" slot="10"/>
                </vc>
               </filter>
              </let>
             </let>
            </fn>
            <valueOf line="1971" flags="l">
             <fn name="concat">
              <str val="["/>
              <varRef name="currentPosition" slot="5"/>
              <str val="]"/>
             </fn>
            </valueOf>
           </choose>
          </sequence>
         </doc>
         <choose line="1977">
          <and op="and">
           <vc op="eq" onEmpty="0" comp="CCC">
            <varRef name="updatedPath" slot="3"/>
            <varRef name="path" slot="1"/>
           </vc>
           <vc line="1966" op="eq" onEmpty="0" comp="GAC|http://www.w3.org/2005/xpath-functions/collation/codepoint">
            <fn name="count">
             <filter flags="b">
              <slash>
               <axis name="parent" nodeTest="element()" jsTest="return item.nodeType===1;"/>
               <axis name="child" nodeTest="element()" jsTest="return item.nodeType===1;"/>
              </slash>
              <vc op="eq" comp="CCC">
               <fn name="local-name">
                <dot type="element()"/>
               </fn>
               <varRef name="name" slot="4"/>
              </vc>
             </filter>
            </fn>
            <varRef name="currentPosition" slot="5"/>
           </vc>
          </and>
          <sequence line="1981">
           <copy flags="cin">
            <applyT role="content" mode="Q{}insert-node" bSlot="0">
             <axis role="select" name="child" nodeTest="( element() | text() | comment() | processing-instruction() )" jsTest="return SaxonJS.U.isNode(item) &amp;&amp; (item.nodeType===1 || item.nodeType===3 || item.nodeType===7 || item.nodeType===8);"/>
             <withParam name="Q{}insert-node" as="node()">
              <varRef line="1983" name="insert-node" slot="0"/>
             </withParam>
             <withParam name="Q{}path" as="xs:string">
              <varRef line="1984" name="path" slot="1"/>
             </withParam>
             <withParam name="Q{}current-path" as="document-node()">
              <varRef line="1985" name="updatedPath2" slot="8"/>
             </withParam>
            </applyT>
           </copy>
           <copyOf line="1988" flags="vc">
            <varRef name="insert-node" slot="0"/>
           </copyOf>
          </sequence>
          <true/>
          <copy line="1993" flags="cin">
           <applyT role="content" mode="Q{}insert-node" bSlot="1">
            <axis role="select" name="child" nodeTest="( element() | text() | comment() | processing-instruction() )" jsTest="return SaxonJS.U.isNode(item) &amp;&amp; (item.nodeType===1 || item.nodeType===3 || item.nodeType===7 || item.nodeType===8);"/>
            <withParam name="Q{}insert-node" as="node()">
             <varRef line="1994" name="insert-node" slot="0"/>
            </withParam>
            <withParam name="Q{}path" as="xs:string">
             <varRef line="1995" name="path" slot="1"/>
            </withParam>
            <withParam name="Q{}current-path" as="document-node()">
             <varRef line="1996" name="updatedPath2" slot="8"/>
            </withParam>
           </applyT>
          </copy>
         </choose>
        </let>
       </let>
      </let>
     </let>
    </sequence>
   </templateRule>
  </mode>
 </co>
 <co id="15" binds="16">
  <function name="Q{http://www.w3.org/2002/xforms}convert-json-to-xml" line="2960" module="saxon-xforms.xsl" eval="7" flags="pU" as="node()" slots="2">
   <arg name="jinstance" as="xs:string"/>
   <let role="body" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2966" var="result" as="document-node()" slot="1" eval="7">
    <doc line="2968" validation="preserve">
     <applyT mode="Q{}jxml-xml" bSlot="0">
      <doc role="select" line="2963" validation="preserve">
       <fn name="json-to-xml">
        <varRef name="jinstance" slot="0"/>
       </fn>
      </doc>
     </applyT>
    </doc>
    <varRef line="2971" name="result" slot="1"/>
   </let>
  </function>
 </co>
 <co id="17" vis="PUBLIC" binds="">
  <globalParam name="Q{}xforms-instance-id" type="item()*" line="27" module="saxon-xforms.xsl" visibility="PUBLIC" jsAcceptor="return val;" jsCardCheck="function c() {return true;};">
   <str val="xforms-jinstance"/>
  </globalParam>
 </co>
 <co id="18" binds="">
  <function name="Q{http://www.w3.org/2002/xforms}getIfStatement" line="670" module="saxon-xforms.xsl" eval="7" flags="pU" as="xs:string?" slots="1">
   <arg name="map" as="map(*)"/>
   <choose role="body" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="673">
    <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}contains" type="xs:boolean">
     <varRef name="map" slot="0"/>
     <str val="@if"/>
    </ifCall>
    <treat line="674" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="5|0|XTTE0780|xforms:getIfStatement">
     <check card="?" diag="5|0|XTTE0780|xforms:getIfStatement">
      <cvUntyped to="xs:string">
       <data>
        <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
         <varRef name="map" slot="0"/>
         <str val="@if"/>
        </ifCall>
       </data>
      </cvUntyped>
     </check>
    </treat>
    <true/>
    <treat line="677" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="5|0|XTTE0780|xforms:getIfStatement">
     <check card="?" diag="5|0|XTTE0780|xforms:getIfStatement">
      <cvUntyped to="xs:string">
       <data>
        <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
         <varRef name="map" slot="0"/>
         <str val="@if"/>
        </ifCall>
       </data>
      </cvUntyped>
     </check>
    </treat>
   </choose>
  </function>
 </co>
 <co id="19" binds="">
  <function name="Q{http://www.w3.org/2002/xforms}checkRelevantFields" line="397" module="saxon-xforms.xsl" eval="8" flags="pU" as="item()*" slots="16">
   <arg name="refElement" as="xs:string"/>
   <let role="body" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="400" var="pendingUpdatesi" as="map(xs:string, xs:string)?" slot="1" eval="7">
    <treat as="map(xs:string, xs:string)" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.Atomic.string.matches(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="3|0|XTTE0570|pendingUpdatesi">
     <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
      <check card="1" diag="0|0||ixsl:call">
       <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
      </check>
      <str val="getPendingUpdates"/>
      <arrayBlock/>
     </ifCall>
    </treat>
    <let line="401" var="pendingUpdateKeys" as="xs:anyAtomicType*" slot="2" eval="3">
     <choose>
      <fn name="exists">
       <varRef name="pendingUpdatesi" slot="1"/>
      </fn>
      <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}keys" type="xs:anyAtomicType*">
       <check card="1" diag="0|0||map:keys">
        <varRef name="pendingUpdatesi" slot="1"/>
       </check>
      </ifCall>
     </choose>
     <let line="403" var="updatesi" as="map(xs:string, xs:string)?" slot="3" eval="7">
      <treat as="map(xs:string, xs:string)" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.Atomic.string.matches(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="3|0|XTTE0570|updatesi">
       <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
        <check card="1" diag="0|0||ixsl:call">
         <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
        </check>
        <str val="getUpdates"/>
        <arrayBlock/>
       </ifCall>
      </treat>
      <let line="404" var="updateKeys" as="xs:anyAtomicType*" slot="4" eval="3">
       <choose>
        <fn name="exists">
         <varRef name="updatesi" slot="3"/>
        </fn>
        <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}keys" type="xs:anyAtomicType*">
         <check card="1" diag="0|0||map:keys">
          <varRef name="updatesi" slot="3"/>
         </check>
        </ifCall>
       </choose>
       <sequence line="406">
        <message>
         <sequence role="select">
          <valueOf>
           <str val="&#xA;            pendingKeys "/>
          </valueOf>
          <valueOf line="407">
           <fn name="serialize">
            <varRef name="pendingUpdateKeys" slot="2"/>
           </fn>
          </valueOf>
         </sequence>
         <str role="terminate" val="no"/>
         <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
        </message>
        <message line="410">
         <sequence role="select">
          <valueOf>
           <str val="&#xA;            UpdateKeys "/>
          </valueOf>
          <valueOf line="411">
           <fn name="serialize">
            <varRef name="updateKeys" slot="4"/>
           </fn>
          </valueOf>
         </sequence>
         <str role="terminate" val="no"/>
         <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
        </message>
        <let line="414" var="relevantMap" as="map(xs:string, xs:string)" slot="5" eval="7">
         <treat as="map(xs:string, xs:string)" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.Atomic.string.matches(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="3|0|XTTE0570|relevantMap">
          <check card="1" diag="3|0|XTTE0570|relevantMap">
           <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
            <check card="1" diag="0|0||ixsl:call">
             <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
            </check>
            <str val="getRelevantMap"/>
            <arrayBlock/>
           </ifCall>
          </check>
         </treat>
         <let line="415" var="mapKeys" as="xs:anyAtomicType*" slot="6" eval="3">
          <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}keys" type="xs:anyAtomicType*">
           <varRef name="relevantMap" slot="5"/>
          </ifCall>
          <let line="417" var="relevantFields" as="xs:anyAtomicType*" slot="7" eval="3">
           <sequence line="418">
            <forEach>
             <varRef name="mapKeys" slot="6"/>
             <choose line="419">
              <fn name="matches">
               <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
                <varRef name="relevantMap" slot="5"/>
                <dot type="xs:anyAtomicType"/>
               </ifCall>
               <varRef name="refElement" slot="0"/>
               <str val=""/>
              </fn>
              <dot line="420" type="xs:anyAtomicType"/>
             </choose>
            </forEach>
            <forEach line="425">
             <varRef name="pendingUpdateKeys" slot="2"/>
             <let line="426" var="keyi" as="xs:string?" slot="8" eval="7">
              <lastOf>
               <fn name="tokenize">
                <treat as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="0|0||fn:tokenize">
                 <cvUntyped to="xs:string">
                  <dot type="xs:anyAtomicType"/>
                 </cvUntyped>
                </treat>
                <str val="/"/>
                <str val=""/>
               </fn>
              </lastOf>
              <let line="429" var="vv:v0" as="xs:string" slot="9" eval="13">
               <check card="1" diag="0|1||fn:matches">
                <varRef name="keyi" slot="8"/>
               </check>
               <forEach line="427">
                <varRef name="mapKeys" slot="6"/>
                <choose line="429">
                 <fn name="matches">
                  <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
                   <varRef name="relevantMap" slot="5"/>
                   <dot type="xs:anyAtomicType"/>
                  </ifCall>
                  <varRef name="vv:v0" slot="9"/>
                  <str val=""/>
                 </fn>
                 <dot line="430" type="xs:anyAtomicType"/>
                </choose>
               </forEach>
              </let>
             </let>
            </forEach>
            <forEach line="437">
             <varRef name="updateKeys" slot="4"/>
             <let line="438" var="keyi" as="xs:string?" slot="10" eval="7">
              <lastOf>
               <fn name="tokenize">
                <treat as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="0|0||fn:tokenize">
                 <cvUntyped to="xs:string">
                  <dot type="xs:anyAtomicType"/>
                 </cvUntyped>
                </treat>
                <str val="/"/>
                <str val=""/>
               </fn>
              </lastOf>
              <let line="441" var="vv:v1" as="xs:string" slot="11" eval="13">
               <check card="1" diag="0|1||fn:matches">
                <varRef name="keyi" slot="10"/>
               </check>
               <forEach line="439">
                <varRef name="mapKeys" slot="6"/>
                <choose line="441">
                 <fn name="matches">
                  <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
                   <varRef name="relevantMap" slot="5"/>
                   <dot type="xs:anyAtomicType"/>
                  </ifCall>
                  <varRef name="vv:v1" slot="11"/>
                  <str val=""/>
                 </fn>
                 <dot line="442" type="xs:anyAtomicType"/>
                </choose>
               </forEach>
              </let>
             </let>
            </forEach>
           </sequence>
           <sequence line="449">
            <message>
             <sequence role="select">
              <valueOf>
               <str val="&#xA;            refi = "/>
              </valueOf>
              <valueOf line="450">
               <varRef name="refElement" slot="0"/>
              </valueOf>
              <valueOf>
               <str val="&#xA;            &#xA;            &#xA;            relevant Fields, fields = "/>
              </valueOf>
              <valueOf line="453">
               <fn name="serialize">
                <varRef name="relevantFields" slot="7"/>
               </fn>
              </valueOf>
              <valueOf>
               <str val="&#xA;            relevant Fields count = "/>
              </valueOf>
              <valueOf line="454">
               <convert from="xs:integer" to="xs:string">
                <fn name="count">
                 <varRef name="relevantFields" slot="7"/>
                </fn>
               </convert>
              </valueOf>
             </sequence>
             <str role="terminate" val="no"/>
             <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
            </message>
            <let line="457" var="updatedInstanceXML4" as="item()?" slot="12" eval="8">
             <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
              <check card="1" diag="0|0||ixsl:call">
               <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
              </check>
              <str val="getInstance"/>
              <arrayBlock/>
             </ifCall>
             <sequence line="459">
              <forEach>
               <varRef name="relevantFields" slot="7"/>
               <let line="460" var="keyi" as="xs:anyAtomicType" slot="13" eval="7">
                <dot type="xs:anyAtomicType"/>
                <let line="461" var="context" as="node()*" slot="14" eval="8">
                 <slash>
                  <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}page" type="document-node()?"/>
                  <fn name="key">
                   <str val="Q{http://saxon.sf.net/}kk101"/>
                   <varRef name="keyi" slot="13"/>
                   <dot type="document-node()"/>
                  </fn>
                 </slash>
                 <let line="462" var="relevantCheck" as="xs:boolean" slot="15" eval="7">
                  <treat line="463" as="xs:boolean" jsTest="return SaxonJS.U.Atomic.boolean.matches(item);" diag="3|0|XTTE0570|relevantCheck">
                   <check card="1" diag="3|0|XTTE0570|relevantCheck">
                    <cvUntyped to="xs:boolean">
                     <data>
                      <evaluate dxns="">
                       <fn role="xpath" name="concat">
                        <dot type="xs:anyAtomicType"/>
                        <str val="/"/>
                        <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
                         <varRef name="relevantMap" slot="5"/>
                         <dot type="xs:anyAtomicType"/>
                        </ifCall>
                       </fn>
                       <varRef role="cxt" name="updatedInstanceXML4" slot="12"/>
                       <str role="sa" val="no"/>
                       <map role="wp" size="0"/>
                      </evaluate>
                     </data>
                    </cvUntyped>
                   </check>
                  </treat>
                  <choose line="466">
                   <varRef name="relevantCheck" slot="15"/>
                   <ifCall line="469" name="Q{http://saxonica.com/ns/interactiveXSLT}set-property" type="item()?">
                    <str val="style.display"/>
                    <str val="inline"/>
                    <check card="1" diag="0|2||ixsl:set-property">
                     <conditionalSort>
                      <fn name="exists">
                       <tail start="2">
                        <varRef name="context" slot="14"/>
                       </tail>
                      </fn>
                      <docOrder intra="1">
                       <slash>
                        <varRef name="context" slot="14"/>
                        <axis name="parent" nodeTest="(element()|document-node())" jsTest="return SaxonJS.U.isNode(item) &amp;&amp; (item.nodeType===9||item.nodeType===11||item.nodeType===1);"/>
                       </slash>
                      </docOrder>
                     </conditionalSort>
                    </check>
                   </ifCall>
                   <true/>
                   <ifCall line="472" name="Q{http://saxonica.com/ns/interactiveXSLT}set-property" type="item()?">
                    <str val="style.display"/>
                    <str val="none"/>
                    <check card="1" diag="0|2||ixsl:set-property">
                     <conditionalSort>
                      <fn name="exists">
                       <tail start="2">
                        <varRef name="context" slot="14"/>
                       </tail>
                      </fn>
                      <docOrder intra="1">
                       <slash>
                        <varRef name="context" slot="14"/>
                        <axis name="parent" nodeTest="(element()|document-node())" jsTest="return SaxonJS.U.isNode(item) &amp;&amp; (item.nodeType===9||item.nodeType===11||item.nodeType===1);"/>
                       </slash>
                      </docOrder>
                     </conditionalSort>
                    </check>
                   </ifCall>
                  </choose>
                 </let>
                </let>
               </let>
              </forEach>
              <ifCall line="478" name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
               <check card="1" diag="0|0||ixsl:call">
                <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
               </check>
               <str val="clearPendingUpdates"/>
               <arrayBlock/>
              </ifCall>
              <ifCall line="479" name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
               <check card="1" diag="0|0||ixsl:call">
                <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
               </check>
               <str val="clearUpdates"/>
               <arrayBlock/>
              </ifCall>
             </sequence>
            </let>
           </sequence>
          </let>
         </let>
        </let>
       </sequence>
      </let>
     </let>
    </let>
   </let>
  </function>
 </co>
 <co id="20" binds="">
  <function name="Q{http://www.w3.org/2002/xforms}random" line="68" module="xforms-function-library.xsl" eval="7" flags="pU" as="xs:double" slots="0">
   <check role="body" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="69" card="1" diag="3|0|XTTE0570|randomNumber">
    <convert from="xs:anyAtomicType" to="xs:double" flags="p">
     <cvUntyped to="xs:double">
      <data>
       <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
        <check card="1" diag="0|0||ixsl:call">
         <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
        </check>
        <str val="Math.random"/>
        <arrayBlock/>
       </ifCall>
      </data>
     </cvUntyped>
    </convert>
   </check>
  </function>
 </co>
 <co id="21" binds="">
  <mode name="Q{}set-field" onNo="TC" flags="W" patternSlots="0">
   <templateRule prec="0" prio="-0.25" seq="2" rank="0" minImp="0" slots="1" flags="s" line="3242" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="*:textarea" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1&amp;&amp;q.local==='textarea'"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="3243">
     <param name="Q{}value" slot="0" flags="t">
      <str role="select" val=""/>
      <supplied role="conversion" slot="0"/>
     </param>
     <ifCall line="3245" name="Q{http://saxonica.com/ns/interactiveXSLT}get" type="item()*">
      <dot type="*:textarea"/>
      <str val="value"/>
     </ifCall>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="-0.25" seq="1" rank="0" minImp="0" slots="1" flags="s" line="3234" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="*:select" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1&amp;&amp;q.local==='select'"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="3235">
     <param name="Q{}value" slot="0" flags="t">
      <str role="select" val=""/>
      <supplied role="conversion" slot="0"/>
     </param>
     <forEach line="3237">
      <filter flags="b">
       <axis name="child" nodeTest="element(Q{}option)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri===''&amp;&amp;q.local==='option';"/>
       <gc op="=" card="N:1" comp="GAC|http://www.w3.org/2005/xpath-functions/collation/codepoint">
        <data>
         <varRef name="value" slot="0"/>
        </data>
        <attVal name="Q{}value" chk="0"/>
       </gc>
      </filter>
      <ifCall line="3238" name="Q{http://saxonica.com/ns/interactiveXSLT}set-property" type="item()?">
       <str val="selected"/>
       <true/>
       <dot type="element(Q{}option)"/>
      </ifCall>
     </forEach>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="-0.25" seq="0" rank="0" minImp="0" slots="1" flags="s" line="3213" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="*:input" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1&amp;&amp;q.local==='input'"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="3214">
     <param name="Q{}value" slot="0" flags="t">
      <str role="select" val=""/>
      <supplied role="conversion" slot="0"/>
     </param>
     <forEach line="3217">
      <dot type="*:input"/>
      <choose line="3219">
       <and op="and">
        <fn name="exists">
         <axis name="attribute" nodeTest="attribute(Q{}type)" jsTest="return item.name==='type'"/>
        </fn>
        <gc op="=" card="1:1" comp="CCC">
         <attVal name="Q{}type" chk="0"/>
         <str val="checkbox"/>
        </gc>
       </and>
       <ifCall line="3220" name="Q{http://saxonica.com/ns/interactiveXSLT}set-property" type="item()?">
        <str val="checked"/>
        <choose>
         <gc op="=" card="N:1" comp="GAC|http://www.w3.org/2005/xpath-functions/collation/codepoint">
          <data>
           <varRef name="value" slot="0"/>
          </data>
          <str val="true"/>
         </gc>
         <check card="?" diag="0|1||ixsl:set-property">
          <varRef name="value" slot="0"/>
         </check>
         <true/>
         <str val=""/>
        </choose>
        <dot type="*:input"/>
       </ifCall>
       <true/>
       <ifCall line="3223" name="Q{http://saxonica.com/ns/interactiveXSLT}set-property" type="item()?">
        <str val="value"/>
        <check card="?" diag="0|1||ixsl:set-property">
         <varRef name="value" slot="0"/>
        </check>
        <dot type="*:input"/>
       </ifCall>
      </choose>
     </forEach>
    </sequence>
   </templateRule>
  </mode>
 </co>
 <co id="22" binds="">
  <function name="Q{http://www.w3.org/2002/xforms}foo" line="43" module="xforms-function-library.xsl" eval="7" flags="pU" as="xs:boolean" slots="1">
   <arg name="num" as="xs:integer"/>
   <compareToInt role="body" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="46" op="lt" val="5">
    <varRef name="num" slot="0"/>
   </compareToInt>
  </function>
 </co>
 <co id="13" binds="">
  <globalVariable name="Q{}sampleForm" type="xs:string" line="22" module="sample3.xsl" visibility="PRIVATE" jsAcceptor="return SaxonJS.U.Atomic.string.cast(val);" jsCardCheck="function c(n) {return n==1;};">
   <fn ns="xsl=~ xforms=http://www.w3.org/2002/xforms array=http://www.w3.org/2005/xpath-functions/array f=http://www.saxonica.com/local/functions ixsl=~ js=~ xs=~ saxon=~ map=http://www.w3.org/2005/xpath-functions/map" line="22" name="resolve-uri">
    <str val="xml/sample3form.xml"/>
    <treat as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="0|1||fn:resolve-uri">
     <check card="1" diag="0|1||fn:resolve-uri">
      <cvUntyped to="xs:string">
       <data>
        <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}location" type="item()?"/>
       </data>
      </cvUntyped>
     </check>
    </treat>
   </fn>
  </globalVariable>
 </co>
 <co id="23" vis="PUBLIC" binds="">
  <globalParam name="Q{}xforms-cache-id" type="item()*" line="28" module="saxon-xforms.xsl" visibility="PUBLIC" jsAcceptor="return val;" jsCardCheck="function c() {return true;};">
   <str val="xforms-cache"/>
  </globalParam>
 </co>
 <co id="24" binds="25">
  <function name="Q{http://www.w3.org/2002/xforms}impose" line="19" module="xforms-function-library.xsl" eval="8" flags="pU" as="xs:string" slots="2">
   <arg name="input" as="xs:string"/>
   <let role="body" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="25" var="vv:v0" as="xs:anyAtomicType*" slot="1" eval="4">
    <data>
     <gVarRef name="Q{}xform-functions" bSlot="0"/>
    </data>
    <fn line="40" name="string-join">
     <analyzeString line="22">
      <varRef role="select" name="input" slot="0"/>
      <str role="regex" val="\i\c*\("/>
      <str role="flags" val=""/>
      <choose role="matching" line="25">
       <gc op="=" card="N:1" comp="GAC|http://www.w3.org/2005/xpath-functions/collation/codepoint">
        <varRef name="vv:v0" slot="1"/>
        <fn name="substring-before">
         <dot type="xs:string"/>
         <str val="("/>
        </fn>
       </gc>
       <fn line="26" name="concat">
        <str val="xforms:"/>
        <dot type="xs:string"/>
       </fn>
       <true/>
       <dot line="29" type="xs:string"/>
      </choose>
      <dot role="nonMatching" line="34" type="xs:string"/>
     </analyzeString>
    </fn>
   </let>
  </function>
 </co>
 <co id="25" binds="">
  <globalVariable name="Q{}xform-functions" type="item()+" line="17" module="xforms-function-library.xsl" visibility="PRIVATE" jsAcceptor="return val;" jsCardCheck="function c(n) {return n&gt;=1;};">
   <sequence ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="17">
    <literal count="4">
     <str val="index"/>
     <str val="avg"/>
     <str val="foo"/>
     <str val="current-date"/>
    </literal>
    <slash simple="1">
     <treat as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="14|3|XPTY0020|">
      <dot flags="a"/>
     </treat>
     <axis name="child" nodeTest="element(Q{}random)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri===''&amp;&amp;q.local==='random';"/>
    </slash>
   </sequence>
  </globalVariable>
 </co>
 <co id="26" binds="13 11">
  <template name="Q{}main" flags="os" line="24" module="sample3.xsl" slots="0">
   <ifCall role="body" ns="xsl=~ xforms=http://www.w3.org/2002/xforms array=http://www.w3.org/2005/xpath-functions/array f=http://www.saxonica.com/local/functions ixsl=~ js=~ xs=~ saxon=~ map=http://www.w3.org/2005/xpath-functions/map" line="27" name="Q{http://saxonica.com/ns/interactiveXSLT}schedule-action" type="item()*">
    <int val="0"/>
    <gVarRef name="Q{}sampleForm" bSlot="0"/>
    <callT line="28" name="main2" bSlot="1"/>
   </ifCall>
  </template>
 </co>
 <co id="27" binds="">
  <function name="Q{http://www.w3.org/2002/xforms}check-required-fields" line="941" module="saxon-xforms.xsl" eval="8" flags="pU" as="item()*" slots="3">
   <arg name="updatedInstanceXML" as="document-node()"/>
   <let role="body" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="944" var="required-fieldsi" as="element()*" slot="1" eval="8">
    <filter flags="b">
     <slash simple="1">
      <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}page" type="document-node()?"/>
      <axis name="descendant" nodeTest="element()" jsTest="return item.nodeType===1;"/>
     </slash>
     <fn name="exists">
      <axis name="attribute" nodeTest="attribute(Q{}data-required)" jsTest="return item.name==='data-required'"/>
     </fn>
    </filter>
    <forEach line="948">
     <varRef name="required-fieldsi" slot="1"/>
     <let line="950" var="resulti" as="document-node()" slot="2" eval="7">
      <doc line="953" validation="preserve">
       <evaluate dxns="">
        <fn role="xpath" name="concat">
         <str val="boolean(normalize-space("/>
         <attVal name="Q{}data-ref" chk="0"/>
         <str val="))"/>
         <str val="="/>
         <attVal name="Q{}data-ref" chk="0"/>
         <str val="/"/>
         <attVal name="Q{}data-required" chk="0"/>
        </fn>
        <varRef role="cxt" name="updatedInstanceXML" slot="0"/>
        <str role="sa" val="no"/>
        <map role="wp" size="0"/>
       </evaluate>
      </doc>
      <choose line="961">
       <vc op="eq" onEmpty="0" comp="CCC">
        <cast as="xs:string" emptiable="0">
         <data>
          <varRef name="resulti" slot="2"/>
         </data>
        </cast>
        <str val="false"/>
       </vc>
       <dot type="element()"/>
      </choose>
     </let>
    </forEach>
   </let>
  </function>
 </co>
 <co id="28" binds="">
  <function name="Q{http://www.w3.org/2002/xforms}index" line="50" module="xforms-function-library.xsl" eval="7" flags="pU" as="xs:integer" slots="2">
   <arg name="repeatID" as="xs:string"/>
   <let role="body" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="52" var="element" as="item()?" slot="1" eval="8">
    <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
     <check card="1" diag="0|0||ixsl:call">
      <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
     </check>
     <str val="getElementById"/>
     <arrayBlock>
      <varRef name="repeatID" slot="0"/>
     </arrayBlock>
    </ifCall>
    <choose line="54">
     <fn name="empty">
      <varRef name="element" slot="1"/>
     </fn>
     <int val="0"/>
     <fn line="58" name="exists">
      <slash simple="1">
       <treat as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="1|0|XPTY0019|/">
        <varRef name="element" slot="1"/>
       </treat>
       <axis name="attribute" nodeTest="attribute(Q{}data-repeatable-context)" jsTest="return item.name==='data-repeatable-context'"/>
      </slash>
     </fn>
     <fn line="59" name="count">
      <slash simple="1">
       <treat as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="1|0|XPTY0019|/">
        <varRef name="element" slot="1"/>
       </treat>
       <axis name="descendant" nodeTest="element()" jsTest="return item.nodeType===1;"/>
      </slash>
     </fn>
     <true/>
     <int val="0"/>
    </choose>
   </let>
  </function>
 </co>
 <co id="29" binds="29">
  <mode name="Q{}delete-node" onNo="TC" flags="W" patternSlots="0">
   <templateRule prec="0" prio="-0.5" seq="0" rank="0" minImp="0" slots="7" flags="s" line="2004" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element()" jsTest="return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1;"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2005">
     <param name="Q{}path" slot="0" as="xs:string">
      <str role="select" val=""/>
      <treat role="conversion" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="8|0|XTTE0590|path">
       <check card="1" diag="8|0|XTTE0590|path">
        <cvUntyped to="xs:string">
         <data>
          <supplied slot="0"/>
         </data>
        </cvUntyped>
       </check>
      </treat>
     </param>
     <param line="2006" name="Q{}current-path" slot="1" as="xs:string">
      <str role="select" val=""/>
      <treat role="conversion" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="8|0|XTTE0590|current-path">
       <check card="1" diag="8|0|XTTE0590|current-path">
        <cvUntyped to="xs:string">
         <data>
          <supplied slot="1"/>
         </data>
        </cvUntyped>
       </check>
      </treat>
     </param>
     <let line="2012" var="updatedPath2" as="document-node()" slot="2" eval="7">
      <doc line="2013" flags="t" validation="preserve">
       <sequence>
        <valueOf flags="l">
         <fn line="2007" name="concat">
          <varRef name="current-path" slot="1"/>
          <str val="/"/>
          <fn name="local-name">
           <dot type="element()"/>
          </fn>
         </fn>
        </valueOf>
        <choose line="2015">
         <fn name="exists">
          <let var="vv:current-28121473" as="element()" slot="3" eval="7">
           <dot type="element()"/>
           <let var="vv:v0" as="xs:string" slot="4" eval="13">
            <fn name="local-name">
             <varRef name="vv:current-28121473" slot="3"/>
            </fn>
            <filter flags="b">
             <union op="|">
              <fn name="reverse">
               <slash simple="1">
                <dot type="element()"/>
                <axis name="preceding-sibling" nodeTest="element()" jsTest="return item.nodeType===1;"/>
               </slash>
              </fn>
              <axis name="following-sibling" nodeTest="element()" jsTest="return item.nodeType===1;"/>
             </union>
             <vc op="eq" comp="CCC">
              <fn name="local-name">
               <dot type="element()"/>
              </fn>
              <varRef name="vv:v0" slot="4"/>
             </vc>
            </filter>
           </let>
          </let>
         </fn>
         <valueOf line="2016" flags="l">
          <fn name="concat">
           <str val="["/>
           <let line="2011" var="vv:current585323788" as="element()" slot="5" eval="7">
            <dot type="element()"/>
            <let var="vv:v1" as="xs:string" slot="6" eval="13">
             <fn name="local-name">
              <varRef name="vv:current585323788" slot="5"/>
             </fn>
             <arith op="+" calc="i+i">
              <fn name="count">
               <filter flags="b">
                <slash simple="1">
                 <dot type="element()"/>
                 <axis name="preceding-sibling" nodeTest="element()" jsTest="return item.nodeType===1;"/>
                </slash>
                <vc op="eq" comp="CCC">
                 <fn name="local-name">
                  <dot type="element()"/>
                 </fn>
                 <varRef name="vv:v1" slot="6"/>
                </vc>
               </filter>
              </fn>
              <int val="1"/>
             </arith>
            </let>
           </let>
           <str val="]"/>
          </fn>
         </valueOf>
        </choose>
       </sequence>
      </doc>
      <choose line="2023">
       <vc op="eq" onEmpty="0" comp="CCC">
        <cast as="xs:string" emptiable="0">
         <data>
          <varRef name="updatedPath2" slot="2"/>
         </data>
        </cast>
        <varRef name="path" slot="0"/>
       </vc>
       <empty/>
       <true/>
       <copy line="2036" flags="cin">
        <applyT role="content" mode="Q{}delete-node" bSlot="0">
         <axis role="select" name="child" nodeTest="( element() | text() | comment() | processing-instruction() )" jsTest="return SaxonJS.U.isNode(item) &amp;&amp; (item.nodeType===1 || item.nodeType===3 || item.nodeType===7 || item.nodeType===8);"/>
         <withParam name="Q{}path" as="xs:string">
          <varRef line="2037" name="path" slot="0"/>
         </withParam>
         <withParam name="Q{}current-path" as="document-node()">
          <varRef line="2038" name="updatedPath2" slot="2"/>
         </withParam>
        </applyT>
       </copy>
      </choose>
     </let>
    </sequence>
   </templateRule>
  </mode>
 </co>
 <co id="6" binds="">
  <mode name="Q{}get-field" onNo="TC" flags="W" patternSlots="0">
   <templateRule prec="0" prio="-0.25" seq="2" rank="0" minImp="0" slots="0" flags="s" line="3206" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="*:textarea" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1&amp;&amp;q.local==='textarea'"/>
    <ifCall role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="3209" name="Q{http://saxonica.com/ns/interactiveXSLT}get" type="item()*">
     <dot type="*:textarea"/>
     <str val="value"/>
    </ifCall>
   </templateRule>
   <templateRule prec="0" prio="-0.25" seq="1" rank="0" minImp="0" slots="0" flags="s" line="3201" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="*:select" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1&amp;&amp;q.local==='select'"/>
    <ifCall role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="3203" name="Q{http://saxonica.com/ns/interactiveXSLT}get" type="item()*">
     <check card="?" diag="0|0||ixsl:get">
      <filter flags="b">
       <axis name="child" nodeTest="element(Q{}option)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri===''&amp;&amp;q.local==='option';"/>
       <gc op="=" card="N:1" comp="GAC|http://www.w3.org/2005/xpath-functions/collation/codepoint">
        <data>
         <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}get" type="item()*">
          <dot type="element(Q{}option)"/>
          <str val="selected"/>
         </ifCall>
        </data>
        <true/>
       </gc>
      </filter>
     </check>
     <str val="value"/>
    </ifCall>
   </templateRule>
   <templateRule prec="0" prio="-0.25" seq="0" rank="0" minImp="0" slots="0" flags="s" line="3187" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="*:input" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1&amp;&amp;q.local==='input'"/>
    <choose role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="3191">
     <and op="and">
      <fn name="exists">
       <axis name="attribute" nodeTest="attribute(Q{}type)" jsTest="return item.name==='type'"/>
      </fn>
      <gc op="=" card="1:1" comp="CCC">
       <attVal name="Q{}type" chk="0"/>
       <str val="checkbox"/>
      </gc>
     </and>
     <ifCall line="3192" name="Q{http://saxonica.com/ns/interactiveXSLT}get" type="item()*">
      <dot type="*:input"/>
      <str val="checked"/>
     </ifCall>
     <true/>
     <ifCall line="3195" name="Q{http://saxonica.com/ns/interactiveXSLT}get" type="item()*">
      <dot type="*:input"/>
      <str val="value"/>
     </ifCall>
    </choose>
   </templateRule>
  </mode>
 </co>
 <co id="30" binds="12 3 30 30 31 32 8 31 32 0 8 24 30 30 30 30 30 30 31 32 8 30 30 30 24 30 30 30 30 3 30 30 30">
  <mode onNo="TC" flags="dW" patternSlots="0">
   <templateRule prec="0" prio="-0.5" seq="1" rank="0" minImp="0" slots="0" flags="s" line="1129" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="document-node()" jsTest="return SaxonJS.U.isNode(item) &amp;&amp; (item.nodeType===9||item.nodeType===11);"/>
    <callT role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="1130" name="xformsjs-main" bSlot="0" flags="t">
     <withParam name="Q{}xforms-doc" flags="c" as="document-node()">
      <dot line="1131" type="document-node()"/>
     </withParam>
     <withParam name="Q{}xFormsId" flags="c" as="xs:string">
      <str val="xForm"/>
     </withParam>
    </callT>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="7" rank="1" minImp="0" slots="0" flags="s" line="1596" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}hint)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='hint';"/>
    <empty role="action"/>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="18" rank="1" minImp="0" slots="9" flags="s" line="2497" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}dispatch)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='dispatch';"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2498">
     <param name="Q{}instance1" slot="0" flags="t" as="node()?">
      <empty role="select"/>
      <treat role="conversion" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="8|0|XTTE0590|instance1">
       <check card="?" diag="8|0|XTTE0590|instance1">
        <supplied slot="0"/>
       </check>
      </treat>
     </param>
     <param line="2499" name="Q{}bindings" slot="1" flags="t" as="map(xs:string, node())">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, node())" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.isNode(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|bindings">
       <check card="1" diag="8|0|XTTE0590|bindings">
        <supplied slot="1"/>
       </check>
      </treat>
     </param>
     <param line="2500" name="Q{}submissions" slot="2" flags="t" as="map(xs:string, xs:string)">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, xs:string)" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.Atomic.string.matches(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|submissions">
       <check card="1" diag="8|0|XTTE0590|submissions">
        <supplied slot="2"/>
       </check>
      </treat>
     </param>
     <param line="2501" name="Q{}position" slot="3">
      <str role="select" val=""/>
      <supplied role="conversion" slot="3"/>
     </param>
     <param line="2502" name="Q{}nodeset" slot="4">
      <str role="select" val=""/>
      <supplied role="conversion" slot="4"/>
     </param>
     <param line="2503" name="Q{}updateMode" slot="5" flags="t">
      <false role="select"/>
      <supplied role="conversion" slot="5"/>
     </param>
     <param line="2509" name="Q{}myid" slot="6" flags="t">
      <choose role="select">
       <fn name="exists">
        <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       </fn>
       <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       <true/>
       <fn name="concat">
        <fn name="generate-id">
         <dot type="element()"/>
        </fn>
        <atomSing card="?" diag="0|1||fn:concat">
         <varRef name="position" slot="3"/>
        </atomSing>
       </fn>
      </choose>
      <supplied role="conversion" slot="6"/>
     </param>
     <let line="2512" var="nodeseti" as="item()*" slot="7" eval="3">
      <choose>
       <gc op="=" card="N:1" comp="GAC|http://www.w3.org/2005/xpath-functions/collation/codepoint">
        <data>
         <varRef name="nodeset" slot="4"/>
        </data>
        <str val=""/>
       </gc>
       <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
       <true/>
       <varRef name="nodeset" slot="4"/>
      </choose>
      <choose line="2514">
       <fn name="not">
        <varRef name="updateMode" slot="5"/>
       </fn>
       <sequence line="2516">
        <message>
         <sequence role="select">
          <valueOf>
           <str val="xforms:setvalue found !!!! XXX, node&#xA;                        "/>
          </valueOf>
          <valueOf line="2517">
           <fn name="serialize">
            <dot type="element()"/>
           </fn>
          </valueOf>
          <valueOf>
           <str val=", id= "/>
          </valueOf>
          <valueOf line="2517">
           <convert from="xs:untypedAtomic" to="xs:string">
            <attVal name="Q{}id" chk="0"/>
           </convert>
          </valueOf>
          <valueOf>
           <str val=",&#xA;                    myid = "/>
          </valueOf>
          <valueOf line="2518">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="myid" slot="6"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
          <valueOf>
           <str val=", nodeset="/>
          </valueOf>
          <valueOf line="2519">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="nodeseti" slot="7"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
         </sequence>
         <str role="terminate" val="no"/>
         <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
        </message>
        <let line="2522" var="action-map" as="map(xs:anyAtomicType, item()*)" slot="8" eval="8">
         <ifCall line="2526" name="Q{http://www.w3.org/2005/xpath-functions/map}merge" type="map(*)">
          <sequence>
           <choose>
            <fn name="exists">
             <varRef name="nodeset" slot="4"/>
            </fn>
            <ifCall line="2527" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@ref"/>
             <cast as="xs:string" emptiable="1">
              <atomSing card="?" diag="2|0||cast as">
               <varRef name="nodeset" slot="4"/>
              </atomSing>
             </cast>
            </ifCall>
           </choose>
           <choose line="2530">
            <fn name="exists">
             <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
            </fn>
            <ifCall line="2531" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@event"/>
             <cast as="xs:string" emptiable="1">
              <atomSing card="?" diag="2|0||cast as">
               <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
              </atomSing>
             </cast>
            </ifCall>
           </choose>
           <choose line="2534">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
            </fn>
            <ifCall line="2535" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@position"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2537">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
            </fn>
            <ifCall line="2538" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@at"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2540">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
            </fn>
            <ifCall line="2541" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@if"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2543">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
            </fn>
            <ifCall line="2544" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@while"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
             </fn>
            </ifCall>
           </choose>
           <treat line="2547" as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="18|0|XTTE3375|">
            <forEachGroup algorithm="by">
             <dot role="select" type="element()"/>
             <fn role="key" name="local-name">
              <dot type="element()"/>
             </fn>
             <str role="collation" val="http://www.w3.org/2005/xpath-functions/collation/codepoint"/>
             <applyT role="content" line="2548" mode="Q{}xforms-action-map" bSlot="1">
              <dot role="select" type="element()"/>
              <withParam name="Q{}nodeset">
               <varRef line="2549" name="nodeset" slot="4"/>
              </withParam>
             </applyT>
            </forEachGroup>
           </treat>
          </sequence>
          <map size="2">
           <str val="duplicates"/>
           <str val="reject"/>
           <str val="duplicates-error-code"/>
           <str val="XTDE3365"/>
          </map>
         </ifCall>
         <sequence line="2562">
          <message>
           <sequence role="select">
            <valueOf>
             <str val="xforms:setvalue found !!!! XXX, node&#xA;                    "/>
            </valueOf>
            <valueOf line="2563">
             <fn name="serialize">
              <dot type="element()"/>
             </fn>
            </valueOf>
            <valueOf>
             <str val=", id= "/>
            </valueOf>
            <valueOf line="2563">
             <convert from="xs:untypedAtomic" to="xs:string">
              <attVal name="Q{}id" chk="0"/>
             </convert>
            </valueOf>
            <valueOf>
             <str val=",&#xA;                    myid = "/>
            </valueOf>
            <valueOf line="2564">
             <fn name="string-join">
              <convert from="xs:anyAtomicType" to="xs:string">
               <data>
                <mergeAdj>
                 <varRef name="myid" slot="6"/>
                </mergeAdj>
               </data>
              </convert>
              <str val=" "/>
             </fn>
            </valueOf>
            <valueOf>
             <str val=", nodeset="/>
            </valueOf>
            <valueOf line="2565">
             <fn name="string-join">
              <convert from="xs:anyAtomicType" to="xs:string">
               <data>
                <mergeAdj>
                 <varRef name="nodeseti" slot="7"/>
                </mergeAdj>
               </data>
              </convert>
              <str val=" "/>
             </fn>
            </valueOf>
            <valueOf>
             <str val="&#xA;                    action xml "/>
            </valueOf>
            <valueOf line="2566">
             <fn name="serialize">
              <varRef name="action-map" slot="8"/>
              <map size="1">
               <str val="method"/>
               <str val="json"/>
              </map>
             </fn>
            </valueOf>
           </sequence>
           <str role="terminate" val="no"/>
           <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
          </message>
          <varRef line="2590" name="action-map" slot="8"/>
         </sequence>
        </let>
       </sequence>
      </choose>
     </let>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="12" rank="1" minImp="0" slots="1" flags="s" line="1770" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}item)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='item';"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="1773">
     <param name="Q{}selectedValue" slot="0" as="xs:string">
      <str role="select" val=""/>
      <treat role="conversion" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="8|0|XTTE0590|selectedValue">
       <check card="1" diag="8|0|XTTE0590|selectedValue">
        <cvUntyped to="xs:string">
         <data>
          <supplied slot="0"/>
         </data>
        </cvUntyped>
       </check>
      </treat>
     </param>
     <elem line="1777" name="option" nsuri="" namespaces="rdf xhtml js in fn map array ev">
      <sequence>
       <att name="value" flags="l">
        <fn name="string-join">
         <convert from="xs:untypedAtomic" to="xs:string">
          <data>
           <axis name="child" nodeTest="element(Q{http://www.w3.org/2002/xforms}value)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='value';"/>
          </data>
         </convert>
         <str val=" "/>
        </fn>
       </att>
       <choose line="1778">
        <gc op="=" card="1:1" comp="CCC">
         <varRef name="selectedValue" slot="0"/>
         <cast as="xs:string" emptiable="1">
          <atomSing card="?" diag="2|0||cast as">
           <slash>
            <axis name="child" nodeTest="element(Q{http://www.w3.org/2002/xforms}value)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='value';"/>
            <axis name="child" nodeTest="text()" jsTest="return item.nodeType===3;"/>
           </slash>
          </atomSing>
         </cast>
        </gc>
        <att line="1779" name="selected" flags="l">
         <varRef name="selectedValue" slot="0"/>
        </att>
       </choose>
       <valueOf line="1782" flags="l">
        <fn name="string-join">
         <convert from="xs:untypedAtomic" to="xs:string">
          <data>
           <axis name="child" nodeTest="element(Q{http://www.w3.org/2002/xforms}label)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='label';"/>
          </data>
         </convert>
         <str val=" "/>
        </fn>
       </valueOf>
      </sequence>
     </elem>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="18" rank="1" minImp="0" slots="9" flags="s" line="2497" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}insert)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='insert';"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2498">
     <param name="Q{}instance1" slot="0" flags="t" as="node()?">
      <empty role="select"/>
      <treat role="conversion" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="8|0|XTTE0590|instance1">
       <check card="?" diag="8|0|XTTE0590|instance1">
        <supplied slot="0"/>
       </check>
      </treat>
     </param>
     <param line="2499" name="Q{}bindings" slot="1" flags="t" as="map(xs:string, node())">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, node())" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.isNode(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|bindings">
       <check card="1" diag="8|0|XTTE0590|bindings">
        <supplied slot="1"/>
       </check>
      </treat>
     </param>
     <param line="2500" name="Q{}submissions" slot="2" flags="t" as="map(xs:string, xs:string)">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, xs:string)" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.Atomic.string.matches(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|submissions">
       <check card="1" diag="8|0|XTTE0590|submissions">
        <supplied slot="2"/>
       </check>
      </treat>
     </param>
     <param line="2501" name="Q{}position" slot="3">
      <str role="select" val=""/>
      <supplied role="conversion" slot="3"/>
     </param>
     <param line="2502" name="Q{}nodeset" slot="4">
      <str role="select" val=""/>
      <supplied role="conversion" slot="4"/>
     </param>
     <param line="2503" name="Q{}updateMode" slot="5" flags="t">
      <false role="select"/>
      <supplied role="conversion" slot="5"/>
     </param>
     <param line="2509" name="Q{}myid" slot="6" flags="t">
      <choose role="select">
       <fn name="exists">
        <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       </fn>
       <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       <true/>
       <fn name="concat">
        <fn name="generate-id">
         <dot type="element()"/>
        </fn>
        <atomSing card="?" diag="0|1||fn:concat">
         <varRef name="position" slot="3"/>
        </atomSing>
       </fn>
      </choose>
      <supplied role="conversion" slot="6"/>
     </param>
     <let line="2512" var="nodeseti" as="item()*" slot="7" eval="3">
      <choose>
       <gc op="=" card="N:1" comp="GAC|http://www.w3.org/2005/xpath-functions/collation/codepoint">
        <data>
         <varRef name="nodeset" slot="4"/>
        </data>
        <str val=""/>
       </gc>
       <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
       <true/>
       <varRef name="nodeset" slot="4"/>
      </choose>
      <choose line="2514">
       <fn name="not">
        <varRef name="updateMode" slot="5"/>
       </fn>
       <sequence line="2516">
        <message>
         <sequence role="select">
          <valueOf>
           <str val="xforms:setvalue found !!!! XXX, node&#xA;                        "/>
          </valueOf>
          <valueOf line="2517">
           <fn name="serialize">
            <dot type="element()"/>
           </fn>
          </valueOf>
          <valueOf>
           <str val=", id= "/>
          </valueOf>
          <valueOf line="2517">
           <convert from="xs:untypedAtomic" to="xs:string">
            <attVal name="Q{}id" chk="0"/>
           </convert>
          </valueOf>
          <valueOf>
           <str val=",&#xA;                    myid = "/>
          </valueOf>
          <valueOf line="2518">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="myid" slot="6"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
          <valueOf>
           <str val=", nodeset="/>
          </valueOf>
          <valueOf line="2519">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="nodeseti" slot="7"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
         </sequence>
         <str role="terminate" val="no"/>
         <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
        </message>
        <let line="2522" var="action-map" as="map(xs:anyAtomicType, item()*)" slot="8" eval="8">
         <ifCall line="2526" name="Q{http://www.w3.org/2005/xpath-functions/map}merge" type="map(*)">
          <sequence>
           <choose>
            <fn name="exists">
             <varRef name="nodeset" slot="4"/>
            </fn>
            <ifCall line="2527" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@ref"/>
             <cast as="xs:string" emptiable="1">
              <atomSing card="?" diag="2|0||cast as">
               <varRef name="nodeset" slot="4"/>
              </atomSing>
             </cast>
            </ifCall>
           </choose>
           <choose line="2530">
            <fn name="exists">
             <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
            </fn>
            <ifCall line="2531" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@event"/>
             <cast as="xs:string" emptiable="1">
              <atomSing card="?" diag="2|0||cast as">
               <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
              </atomSing>
             </cast>
            </ifCall>
           </choose>
           <choose line="2534">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
            </fn>
            <ifCall line="2535" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@position"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2537">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
            </fn>
            <ifCall line="2538" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@at"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2540">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
            </fn>
            <ifCall line="2541" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@if"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2543">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
            </fn>
            <ifCall line="2544" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@while"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
             </fn>
            </ifCall>
           </choose>
           <treat line="2547" as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="18|0|XTTE3375|">
            <forEachGroup algorithm="by">
             <dot role="select" type="element()"/>
             <fn role="key" name="local-name">
              <dot type="element()"/>
             </fn>
             <str role="collation" val="http://www.w3.org/2005/xpath-functions/collation/codepoint"/>
             <applyT role="content" line="2548" mode="Q{}xforms-action-map" bSlot="1">
              <dot role="select" type="element()"/>
              <withParam name="Q{}nodeset">
               <varRef line="2549" name="nodeset" slot="4"/>
              </withParam>
             </applyT>
            </forEachGroup>
           </treat>
          </sequence>
          <map size="2">
           <str val="duplicates"/>
           <str val="reject"/>
           <str val="duplicates-error-code"/>
           <str val="XTDE3365"/>
          </map>
         </ifCall>
         <sequence line="2562">
          <message>
           <sequence role="select">
            <valueOf>
             <str val="xforms:setvalue found !!!! XXX, node&#xA;                    "/>
            </valueOf>
            <valueOf line="2563">
             <fn name="serialize">
              <dot type="element()"/>
             </fn>
            </valueOf>
            <valueOf>
             <str val=", id= "/>
            </valueOf>
            <valueOf line="2563">
             <convert from="xs:untypedAtomic" to="xs:string">
              <attVal name="Q{}id" chk="0"/>
             </convert>
            </valueOf>
            <valueOf>
             <str val=",&#xA;                    myid = "/>
            </valueOf>
            <valueOf line="2564">
             <fn name="string-join">
              <convert from="xs:anyAtomicType" to="xs:string">
               <data>
                <mergeAdj>
                 <varRef name="myid" slot="6"/>
                </mergeAdj>
               </data>
              </convert>
              <str val=" "/>
             </fn>
            </valueOf>
            <valueOf>
             <str val=", nodeset="/>
            </valueOf>
            <valueOf line="2565">
             <fn name="string-join">
              <convert from="xs:anyAtomicType" to="xs:string">
               <data>
                <mergeAdj>
                 <varRef name="nodeseti" slot="7"/>
                </mergeAdj>
               </data>
              </convert>
              <str val=" "/>
             </fn>
            </valueOf>
            <valueOf>
             <str val="&#xA;                    action xml "/>
            </valueOf>
            <valueOf line="2566">
             <fn name="serialize">
              <varRef name="action-map" slot="8"/>
              <map size="1">
               <str val="method"/>
               <str val="json"/>
              </map>
             </fn>
            </valueOf>
           </sequence>
           <str role="terminate" val="no"/>
           <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
          </message>
          <varRef line="2590" name="action-map" slot="8"/>
         </sequence>
        </let>
       </sequence>
      </choose>
     </let>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="18" rank="1" minImp="0" slots="9" flags="s" line="2497" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}script)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='script';"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2498">
     <param name="Q{}instance1" slot="0" flags="t" as="node()?">
      <empty role="select"/>
      <treat role="conversion" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="8|0|XTTE0590|instance1">
       <check card="?" diag="8|0|XTTE0590|instance1">
        <supplied slot="0"/>
       </check>
      </treat>
     </param>
     <param line="2499" name="Q{}bindings" slot="1" flags="t" as="map(xs:string, node())">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, node())" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.isNode(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|bindings">
       <check card="1" diag="8|0|XTTE0590|bindings">
        <supplied slot="1"/>
       </check>
      </treat>
     </param>
     <param line="2500" name="Q{}submissions" slot="2" flags="t" as="map(xs:string, xs:string)">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, xs:string)" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.Atomic.string.matches(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|submissions">
       <check card="1" diag="8|0|XTTE0590|submissions">
        <supplied slot="2"/>
       </check>
      </treat>
     </param>
     <param line="2501" name="Q{}position" slot="3">
      <str role="select" val=""/>
      <supplied role="conversion" slot="3"/>
     </param>
     <param line="2502" name="Q{}nodeset" slot="4">
      <str role="select" val=""/>
      <supplied role="conversion" slot="4"/>
     </param>
     <param line="2503" name="Q{}updateMode" slot="5" flags="t">
      <false role="select"/>
      <supplied role="conversion" slot="5"/>
     </param>
     <param line="2509" name="Q{}myid" slot="6" flags="t">
      <choose role="select">
       <fn name="exists">
        <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       </fn>
       <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       <true/>
       <fn name="concat">
        <fn name="generate-id">
         <dot type="element()"/>
        </fn>
        <atomSing card="?" diag="0|1||fn:concat">
         <varRef name="position" slot="3"/>
        </atomSing>
       </fn>
      </choose>
      <supplied role="conversion" slot="6"/>
     </param>
     <let line="2512" var="nodeseti" as="item()*" slot="7" eval="3">
      <choose>
       <gc op="=" card="N:1" comp="GAC|http://www.w3.org/2005/xpath-functions/collation/codepoint">
        <data>
         <varRef name="nodeset" slot="4"/>
        </data>
        <str val=""/>
       </gc>
       <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
       <true/>
       <varRef name="nodeset" slot="4"/>
      </choose>
      <choose line="2514">
       <fn name="not">
        <varRef name="updateMode" slot="5"/>
       </fn>
       <sequence line="2516">
        <message>
         <sequence role="select">
          <valueOf>
           <str val="xforms:setvalue found !!!! XXX, node&#xA;                        "/>
          </valueOf>
          <valueOf line="2517">
           <fn name="serialize">
            <dot type="element()"/>
           </fn>
          </valueOf>
          <valueOf>
           <str val=", id= "/>
          </valueOf>
          <valueOf line="2517">
           <convert from="xs:untypedAtomic" to="xs:string">
            <attVal name="Q{}id" chk="0"/>
           </convert>
          </valueOf>
          <valueOf>
           <str val=",&#xA;                    myid = "/>
          </valueOf>
          <valueOf line="2518">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="myid" slot="6"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
          <valueOf>
           <str val=", nodeset="/>
          </valueOf>
          <valueOf line="2519">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="nodeseti" slot="7"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
         </sequence>
         <str role="terminate" val="no"/>
         <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
        </message>
        <let line="2522" var="action-map" as="map(xs:anyAtomicType, item()*)" slot="8" eval="8">
         <ifCall line="2526" name="Q{http://www.w3.org/2005/xpath-functions/map}merge" type="map(*)">
          <sequence>
           <choose>
            <fn name="exists">
             <varRef name="nodeset" slot="4"/>
            </fn>
            <ifCall line="2527" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@ref"/>
             <cast as="xs:string" emptiable="1">
              <atomSing card="?" diag="2|0||cast as">
               <varRef name="nodeset" slot="4"/>
              </atomSing>
             </cast>
            </ifCall>
           </choose>
           <choose line="2530">
            <fn name="exists">
             <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
            </fn>
            <ifCall line="2531" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@event"/>
             <cast as="xs:string" emptiable="1">
              <atomSing card="?" diag="2|0||cast as">
               <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
              </atomSing>
             </cast>
            </ifCall>
           </choose>
           <choose line="2534">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
            </fn>
            <ifCall line="2535" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@position"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2537">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
            </fn>
            <ifCall line="2538" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@at"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2540">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
            </fn>
            <ifCall line="2541" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@if"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2543">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
            </fn>
            <ifCall line="2544" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@while"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
             </fn>
            </ifCall>
           </choose>
           <treat line="2547" as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="18|0|XTTE3375|">
            <forEachGroup algorithm="by">
             <dot role="select" type="element()"/>
             <fn role="key" name="local-name">
              <dot type="element()"/>
             </fn>
             <str role="collation" val="http://www.w3.org/2005/xpath-functions/collation/codepoint"/>
             <applyT role="content" line="2548" mode="Q{}xforms-action-map" bSlot="1">
              <dot role="select" type="element()"/>
              <withParam name="Q{}nodeset">
               <varRef line="2549" name="nodeset" slot="4"/>
              </withParam>
             </applyT>
            </forEachGroup>
           </treat>
          </sequence>
          <map size="2">
           <str val="duplicates"/>
           <str val="reject"/>
           <str val="duplicates-error-code"/>
           <str val="XTDE3365"/>
          </map>
         </ifCall>
         <sequence line="2562">
          <message>
           <sequence role="select">
            <valueOf>
             <str val="xforms:setvalue found !!!! XXX, node&#xA;                    "/>
            </valueOf>
            <valueOf line="2563">
             <fn name="serialize">
              <dot type="element()"/>
             </fn>
            </valueOf>
            <valueOf>
             <str val=", id= "/>
            </valueOf>
            <valueOf line="2563">
             <convert from="xs:untypedAtomic" to="xs:string">
              <attVal name="Q{}id" chk="0"/>
             </convert>
            </valueOf>
            <valueOf>
             <str val=",&#xA;                    myid = "/>
            </valueOf>
            <valueOf line="2564">
             <fn name="string-join">
              <convert from="xs:anyAtomicType" to="xs:string">
               <data>
                <mergeAdj>
                 <varRef name="myid" slot="6"/>
                </mergeAdj>
               </data>
              </convert>
              <str val=" "/>
             </fn>
            </valueOf>
            <valueOf>
             <str val=", nodeset="/>
            </valueOf>
            <valueOf line="2565">
             <fn name="string-join">
              <convert from="xs:anyAtomicType" to="xs:string">
               <data>
                <mergeAdj>
                 <varRef name="nodeseti" slot="7"/>
                </mergeAdj>
               </data>
              </convert>
              <str val=" "/>
             </fn>
            </valueOf>
            <valueOf>
             <str val="&#xA;                    action xml "/>
            </valueOf>
            <valueOf line="2566">
             <fn name="serialize">
              <varRef name="action-map" slot="8"/>
              <map size="1">
               <str val="method"/>
               <str val="json"/>
              </map>
             </fn>
            </valueOf>
           </sequence>
           <str role="terminate" val="no"/>
           <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
          </message>
          <varRef line="2590" name="action-map" slot="8"/>
         </sequence>
        </let>
       </sequence>
      </choose>
     </let>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="18" rank="1" minImp="0" slots="9" flags="s" line="2497" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}setindex)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='setindex';"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2498">
     <param name="Q{}instance1" slot="0" flags="t" as="node()?">
      <empty role="select"/>
      <treat role="conversion" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="8|0|XTTE0590|instance1">
       <check card="?" diag="8|0|XTTE0590|instance1">
        <supplied slot="0"/>
       </check>
      </treat>
     </param>
     <param line="2499" name="Q{}bindings" slot="1" flags="t" as="map(xs:string, node())">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, node())" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.isNode(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|bindings">
       <check card="1" diag="8|0|XTTE0590|bindings">
        <supplied slot="1"/>
       </check>
      </treat>
     </param>
     <param line="2500" name="Q{}submissions" slot="2" flags="t" as="map(xs:string, xs:string)">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, xs:string)" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.Atomic.string.matches(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|submissions">
       <check card="1" diag="8|0|XTTE0590|submissions">
        <supplied slot="2"/>
       </check>
      </treat>
     </param>
     <param line="2501" name="Q{}position" slot="3">
      <str role="select" val=""/>
      <supplied role="conversion" slot="3"/>
     </param>
     <param line="2502" name="Q{}nodeset" slot="4">
      <str role="select" val=""/>
      <supplied role="conversion" slot="4"/>
     </param>
     <param line="2503" name="Q{}updateMode" slot="5" flags="t">
      <false role="select"/>
      <supplied role="conversion" slot="5"/>
     </param>
     <param line="2509" name="Q{}myid" slot="6" flags="t">
      <choose role="select">
       <fn name="exists">
        <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       </fn>
       <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       <true/>
       <fn name="concat">
        <fn name="generate-id">
         <dot type="element()"/>
        </fn>
        <atomSing card="?" diag="0|1||fn:concat">
         <varRef name="position" slot="3"/>
        </atomSing>
       </fn>
      </choose>
      <supplied role="conversion" slot="6"/>
     </param>
     <let line="2512" var="nodeseti" as="item()*" slot="7" eval="3">
      <choose>
       <gc op="=" card="N:1" comp="GAC|http://www.w3.org/2005/xpath-functions/collation/codepoint">
        <data>
         <varRef name="nodeset" slot="4"/>
        </data>
        <str val=""/>
       </gc>
       <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
       <true/>
       <varRef name="nodeset" slot="4"/>
      </choose>
      <choose line="2514">
       <fn name="not">
        <varRef name="updateMode" slot="5"/>
       </fn>
       <sequence line="2516">
        <message>
         <sequence role="select">
          <valueOf>
           <str val="xforms:setvalue found !!!! XXX, node&#xA;                        "/>
          </valueOf>
          <valueOf line="2517">
           <fn name="serialize">
            <dot type="element()"/>
           </fn>
          </valueOf>
          <valueOf>
           <str val=", id= "/>
          </valueOf>
          <valueOf line="2517">
           <convert from="xs:untypedAtomic" to="xs:string">
            <attVal name="Q{}id" chk="0"/>
           </convert>
          </valueOf>
          <valueOf>
           <str val=",&#xA;                    myid = "/>
          </valueOf>
          <valueOf line="2518">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="myid" slot="6"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
          <valueOf>
           <str val=", nodeset="/>
          </valueOf>
          <valueOf line="2519">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="nodeseti" slot="7"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
         </sequence>
         <str role="terminate" val="no"/>
         <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
        </message>
        <let line="2522" var="action-map" as="map(xs:anyAtomicType, item()*)" slot="8" eval="8">
         <ifCall line="2526" name="Q{http://www.w3.org/2005/xpath-functions/map}merge" type="map(*)">
          <sequence>
           <choose>
            <fn name="exists">
             <varRef name="nodeset" slot="4"/>
            </fn>
            <ifCall line="2527" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@ref"/>
             <cast as="xs:string" emptiable="1">
              <atomSing card="?" diag="2|0||cast as">
               <varRef name="nodeset" slot="4"/>
              </atomSing>
             </cast>
            </ifCall>
           </choose>
           <choose line="2530">
            <fn name="exists">
             <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
            </fn>
            <ifCall line="2531" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@event"/>
             <cast as="xs:string" emptiable="1">
              <atomSing card="?" diag="2|0||cast as">
               <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
              </atomSing>
             </cast>
            </ifCall>
           </choose>
           <choose line="2534">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
            </fn>
            <ifCall line="2535" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@position"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2537">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
            </fn>
            <ifCall line="2538" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@at"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2540">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
            </fn>
            <ifCall line="2541" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@if"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2543">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
            </fn>
            <ifCall line="2544" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@while"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
             </fn>
            </ifCall>
           </choose>
           <treat line="2547" as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="18|0|XTTE3375|">
            <forEachGroup algorithm="by">
             <dot role="select" type="element()"/>
             <fn role="key" name="local-name">
              <dot type="element()"/>
             </fn>
             <str role="collation" val="http://www.w3.org/2005/xpath-functions/collation/codepoint"/>
             <applyT role="content" line="2548" mode="Q{}xforms-action-map" bSlot="1">
              <dot role="select" type="element()"/>
              <withParam name="Q{}nodeset">
               <varRef line="2549" name="nodeset" slot="4"/>
              </withParam>
             </applyT>
            </forEachGroup>
           </treat>
          </sequence>
          <map size="2">
           <str val="duplicates"/>
           <str val="reject"/>
           <str val="duplicates-error-code"/>
           <str val="XTDE3365"/>
          </map>
         </ifCall>
         <sequence line="2562">
          <message>
           <sequence role="select">
            <valueOf>
             <str val="xforms:setvalue found !!!! XXX, node&#xA;                    "/>
            </valueOf>
            <valueOf line="2563">
             <fn name="serialize">
              <dot type="element()"/>
             </fn>
            </valueOf>
            <valueOf>
             <str val=", id= "/>
            </valueOf>
            <valueOf line="2563">
             <convert from="xs:untypedAtomic" to="xs:string">
              <attVal name="Q{}id" chk="0"/>
             </convert>
            </valueOf>
            <valueOf>
             <str val=",&#xA;                    myid = "/>
            </valueOf>
            <valueOf line="2564">
             <fn name="string-join">
              <convert from="xs:anyAtomicType" to="xs:string">
               <data>
                <mergeAdj>
                 <varRef name="myid" slot="6"/>
                </mergeAdj>
               </data>
              </convert>
              <str val=" "/>
             </fn>
            </valueOf>
            <valueOf>
             <str val=", nodeset="/>
            </valueOf>
            <valueOf line="2565">
             <fn name="string-join">
              <convert from="xs:anyAtomicType" to="xs:string">
               <data>
                <mergeAdj>
                 <varRef name="nodeseti" slot="7"/>
                </mergeAdj>
               </data>
              </convert>
              <str val=" "/>
             </fn>
            </valueOf>
            <valueOf>
             <str val="&#xA;                    action xml "/>
            </valueOf>
            <valueOf line="2566">
             <fn name="serialize">
              <varRef name="action-map" slot="8"/>
              <map size="1">
               <str val="method"/>
               <str val="json"/>
              </map>
             </fn>
            </valueOf>
           </sequence>
           <str role="terminate" val="no"/>
           <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
          </message>
          <varRef line="2590" name="action-map" slot="8"/>
         </sequence>
        </let>
       </sequence>
      </choose>
     </let>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="2.0" seq="6" rank="3" minImp="0" slots="6" flags="s" line="1506" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}textarea)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='textarea';"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="1509">
     <param name="Q{}nodeset" slot="0" as="xs:string">
      <str role="select" val=""/>
      <treat role="conversion" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="8|0|XTTE0590|nodeset">
       <check card="1" diag="8|0|XTTE0590|nodeset">
        <cvUntyped to="xs:string">
         <data>
          <supplied slot="0"/>
         </data>
        </cvUntyped>
       </check>
      </treat>
     </param>
     <applyT line="1510" bSlot="2">
      <axis role="select" name="child" nodeTest="element()" jsTest="return item.nodeType===1;"/>
     </applyT>
     <let line="1512" var="hints" as="text()*" slot="1" eval="3">
      <slash>
       <axis name="child" nodeTest="element(Q{http://www.w3.org/2002/xforms}hint)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='hint';"/>
       <axis name="child" nodeTest="text()" jsTest="return item.nodeType===3;"/>
      </slash>
      <let line="1514" var="actions" as="map(*)*" slot="2" eval="3">
       <treat line="1515" as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="3|0|XTTE0570|actions">
        <applyT bSlot="3">
         <axis role="select" name="child" nodeTest="((((((((((((((((element(Q{http://www.w3.org/2002/xforms}action) | element(Q{http://www.w3.org/2002/xforms}setvalue)) | element(Q{http://www.w3.org/2002/xforms}insert)) | element(Q{http://www.w3.org/2002/xforms}delete)) | element(Q{http://www.w3.org/2002/xforms}toggle)) | element(Q{http://www.w3.org/2002/xforms}send)) | element(Q{http://www.w3.org/2002/xforms}setfocus)) | element(Q{http://www.w3.org/2002/xforms}setindex)) | element(Q{http://www.w3.org/2002/xforms}load)) | element(Q{http://www.w3.org/2002/xforms}message)) | element(Q{http://www.w3.org/2002/xforms}dispatch)) | element(Q{http://www.w3.org/2002/xforms}rebuild)) | element(Q{http://www.w3.org/2002/xforms}reset)) | element(Q{http://www.w3.org/2002/xforms}show)) | element(Q{http://www.w3.org/2002/xforms}hide)) | element(Q{http://www.w3.org/2002/xforms}script)) | element(Q{http://www.w3.org/2002/xforms}unload))" jsTest="function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='action';};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='setvalue';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='insert';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='delete';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='toggle';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='send';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='setfocus';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='setindex';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='load';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='message';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='dispatch';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='rebuild';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='reset';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='show';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='hide';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='script';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='unload';};return a()||b();"/>
         <withParam name="Q{}nodeset" as="xs:string">
          <varRef line="1517" name="nodeset" slot="0"/>
         </withParam>
        </applyT>
       </treat>
       <let line="1524" var="bindingi" as="node()?" slot="3" eval="7">
        <treat line="1525" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="3|0|XTTE0570|bindingi">
         <check card="?" diag="3|0|XTTE0570|bindingi">
          <callT name="getBinding" bSlot="4">
           <withParam name="Q{}this" flags="c" as="element()">
            <dot line="1526" type="element(Q{http://www.w3.org/2002/xforms}textarea)"/>
           </withParam>
          </callT>
         </check>
        </treat>
        <sequence line="1530">
         <message>
          <sequence role="select">
           <valueOf>
            <str val="[xforms:textarea] bindingi = "/>
           </valueOf>
           <valueOf>
            <fn name="serialize">
             <varRef name="bindingi" slot="3"/>
            </fn>
           </valueOf>
          </sequence>
          <str role="terminate" val="no"/>
          <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
         </message>
         <let line="1533" var="refi" as="xs:string" slot="4" eval="7">
          <treat line="1534" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="3|0|XTTE0570|refi">
           <check card="1" diag="3|0|XTTE0570|refi">
            <cvUntyped to="xs:string">
             <data>
              <callT name="getDataRef" bSlot="5">
               <withParam name="Q{}this" flags="c" as="element()">
                <dot line="1535" type="element(Q{http://www.w3.org/2002/xforms}textarea)"/>
               </withParam>
               <withParam name="Q{}bindingi" flags="c" as="node()?">
                <varRef line="1536" name="bindingi" slot="3"/>
               </withParam>
              </callT>
             </data>
            </cvUntyped>
           </check>
          </treat>
          <let line="1546" var="instanceField" as="node()?" slot="5" eval="7">
           <treat line="1547" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="3|0|XTTE0570|instanceField">
            <check card="?" diag="3|0|XTTE0570|instanceField">
             <callT name="getReferencedInstanceField" bSlot="6">
              <withParam name="Q{}refi" flags="c" as="xs:string">
               <varRef line="1548" name="refi" slot="4"/>
              </withParam>
             </callT>
            </check>
           </treat>
           <sequence line="1553">
            <choose>
             <fn name="exists">
              <varRef name="actions" slot="2"/>
             </fn>
             <ifCall line="1568" name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
              <check card="1" diag="0|0||ixsl:call">
               <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
              </check>
              <str val="addAction"/>
              <arrayBlock>
               <choose line="1558">
                <fn name="exists">
                 <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
                </fn>
                <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
                <true/>
                <fn name="generate-id">
                 <dot type="element(Q{http://www.w3.org/2002/xforms}textarea)"/>
                </fn>
               </choose>
               <varRef name="actions" slot="2"/>
              </arrayBlock>
             </ifCall>
            </choose>
            <elem line="1575" name="textarea" nsuri="" namespaces="rdf xhtml js in fn map array ev">
             <sequence>
              <copyOf flags="vc">
               <filter flags="b">
                <axis name="attribute" nodeTest="attribute()" jsTest="return SaxonJS.U.isAttr(item)"/>
                <vc op="ne" comp="CCC">
                 <fn name="local-name">
                  <dot type="attribute()"/>
                 </fn>
                 <str val="ref"/>
                </vc>
               </filter>
              </copyOf>
              <att line="1576" name="data-element" flags="l">
               <lastOf line="1572">
                <fn name="tokenize">
                 <varRef name="refi" slot="4"/>
                 <str val="/"/>
                 <str val=""/>
                </fn>
               </lastOf>
              </att>
              <att line="1582" name="data-ref" flags="l">
               <choose>
                <fn name="not">
                 <varRef name="nodeset" slot="0"/>
                </fn>
                <fn name="concat">
                 <varRef name="nodeset" slot="0"/>
                 <attVal name="Q{}ref" chk="0"/>
                </fn>
                <true/>
                <fn name="concat">
                 <varRef name="nodeset" slot="0"/>
                 <str val="/"/>
                 <attVal name="Q{}ref" chk="0"/>
                </fn>
               </choose>
              </att>
              <choose line="1584">
               <fn name="exists">
                <varRef name="instanceField" slot="5"/>
               </fn>
               <valueOf line="1585" flags="l">
                <convert from="xs:anyAtomicType" to="xs:string">
                 <data>
                  <varRef name="instanceField" slot="5"/>
                 </data>
                </convert>
               </valueOf>
               <true/>
               <sequence line="1587">
                <valueOf flags="Sl">
                 <str val=""/>
                </valueOf>
                <valueOf flags="l">
                 <str val="  "/>
                </valueOf>
               </sequence>
              </choose>
              <choose line="1590">
               <fn name="exists">
                <varRef name="hints" slot="1"/>
               </fn>
               <att line="1591" name="title" flags="l">
                <fn name="string-join">
                 <convert from="xs:untypedAtomic" to="xs:string">
                  <data>
                   <mergeAdj>
                    <varRef name="hints" slot="1"/>
                   </mergeAdj>
                  </data>
                 </convert>
                 <str val=" "/>
                </fn>
               </att>
              </choose>
             </sequence>
            </elem>
           </sequence>
          </let>
         </let>
        </sequence>
       </let>
      </let>
     </let>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="5" rank="1" minImp="0" slots="11" flags="s" line="1289" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}input)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='input';"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="1293">
     <param name="Q{}nodeset" slot="0" as="xs:string">
      <str role="select" val=""/>
      <treat role="conversion" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="8|0|XTTE0590|nodeset">
       <check card="1" diag="8|0|XTTE0590|nodeset">
        <cvUntyped to="xs:string">
         <data>
          <supplied slot="0"/>
         </data>
        </cvUntyped>
       </check>
      </treat>
     </param>
     <param line="1294" name="Q{}position" slot="1">
      <str role="select" val=""/>
      <supplied role="conversion" slot="1"/>
     </param>
     <message line="1298">
      <sequence role="select">
       <valueOf>
        <str val="xforms:input = "/>
       </valueOf>
       <valueOf>
        <fn name="serialize">
         <dot type="element(Q{http://www.w3.org/2002/xforms}input)"/>
        </fn>
       </valueOf>
       <valueOf>
        <str val=", &#xA;            nodeset = "/>
       </valueOf>
       <valueOf line="1299">
        <varRef name="nodeset" slot="0"/>
       </valueOf>
      </sequence>
      <str role="terminate" val="no"/>
      <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
     </message>
     <let line="1303" var="bindingi" as="node()?" slot="2" eval="7">
      <treat line="1304" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="3|0|XTTE0570|bindingi">
       <check card="?" diag="3|0|XTTE0570|bindingi">
        <callT name="getBinding" bSlot="7">
         <withParam name="Q{}this" flags="c" as="element()">
          <dot line="1305" type="element(Q{http://www.w3.org/2002/xforms}input)"/>
         </withParam>
        </callT>
       </check>
      </treat>
      <sequence line="1309">
       <message>
        <sequence role="select">
         <valueOf>
          <str val="[xforms:input] bindingi: "/>
         </valueOf>
         <valueOf>
          <fn name="serialize">
           <varRef name="bindingi" slot="2"/>
          </fn>
         </valueOf>
        </sequence>
        <str role="terminate" val="no"/>
        <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
       </message>
       <let line="1313" var="refi" as="xs:string" slot="3" eval="7">
        <treat line="1314" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="3|0|XTTE0570|refi">
         <check card="1" diag="3|0|XTTE0570|refi">
          <cvUntyped to="xs:string">
           <data>
            <callT name="getDataRef" bSlot="8">
             <withParam name="Q{}this" flags="c" as="element()">
              <dot line="1315" type="element(Q{http://www.w3.org/2002/xforms}input)"/>
             </withParam>
             <withParam name="Q{}bindingi" flags="c" as="node()?">
              <varRef line="1316" name="bindingi" slot="2"/>
             </withParam>
            </callT>
           </data>
          </cvUntyped>
         </check>
        </treat>
        <sequence line="1320">
         <message>
          <sequence role="select">
           <valueOf>
            <str val="[xforms:input] refi: "/>
           </valueOf>
           <valueOf>
            <varRef name="refi" slot="3"/>
           </valueOf>
          </sequence>
          <str role="terminate" val="no"/>
          <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
         </message>
         <let line="1329" var="instanceForBinding" as="node()?" slot="4" eval="7">
          <treat line="1330" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="3|0|XTTE0570|instanceForBinding">
           <check card="?" diag="3|0|XTTE0570|instanceForBinding">
            <callT name="getItemForBinding" bSlot="9">
             <withParam name="Q{}bindingi" flags="c" as="node()?">
              <varRef line="1331" name="bindingi" slot="2"/>
             </withParam>
            </callT>
           </check>
          </treat>
          <let line="1335" var="instanceField" as="node()?" slot="5" eval="7">
           <treat line="1336" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="3|0|XTTE0570|instanceField">
            <check card="?" diag="3|0|XTTE0570|instanceField">
             <callT name="getReferencedInstanceField" bSlot="10">
              <withParam name="Q{}refi" flags="c" as="xs:string">
               <varRef line="1337" name="refi" slot="3"/>
              </withParam>
             </callT>
            </check>
           </treat>
           <sequence line="1342">
            <message>
             <sequence role="select">
              <valueOf>
               <str val="[xforms:input] instanceField = "/>
              </valueOf>
              <valueOf>
               <fn name="serialize">
                <varRef name="instanceField" slot="5"/>
               </fn>
              </valueOf>
             </sequence>
             <str role="terminate" val="no"/>
             <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
            </message>
            <let line="1344" var="relevantVar" as="xs:boolean" slot="6" eval="7">
             <choose line="1346">
              <and op="and">
               <and op="and">
                <fn name="exists">
                 <varRef name="bindingi" slot="2"/>
                </fn>
                <fn name="exists">
                 <slash simple="1">
                  <varRef name="bindingi" slot="2"/>
                  <axis name="attribute" nodeTest="attribute(Q{}relevant)" jsTest="return item.name==='relevant'"/>
                 </slash>
                </fn>
               </and>
               <fn name="exists">
                <varRef name="instanceForBinding" slot="4"/>
               </fn>
              </and>
              <treat line="1348" as="xs:boolean" jsTest="return SaxonJS.U.Atomic.boolean.matches(item);" diag="3|0|XTTE0570|relevantVar">
               <check card="1" diag="3|0|XTTE0570|relevantVar">
                <cvUntyped to="xs:boolean">
                 <data>
                  <evaluate dxns="">
                   <ufCall role="xpath" name="Q{http://www.w3.org/2002/xforms}impose" tailCall="false" bSlot="11" eval="4">
                    <check card="1" diag="0|0||xforms:impose">
                     <cvUntyped to="xs:string">
                      <data>
                       <slash simple="1">
                        <varRef name="bindingi" slot="2"/>
                        <axis name="attribute" nodeTest="attribute(Q{}relevant)" jsTest="return item.name==='relevant'"/>
                       </slash>
                      </data>
                     </cvUntyped>
                    </check>
                   </ufCall>
                   <varRef role="cxt" name="instanceForBinding" slot="4"/>
                   <str role="sa" val="no"/>
                   <map role="wp" size="0"/>
                  </evaluate>
                 </data>
                </cvUntyped>
               </check>
              </treat>
              <true/>
              <true/>
             </choose>
             <let line="1356" var="actions" as="map(*)*" slot="7" eval="3">
              <treat line="1357" as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="3|0|XTTE0570|actions">
               <applyT bSlot="12">
                <axis role="select" name="child" nodeTest="((((((((((((((((element(Q{http://www.w3.org/2002/xforms}action) | element(Q{http://www.w3.org/2002/xforms}setvalue)) | element(Q{http://www.w3.org/2002/xforms}insert)) | element(Q{http://www.w3.org/2002/xforms}delete)) | element(Q{http://www.w3.org/2002/xforms}toggle)) | element(Q{http://www.w3.org/2002/xforms}send)) | element(Q{http://www.w3.org/2002/xforms}setfocus)) | element(Q{http://www.w3.org/2002/xforms}setindex)) | element(Q{http://www.w3.org/2002/xforms}load)) | element(Q{http://www.w3.org/2002/xforms}message)) | element(Q{http://www.w3.org/2002/xforms}dispatch)) | element(Q{http://www.w3.org/2002/xforms}rebuild)) | element(Q{http://www.w3.org/2002/xforms}reset)) | element(Q{http://www.w3.org/2002/xforms}show)) | element(Q{http://www.w3.org/2002/xforms}hide)) | element(Q{http://www.w3.org/2002/xforms}script)) | element(Q{http://www.w3.org/2002/xforms}unload))" jsTest="function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='action';};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='setvalue';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='insert';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='delete';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='toggle';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='send';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='setfocus';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='setindex';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='load';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='message';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='dispatch';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='rebuild';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='reset';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='show';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='hide';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='script';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='unload';};return a()||b();"/>
                <withParam name="Q{}nodeset" as="xs:string">
                 <varRef line="1359" name="refi" slot="3"/>
                </withParam>
                <withParam name="Q{}position">
                 <varRef line="1361" name="position" slot="1"/>
                </withParam>
               </applyT>
              </treat>
              <let line="1369" var="myid" as="item()?" slot="8" eval="7">
               <choose>
                <fn name="exists">
                 <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
                </fn>
                <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
                <true/>
                <fn name="concat">
                 <fn name="generate-id">
                  <dot type="element(Q{http://www.w3.org/2002/xforms}input)"/>
                 </fn>
                 <atomSing card="?" diag="0|1||fn:concat">
                  <varRef name="position" slot="1"/>
                 </atomSing>
                </fn>
               </choose>
               <sequence line="1371">
                <choose>
                 <fn name="exists">
                  <varRef name="actions" slot="7"/>
                 </fn>
                 <ifCall line="1372" name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
                  <check card="1" diag="0|0||ixsl:call">
                   <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
                  </check>
                  <str val="addAction"/>
                  <arrayBlock>
                   <varRef name="myid" slot="8"/>
                   <varRef name="actions" slot="7"/>
                  </arrayBlock>
                 </ifCall>
                </choose>
                <elem line="1382" name="span" nsuri="" namespaces="rdf xhtml js in fn map array ev">
                 <sequence>
                  <att name="style" flags="l">
                   <choose>
                    <varRef name="relevantVar" slot="6"/>
                    <str val="display:inline"/>
                    <true/>
                    <str val="display:none"/>
                   </choose>
                  </att>
                  <applyT line="1385" bSlot="13">
                   <axis role="select" name="child" nodeTest="(element(Q{http://www.w3.org/2002/xforms}label) | element(Q{http://www.w3.org/2002/xforms}hint))" jsTest="function a() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='label';};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='hint';};return a()||b();"/>
                   <withParam name="Q{}nodeset" as="xs:string">
                    <varRef line="1387" name="refi" slot="3"/>
                   </withParam>
                   <withParam name="Q{}position">
                    <varRef line="1389" name="position" slot="1"/>
                   </withParam>
                  </applyT>
                  <let line="1395" var="hints" as="text()*" slot="9" eval="3">
                   <slash>
                    <axis name="child" nodeTest="element(Q{http://www.w3.org/2002/xforms}hint)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='hint';"/>
                    <axis name="child" nodeTest="text()" jsTest="return item.nodeType===3;"/>
                   </slash>
                   <elem line="1400" name="input" nsuri="" flags="l" namespaces="rdf xhtml js in fn map array ev">
                    <sequence>
                     <att name="data-element" flags="l">
                      <lastOf line="1397">
                       <fn name="tokenize">
                        <varRef name="refi" slot="3"/>
                        <str val="/"/>
                        <str val=""/>
                       </fn>
                      </lastOf>
                     </att>
                     <choose line="1401">
                      <and op="and">
                       <fn name="exists">
                        <varRef name="bindingi" slot="2"/>
                       </fn>
                       <fn name="exists">
                        <slash simple="1">
                         <varRef name="bindingi" slot="2"/>
                         <axis name="attribute" nodeTest="attribute(Q{}required)" jsTest="return item.name==='required'"/>
                        </slash>
                       </fn>
                      </and>
                      <att line="1402" name="data-required" flags="l">
                       <convert from="xs:untypedAtomic" to="xs:string">
                        <data>
                         <slash simple="1">
                          <varRef name="bindingi" slot="2"/>
                          <axis name="attribute" nodeTest="attribute(Q{}required)" jsTest="return item.name==='required'"/>
                         </slash>
                        </data>
                       </convert>
                      </att>
                     </choose>
                     <choose line="1404">
                      <and op="and">
                       <fn name="exists">
                        <varRef name="bindingi" slot="2"/>
                       </fn>
                       <fn name="exists">
                        <slash simple="1">
                         <varRef name="bindingi" slot="2"/>
                         <axis name="attribute" nodeTest="attribute(Q{}constraint)" jsTest="return item.name==='constraint'"/>
                        </slash>
                       </fn>
                      </and>
                      <att line="1405" name="data-constraint" flags="l">
                       <convert from="xs:untypedAtomic" to="xs:string">
                        <data>
                         <slash simple="1">
                          <varRef name="bindingi" slot="2"/>
                          <axis name="attribute" nodeTest="attribute(Q{}constraint)" jsTest="return item.name==='constraint'"/>
                         </slash>
                        </data>
                       </convert>
                      </att>
                     </choose>
                     <choose line="1407">
                      <fn name="exists">
                       <varRef name="actions" slot="7"/>
                      </fn>
                      <att line="1408" name="data-action" flags="l">
                       <fn name="string-join">
                        <convert from="xs:anyAtomicType" to="xs:string">
                         <data>
                          <varRef name="myid" slot="8"/>
                         </data>
                        </convert>
                        <str val=" "/>
                       </fn>
                      </att>
                     </choose>
                     <choose line="1411">
                      <and op="and">
                       <fn name="exists">
                        <varRef name="bindingi" slot="2"/>
                       </fn>
                       <fn name="exists">
                        <slash simple="1">
                         <varRef name="bindingi" slot="2"/>
                         <axis name="attribute" nodeTest="attribute(Q{}relevant)" jsTest="return item.name==='relevant'"/>
                        </slash>
                       </fn>
                      </and>
                      <att line="1412" name="data-relevant" flags="l">
                       <convert from="xs:untypedAtomic" to="xs:string">
                        <data>
                         <slash simple="1">
                          <varRef name="bindingi" slot="2"/>
                          <axis name="attribute" nodeTest="attribute(Q{}relevant)" jsTest="return item.name==='relevant'"/>
                         </slash>
                        </data>
                       </convert>
                      </att>
                     </choose>
                     <choose line="1427">
                      <choose>
                       <fn name="exists">
                        <varRef name="bindingi" slot="2"/>
                       </fn>
                       <vc op="eq" comp="EQC">
                        <cast as="xs:QName" emptiable="1">
                         <data>
                          <slash simple="1">
                           <varRef name="bindingi" slot="2"/>
                           <axis name="attribute" nodeTest="attribute(Q{}type)" jsTest="return item.name==='type'"/>
                          </slash>
                         </data>
                        </cast>
                        <qName pre="xs" uri="http://www.w3.org/2001/XMLSchema" loc="date"/>
                       </vc>
                       <true/>
                       <false/>
                      </choose>
                      <sequence line="1428">
                       <att name="data-type" flags="l">
                        <str val="date"/>
                       </att>
                       <att line="1430" name="type" flags="l">
                        <str val="date"/>
                       </att>
                       <att line="1433" name="value" flags="l">
                        <convert from="xs:untypedAtomic" to="xs:string">
                         <choose>
                          <fn name="exists">
                           <varRef name="instanceField" slot="5"/>
                          </fn>
                          <cast line="1434" as="xs:untypedAtomic" emptiable="0">
                           <fn name="string">
                            <convert from="xs:anyAtomicType" to="xs:string">
                             <data>
                              <varRef name="instanceField" slot="5"/>
                             </data>
                            </convert>
                           </fn>
                          </cast>
                         </choose>
                        </convert>
                       </att>
                      </sequence>
                      <choose line="1443">
                       <fn name="exists">
                        <varRef name="bindingi" slot="2"/>
                       </fn>
                       <vc op="eq" comp="EQC">
                        <cast as="xs:QName" emptiable="1">
                         <data>
                          <slash simple="1">
                           <varRef name="bindingi" slot="2"/>
                           <axis name="attribute" nodeTest="attribute(Q{}type)" jsTest="return item.name==='type'"/>
                          </slash>
                         </data>
                        </cast>
                        <qName pre="xs" uri="http://www.w3.org/2001/XMLSchema" loc="time"/>
                       </vc>
                       <true/>
                       <false/>
                      </choose>
                      <sequence line="1444">
                       <att name="data-type" flags="l">
                        <str val="time"/>
                       </att>
                       <att line="1446" name="type" flags="l">
                        <str val="time"/>
                       </att>
                       <att line="1450" name="value" flags="l">
                        <convert from="xs:untypedAtomic" to="xs:string">
                         <choose>
                          <fn name="exists">
                           <varRef name="instanceField" slot="5"/>
                          </fn>
                          <cast line="1451" as="xs:untypedAtomic" emptiable="0">
                           <fn name="string">
                            <convert from="xs:anyAtomicType" to="xs:string">
                             <data>
                              <varRef name="instanceField" slot="5"/>
                             </data>
                            </convert>
                           </fn>
                          </cast>
                         </choose>
                        </convert>
                       </att>
                      </sequence>
                      <choose line="1460">
                       <fn name="exists">
                        <varRef name="bindingi" slot="2"/>
                       </fn>
                       <vc op="eq" comp="EQC">
                        <cast as="xs:QName" emptiable="1">
                         <data>
                          <slash simple="1">
                           <varRef name="bindingi" slot="2"/>
                           <axis name="attribute" nodeTest="attribute(Q{}type)" jsTest="return item.name==='type'"/>
                          </slash>
                         </data>
                        </cast>
                        <qName pre="xs" uri="http://www.w3.org/2001/XMLSchema" loc="boolean"/>
                       </vc>
                       <true/>
                       <false/>
                      </choose>
                      <sequence line="1461">
                       <att name="data-type" flags="l">
                        <str val="checkbox"/>
                       </att>
                       <att line="1463" name="type" flags="l">
                        <str val="checkbox"/>
                       </att>
                       <choose line="1468">
                        <fn name="exists">
                         <varRef name="instanceField" slot="5"/>
                        </fn>
                        <let line="1469" var="checkedi" as="document-node()" slot="10" eval="7">
                         <doc line="1470" flags="t" validation="preserve">
                          <valueOf flags="l">
                           <convert from="xs:anyAtomicType" to="xs:string">
                            <data>
                             <varRef name="instanceField" slot="5"/>
                            </data>
                           </convert>
                          </valueOf>
                         </doc>
                         <sequence line="1472">
                          <message>
                           <sequence role="select">
                            <valueOf>
                             <convert from="xs:untypedAtomic" to="xs:string">
                              <data>
                               <slash simple="1">
                                <varRef name="bindingi" slot="2"/>
                                <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
                               </slash>
                              </data>
                             </convert>
                            </valueOf>
                            <valueOf>
                             <str val=", $checkedi "/>
                            </valueOf>
                            <valueOf>
                             <fn name="serialize">
                              <varRef name="checkedi" slot="10"/>
                             </fn>
                            </valueOf>
                           </sequence>
                           <str role="terminate" val="no"/>
                           <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
                          </message>
                          <choose line="1473">
                           <and op="and">
                            <and op="and">
                             <fn name="exists">
                              <varRef name="checkedi" slot="10"/>
                             </fn>
                             <cvUntyped to="xs:string">
                              <data>
                               <varRef name="checkedi" slot="10"/>
                              </data>
                             </cvUntyped>
                            </and>
                            <cast as="xs:boolean" emptiable="0">
                             <data>
                              <varRef name="checkedi" slot="10"/>
                             </data>
                            </cast>
                           </and>
                           <att line="1474" name="checked" flags="l">
                            <convert from="xs:untypedAtomic" to="xs:string">
                             <data>
                              <varRef name="checkedi" slot="10"/>
                             </data>
                            </convert>
                           </att>
                          </choose>
                         </sequence>
                        </let>
                       </choose>
                      </sequence>
                      <true/>
                      <sequence line="1481">
                       <choose>
                        <varRef name="relevantVar" slot="6"/>
                        <att line="1482" name="type" flags="l">
                         <str val="text"/>
                        </att>
                       </choose>
                       <att line="1485" name="value" flags="l">
                        <convert from="xs:untypedAtomic" to="xs:string">
                         <choose>
                          <fn name="exists">
                           <varRef name="instanceField" slot="5"/>
                          </fn>
                          <cast line="1486" as="xs:untypedAtomic" emptiable="0">
                           <fn name="string">
                            <convert from="xs:anyAtomicType" to="xs:string">
                             <data>
                              <varRef name="instanceField" slot="5"/>
                             </data>
                            </convert>
                           </fn>
                          </cast>
                         </choose>
                        </convert>
                       </att>
                      </sequence>
                     </choose>
                     <choose line="1493">
                      <fn name="exists">
                       <varRef name="hints" slot="9"/>
                      </fn>
                      <att line="1494" name="title" flags="l">
                       <fn name="string-join">
                        <convert from="xs:untypedAtomic" to="xs:string">
                         <data>
                          <mergeAdj>
                           <varRef name="hints" slot="9"/>
                          </mergeAdj>
                         </data>
                        </convert>
                        <str val=" "/>
                       </fn>
                      </att>
                     </choose>
                     <choose line="1496">
                      <fn name="exists">
                       <axis name="attribute" nodeTest="attribute(Q{}size)" jsTest="return item.name==='size'"/>
                      </fn>
                      <att line="1497" name="size" flags="l">
                       <convert from="xs:untypedAtomic" to="xs:string">
                        <attVal name="Q{}size" chk="0"/>
                       </convert>
                      </att>
                     </choose>
                     <att line="1499" name="data-ref" flags="l">
                      <varRef name="refi" slot="3"/>
                     </att>
                    </sequence>
                   </elem>
                  </let>
                 </sequence>
                </elem>
               </sequence>
              </let>
             </let>
            </let>
           </sequence>
          </let>
         </let>
        </sequence>
       </let>
      </sequence>
     </let>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="18" rank="1" minImp="0" slots="9" flags="s" line="2497" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}reset)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='reset';"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2498">
     <param name="Q{}instance1" slot="0" flags="t" as="node()?">
      <empty role="select"/>
      <treat role="conversion" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="8|0|XTTE0590|instance1">
       <check card="?" diag="8|0|XTTE0590|instance1">
        <supplied slot="0"/>
       </check>
      </treat>
     </param>
     <param line="2499" name="Q{}bindings" slot="1" flags="t" as="map(xs:string, node())">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, node())" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.isNode(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|bindings">
       <check card="1" diag="8|0|XTTE0590|bindings">
        <supplied slot="1"/>
       </check>
      </treat>
     </param>
     <param line="2500" name="Q{}submissions" slot="2" flags="t" as="map(xs:string, xs:string)">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, xs:string)" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.Atomic.string.matches(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|submissions">
       <check card="1" diag="8|0|XTTE0590|submissions">
        <supplied slot="2"/>
       </check>
      </treat>
     </param>
     <param line="2501" name="Q{}position" slot="3">
      <str role="select" val=""/>
      <supplied role="conversion" slot="3"/>
     </param>
     <param line="2502" name="Q{}nodeset" slot="4">
      <str role="select" val=""/>
      <supplied role="conversion" slot="4"/>
     </param>
     <param line="2503" name="Q{}updateMode" slot="5" flags="t">
      <false role="select"/>
      <supplied role="conversion" slot="5"/>
     </param>
     <param line="2509" name="Q{}myid" slot="6" flags="t">
      <choose role="select">
       <fn name="exists">
        <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       </fn>
       <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       <true/>
       <fn name="concat">
        <fn name="generate-id">
         <dot type="element()"/>
        </fn>
        <atomSing card="?" diag="0|1||fn:concat">
         <varRef name="position" slot="3"/>
        </atomSing>
       </fn>
      </choose>
      <supplied role="conversion" slot="6"/>
     </param>
     <let line="2512" var="nodeseti" as="item()*" slot="7" eval="3">
      <choose>
       <gc op="=" card="N:1" comp="GAC|http://www.w3.org/2005/xpath-functions/collation/codepoint">
        <data>
         <varRef name="nodeset" slot="4"/>
        </data>
        <str val=""/>
       </gc>
       <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
       <true/>
       <varRef name="nodeset" slot="4"/>
      </choose>
      <choose line="2514">
       <fn name="not">
        <varRef name="updateMode" slot="5"/>
       </fn>
       <sequence line="2516">
        <message>
         <sequence role="select">
          <valueOf>
           <str val="xforms:setvalue found !!!! XXX, node&#xA;                        "/>
          </valueOf>
          <valueOf line="2517">
           <fn name="serialize">
            <dot type="element()"/>
           </fn>
          </valueOf>
          <valueOf>
           <str val=", id= "/>
          </valueOf>
          <valueOf line="2517">
           <convert from="xs:untypedAtomic" to="xs:string">
            <attVal name="Q{}id" chk="0"/>
           </convert>
          </valueOf>
          <valueOf>
           <str val=",&#xA;                    myid = "/>
          </valueOf>
          <valueOf line="2518">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="myid" slot="6"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
          <valueOf>
           <str val=", nodeset="/>
          </valueOf>
          <valueOf line="2519">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="nodeseti" slot="7"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
         </sequence>
         <str role="terminate" val="no"/>
         <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
        </message>
        <let line="2522" var="action-map" as="map(xs:anyAtomicType, item()*)" slot="8" eval="8">
         <ifCall line="2526" name="Q{http://www.w3.org/2005/xpath-functions/map}merge" type="map(*)">
          <sequence>
           <choose>
            <fn name="exists">
             <varRef name="nodeset" slot="4"/>
            </fn>
            <ifCall line="2527" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@ref"/>
             <cast as="xs:string" emptiable="1">
              <atomSing card="?" diag="2|0||cast as">
               <varRef name="nodeset" slot="4"/>
              </atomSing>
             </cast>
            </ifCall>
           </choose>
           <choose line="2530">
            <fn name="exists">
             <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
            </fn>
            <ifCall line="2531" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@event"/>
             <cast as="xs:string" emptiable="1">
              <atomSing card="?" diag="2|0||cast as">
               <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
              </atomSing>
             </cast>
            </ifCall>
           </choose>
           <choose line="2534">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
            </fn>
            <ifCall line="2535" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@position"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2537">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
            </fn>
            <ifCall line="2538" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@at"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2540">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
            </fn>
            <ifCall line="2541" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@if"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2543">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
            </fn>
            <ifCall line="2544" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@while"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
             </fn>
            </ifCall>
           </choose>
           <treat line="2547" as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="18|0|XTTE3375|">
            <forEachGroup algorithm="by">
             <dot role="select" type="element()"/>
             <fn role="key" name="local-name">
              <dot type="element()"/>
             </fn>
             <str role="collation" val="http://www.w3.org/2005/xpath-functions/collation/codepoint"/>
             <applyT role="content" line="2548" mode="Q{}xforms-action-map" bSlot="1">
              <dot role="select" type="element()"/>
              <withParam name="Q{}nodeset">
               <varRef line="2549" name="nodeset" slot="4"/>
              </withParam>
             </applyT>
            </forEachGroup>
           </treat>
          </sequence>
          <map size="2">
           <str val="duplicates"/>
           <str val="reject"/>
           <str val="duplicates-error-code"/>
           <str val="XTDE3365"/>
          </map>
         </ifCall>
         <sequence line="2562">
          <message>
           <sequence role="select">
            <valueOf>
             <str val="xforms:setvalue found !!!! XXX, node&#xA;                    "/>
            </valueOf>
            <valueOf line="2563">
             <fn name="serialize">
              <dot type="element()"/>
             </fn>
            </valueOf>
            <valueOf>
             <str val=", id= "/>
            </valueOf>
            <valueOf line="2563">
             <convert from="xs:untypedAtomic" to="xs:string">
              <attVal name="Q{}id" chk="0"/>
             </convert>
            </valueOf>
            <valueOf>
             <str val=",&#xA;                    myid = "/>
            </valueOf>
            <valueOf line="2564">
             <fn name="string-join">
              <convert from="xs:anyAtomicType" to="xs:string">
               <data>
                <mergeAdj>
                 <varRef name="myid" slot="6"/>
                </mergeAdj>
               </data>
              </convert>
              <str val=" "/>
             </fn>
            </valueOf>
            <valueOf>
             <str val=", nodeset="/>
            </valueOf>
            <valueOf line="2565">
             <fn name="string-join">
              <convert from="xs:anyAtomicType" to="xs:string">
               <data>
                <mergeAdj>
                 <varRef name="nodeseti" slot="7"/>
                </mergeAdj>
               </data>
              </convert>
              <str val=" "/>
             </fn>
            </valueOf>
            <valueOf>
             <str val="&#xA;                    action xml "/>
            </valueOf>
            <valueOf line="2566">
             <fn name="serialize">
              <varRef name="action-map" slot="8"/>
              <map size="1">
               <str val="method"/>
               <str val="json"/>
              </map>
             </fn>
            </valueOf>
           </sequence>
           <str role="terminate" val="no"/>
           <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
          </message>
          <varRef line="2590" name="action-map" slot="8"/>
         </sequence>
        </let>
       </sequence>
      </choose>
     </let>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="13" rank="1" minImp="0" slots="5" flags="s" line="1787" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}group)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='group';"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="1788">
     <param name="Q{}instance1" slot="0" flags="t" as="node()?">
      <empty role="select"/>
      <treat role="conversion" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="8|0|XTTE0590|instance1">
       <check card="?" diag="8|0|XTTE0590|instance1">
        <supplied slot="0"/>
       </check>
      </treat>
     </param>
     <param line="1789" name="Q{}bindings" slot="1" flags="t" as="map(xs:string, node())">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, node())" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.isNode(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|bindings">
       <check card="1" diag="8|0|XTTE0590|bindings">
        <supplied slot="1"/>
       </check>
      </treat>
     </param>
     <param line="1790" name="Q{}submissions" slot="2" flags="t" as="map(xs:string, xs:string)">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, xs:string)" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.Atomic.string.matches(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|submissions">
       <check card="1" diag="8|0|XTTE0590|submissions">
        <supplied slot="2"/>
       </check>
      </treat>
     </param>
     <let line="1793" var="context" as="element(Q{http://www.w3.org/2002/xforms}group)" slot="3" eval="7">
      <dot type="element(Q{http://www.w3.org/2002/xforms}group)"/>
      <let line="1794" var="refi" as="xs:string?" slot="4" eval="7">
       <choose line="1796">
        <fn name="exists">
         <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
        </fn>
        <cvUntyped to="xs:string">
         <data>
          <slash simple="1">
           <varRef name="context" slot="3"/>
           <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
          </slash>
         </data>
        </cvUntyped>
        <fn line="1797" name="exists">
         <axis name="attribute" nodeTest="attribute(Q{}ref)" jsTest="return item.name==='ref'"/>
        </fn>
        <cvUntyped line="1797" to="xs:string">
         <data>
          <slash simple="1">
           <varRef name="context" slot="3"/>
           <axis name="attribute" nodeTest="attribute(Q{}ref)" jsTest="return item.name==='ref'"/>
          </slash>
         </data>
        </cvUntyped>
       </choose>
       <elem line="1803" name="div" nsuri="" namespaces="rdf xhtml js in fn map array ev">
        <sequence>
         <choose>
          <fn name="exists">
           <varRef name="refi" slot="4"/>
          </fn>
          <att line="1804" name="data-group-ref" flags="l">
           <varRef name="refi" slot="4"/>
          </att>
         </choose>
         <choose line="1806">
          <fn name="exists">
           <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
          </fn>
          <att line="1807" name="id" flags="l">
           <convert from="xs:untypedAtomic" to="xs:string">
            <attVal name="Q{}id" chk="0"/>
           </convert>
          </att>
         </choose>
         <applyT line="1810" bSlot="14">
          <slash role="select" simple="1">
           <varRef name="context" slot="3"/>
           <axis name="child" nodeTest="element()" jsTest="return item.nodeType===1;"/>
          </slash>
          <withParam name="Q{}instance1" as="node()?">
           <varRef line="1811" name="instance1" slot="0"/>
          </withParam>
          <withParam name="Q{}position" as="xs:integer">
           <fn line="1812" name="position"/>
          </withParam>
          <withParam name="Q{}nodeset" as="xs:string?">
           <choose line="1813">
            <fn name="exists">
             <varRef name="refi" slot="4"/>
            </fn>
            <varRef name="refi" slot="4"/>
            <true/>
            <str val=""/>
           </choose>
          </withParam>
          <withParam name="Q{}bindings" as="map(xs:string, node())">
           <varRef line="1814" name="bindings" slot="1"/>
          </withParam>
          <withParam name="Q{}submissions" as="map(xs:string, xs:string)">
           <varRef line="1815" name="submissions" slot="2"/>
          </withParam>
         </applyT>
        </sequence>
       </elem>
      </let>
     </let>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="2" rank="1" minImp="0" slots="0" flags="s" line="1143" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}xform)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='xform';"/>
    <applyT role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="1148" flags="t" bSlot="15">
     <axis role="select" name="child" nodeTest="element()" jsTest="return item.nodeType===1;"/>
    </applyT>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="18" rank="1" minImp="0" slots="9" flags="s" line="2497" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}toggle)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='toggle';"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2498">
     <param name="Q{}instance1" slot="0" flags="t" as="node()?">
      <empty role="select"/>
      <treat role="conversion" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="8|0|XTTE0590|instance1">
       <check card="?" diag="8|0|XTTE0590|instance1">
        <supplied slot="0"/>
       </check>
      </treat>
     </param>
     <param line="2499" name="Q{}bindings" slot="1" flags="t" as="map(xs:string, node())">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, node())" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.isNode(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|bindings">
       <check card="1" diag="8|0|XTTE0590|bindings">
        <supplied slot="1"/>
       </check>
      </treat>
     </param>
     <param line="2500" name="Q{}submissions" slot="2" flags="t" as="map(xs:string, xs:string)">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, xs:string)" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.Atomic.string.matches(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|submissions">
       <check card="1" diag="8|0|XTTE0590|submissions">
        <supplied slot="2"/>
       </check>
      </treat>
     </param>
     <param line="2501" name="Q{}position" slot="3">
      <str role="select" val=""/>
      <supplied role="conversion" slot="3"/>
     </param>
     <param line="2502" name="Q{}nodeset" slot="4">
      <str role="select" val=""/>
      <supplied role="conversion" slot="4"/>
     </param>
     <param line="2503" name="Q{}updateMode" slot="5" flags="t">
      <false role="select"/>
      <supplied role="conversion" slot="5"/>
     </param>
     <param line="2509" name="Q{}myid" slot="6" flags="t">
      <choose role="select">
       <fn name="exists">
        <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       </fn>
       <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       <true/>
       <fn name="concat">
        <fn name="generate-id">
         <dot type="element()"/>
        </fn>
        <atomSing card="?" diag="0|1||fn:concat">
         <varRef name="position" slot="3"/>
        </atomSing>
       </fn>
      </choose>
      <supplied role="conversion" slot="6"/>
     </param>
     <let line="2512" var="nodeseti" as="item()*" slot="7" eval="3">
      <choose>
       <gc op="=" card="N:1" comp="GAC|http://www.w3.org/2005/xpath-functions/collation/codepoint">
        <data>
         <varRef name="nodeset" slot="4"/>
        </data>
        <str val=""/>
       </gc>
       <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
       <true/>
       <varRef name="nodeset" slot="4"/>
      </choose>
      <choose line="2514">
       <fn name="not">
        <varRef name="updateMode" slot="5"/>
       </fn>
       <sequence line="2516">
        <message>
         <sequence role="select">
          <valueOf>
           <str val="xforms:setvalue found !!!! XXX, node&#xA;                        "/>
          </valueOf>
          <valueOf line="2517">
           <fn name="serialize">
            <dot type="element()"/>
           </fn>
          </valueOf>
          <valueOf>
           <str val=", id= "/>
          </valueOf>
          <valueOf line="2517">
           <convert from="xs:untypedAtomic" to="xs:string">
            <attVal name="Q{}id" chk="0"/>
           </convert>
          </valueOf>
          <valueOf>
           <str val=",&#xA;                    myid = "/>
          </valueOf>
          <valueOf line="2518">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="myid" slot="6"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
          <valueOf>
           <str val=", nodeset="/>
          </valueOf>
          <valueOf line="2519">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="nodeseti" slot="7"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
         </sequence>
         <str role="terminate" val="no"/>
         <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
        </message>
        <let line="2522" var="action-map" as="map(xs:anyAtomicType, item()*)" slot="8" eval="8">
         <ifCall line="2526" name="Q{http://www.w3.org/2005/xpath-functions/map}merge" type="map(*)">
          <sequence>
           <choose>
            <fn name="exists">
             <varRef name="nodeset" slot="4"/>
            </fn>
            <ifCall line="2527" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@ref"/>
             <cast as="xs:string" emptiable="1">
              <atomSing card="?" diag="2|0||cast as">
               <varRef name="nodeset" slot="4"/>
              </atomSing>
             </cast>
            </ifCall>
           </choose>
           <choose line="2530">
            <fn name="exists">
             <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
            </fn>
            <ifCall line="2531" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@event"/>
             <cast as="xs:string" emptiable="1">
              <atomSing card="?" diag="2|0||cast as">
               <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
              </atomSing>
             </cast>
            </ifCall>
           </choose>
           <choose line="2534">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
            </fn>
            <ifCall line="2535" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@position"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2537">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
            </fn>
            <ifCall line="2538" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@at"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2540">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
            </fn>
            <ifCall line="2541" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@if"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2543">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
            </fn>
            <ifCall line="2544" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@while"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
             </fn>
            </ifCall>
           </choose>
           <treat line="2547" as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="18|0|XTTE3375|">
            <forEachGroup algorithm="by">
             <dot role="select" type="element()"/>
             <fn role="key" name="local-name">
              <dot type="element()"/>
             </fn>
             <str role="collation" val="http://www.w3.org/2005/xpath-functions/collation/codepoint"/>
             <applyT role="content" line="2548" mode="Q{}xforms-action-map" bSlot="1">
              <dot role="select" type="element()"/>
              <withParam name="Q{}nodeset">
               <varRef line="2549" name="nodeset" slot="4"/>
              </withParam>
             </applyT>
            </forEachGroup>
           </treat>
          </sequence>
          <map size="2">
           <str val="duplicates"/>
           <str val="reject"/>
           <str val="duplicates-error-code"/>
           <str val="XTDE3365"/>
          </map>
         </ifCall>
         <sequence line="2562">
          <message>
           <sequence role="select">
            <valueOf>
             <str val="xforms:setvalue found !!!! XXX, node&#xA;                    "/>
            </valueOf>
            <valueOf line="2563">
             <fn name="serialize">
              <dot type="element()"/>
             </fn>
            </valueOf>
            <valueOf>
             <str val=", id= "/>
            </valueOf>
            <valueOf line="2563">
             <convert from="xs:untypedAtomic" to="xs:string">
              <attVal name="Q{}id" chk="0"/>
             </convert>
            </valueOf>
            <valueOf>
             <str val=",&#xA;                    myid = "/>
            </valueOf>
            <valueOf line="2564">
             <fn name="string-join">
              <convert from="xs:anyAtomicType" to="xs:string">
               <data>
                <mergeAdj>
                 <varRef name="myid" slot="6"/>
                </mergeAdj>
               </data>
              </convert>
              <str val=" "/>
             </fn>
            </valueOf>
            <valueOf>
             <str val=", nodeset="/>
            </valueOf>
            <valueOf line="2565">
             <fn name="string-join">
              <convert from="xs:anyAtomicType" to="xs:string">
               <data>
                <mergeAdj>
                 <varRef name="nodeseti" slot="7"/>
                </mergeAdj>
               </data>
              </convert>
              <str val=" "/>
             </fn>
            </valueOf>
            <valueOf>
             <str val="&#xA;                    action xml "/>
            </valueOf>
            <valueOf line="2566">
             <fn name="serialize">
              <varRef name="action-map" slot="8"/>
              <map size="1">
               <str val="method"/>
               <str val="json"/>
              </map>
             </fn>
            </valueOf>
           </sequence>
           <str role="terminate" val="no"/>
           <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
          </message>
          <varRef line="2590" name="action-map" slot="8"/>
         </sequence>
        </let>
       </sequence>
      </choose>
     </let>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="11" rank="1" minImp="0" slots="1" flags="s" line="1758" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}label)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='label';"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="1759">
     <param name="Q{}instance1" slot="0" flags="t" as="node()?">
      <empty role="select"/>
      <treat role="conversion" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="8|0|XTTE0590|instance1">
       <check card="?" diag="8|0|XTTE0590|instance1">
        <supplied slot="0"/>
       </check>
      </treat>
     </param>
     <elem line="1762" name="label" nsuri="" namespaces="rdf xhtml js in fn map array ev">
      <choose>
       <fn name="exists">
        <axis name="child" nodeTest="( element() | text() | comment() | processing-instruction() )" jsTest="return SaxonJS.U.isNode(item) &amp;&amp; (item.nodeType===1 || item.nodeType===3 || item.nodeType===7 || item.nodeType===8);"/>
       </fn>
       <applyT line="1763" bSlot="16">
        <axis role="select" name="child" nodeTest="( element() | text() | comment() | processing-instruction() )" jsTest="return SaxonJS.U.isNode(item) &amp;&amp; (item.nodeType===1 || item.nodeType===3 || item.nodeType===7 || item.nodeType===8);"/>
       </applyT>
       <true/>
       <sequence line="1765">
        <valueOf flags="l">
         <str val=" "/>
        </valueOf>
        <valueOf flags="Sl">
         <str val=""/>
        </valueOf>
       </sequence>
      </choose>
     </elem>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="18" rank="1" minImp="0" slots="9" flags="s" line="2497" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}message)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='message';"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2498">
     <param name="Q{}instance1" slot="0" flags="t" as="node()?">
      <empty role="select"/>
      <treat role="conversion" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="8|0|XTTE0590|instance1">
       <check card="?" diag="8|0|XTTE0590|instance1">
        <supplied slot="0"/>
       </check>
      </treat>
     </param>
     <param line="2499" name="Q{}bindings" slot="1" flags="t" as="map(xs:string, node())">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, node())" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.isNode(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|bindings">
       <check card="1" diag="8|0|XTTE0590|bindings">
        <supplied slot="1"/>
       </check>
      </treat>
     </param>
     <param line="2500" name="Q{}submissions" slot="2" flags="t" as="map(xs:string, xs:string)">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, xs:string)" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.Atomic.string.matches(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|submissions">
       <check card="1" diag="8|0|XTTE0590|submissions">
        <supplied slot="2"/>
       </check>
      </treat>
     </param>
     <param line="2501" name="Q{}position" slot="3">
      <str role="select" val=""/>
      <supplied role="conversion" slot="3"/>
     </param>
     <param line="2502" name="Q{}nodeset" slot="4">
      <str role="select" val=""/>
      <supplied role="conversion" slot="4"/>
     </param>
     <param line="2503" name="Q{}updateMode" slot="5" flags="t">
      <false role="select"/>
      <supplied role="conversion" slot="5"/>
     </param>
     <param line="2509" name="Q{}myid" slot="6" flags="t">
      <choose role="select">
       <fn name="exists">
        <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       </fn>
       <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       <true/>
       <fn name="concat">
        <fn name="generate-id">
         <dot type="element()"/>
        </fn>
        <atomSing card="?" diag="0|1||fn:concat">
         <varRef name="position" slot="3"/>
        </atomSing>
       </fn>
      </choose>
      <supplied role="conversion" slot="6"/>
     </param>
     <let line="2512" var="nodeseti" as="item()*" slot="7" eval="3">
      <choose>
       <gc op="=" card="N:1" comp="GAC|http://www.w3.org/2005/xpath-functions/collation/codepoint">
        <data>
         <varRef name="nodeset" slot="4"/>
        </data>
        <str val=""/>
       </gc>
       <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
       <true/>
       <varRef name="nodeset" slot="4"/>
      </choose>
      <choose line="2514">
       <fn name="not">
        <varRef name="updateMode" slot="5"/>
       </fn>
       <sequence line="2516">
        <message>
         <sequence role="select">
          <valueOf>
           <str val="xforms:setvalue found !!!! XXX, node&#xA;                        "/>
          </valueOf>
          <valueOf line="2517">
           <fn name="serialize">
            <dot type="element()"/>
           </fn>
          </valueOf>
          <valueOf>
           <str val=", id= "/>
          </valueOf>
          <valueOf line="2517">
           <convert from="xs:untypedAtomic" to="xs:string">
            <attVal name="Q{}id" chk="0"/>
           </convert>
          </valueOf>
          <valueOf>
           <str val=",&#xA;                    myid = "/>
          </valueOf>
          <valueOf line="2518">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="myid" slot="6"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
          <valueOf>
           <str val=", nodeset="/>
          </valueOf>
          <valueOf line="2519">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="nodeseti" slot="7"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
         </sequence>
         <str role="terminate" val="no"/>
         <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
        </message>
        <let line="2522" var="action-map" as="map(xs:anyAtomicType, item()*)" slot="8" eval="8">
         <ifCall line="2526" name="Q{http://www.w3.org/2005/xpath-functions/map}merge" type="map(*)">
          <sequence>
           <choose>
            <fn name="exists">
             <varRef name="nodeset" slot="4"/>
            </fn>
            <ifCall line="2527" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@ref"/>
             <cast as="xs:string" emptiable="1">
              <atomSing card="?" diag="2|0||cast as">
               <varRef name="nodeset" slot="4"/>
              </atomSing>
             </cast>
            </ifCall>
           </choose>
           <choose line="2530">
            <fn name="exists">
             <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
            </fn>
            <ifCall line="2531" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@event"/>
             <cast as="xs:string" emptiable="1">
              <atomSing card="?" diag="2|0||cast as">
               <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
              </atomSing>
             </cast>
            </ifCall>
           </choose>
           <choose line="2534">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
            </fn>
            <ifCall line="2535" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@position"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2537">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
            </fn>
            <ifCall line="2538" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@at"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2540">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
            </fn>
            <ifCall line="2541" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@if"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2543">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
            </fn>
            <ifCall line="2544" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@while"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
             </fn>
            </ifCall>
           </choose>
           <treat line="2547" as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="18|0|XTTE3375|">
            <forEachGroup algorithm="by">
             <dot role="select" type="element()"/>
             <fn role="key" name="local-name">
              <dot type="element()"/>
             </fn>
             <str role="collation" val="http://www.w3.org/2005/xpath-functions/collation/codepoint"/>
             <applyT role="content" line="2548" mode="Q{}xforms-action-map" bSlot="1">
              <dot role="select" type="element()"/>
              <withParam name="Q{}nodeset">
               <varRef line="2549" name="nodeset" slot="4"/>
              </withParam>
             </applyT>
            </forEachGroup>
           </treat>
          </sequence>
          <map size="2">
           <str val="duplicates"/>
           <str val="reject"/>
           <str val="duplicates-error-code"/>
           <str val="XTDE3365"/>
          </map>
         </ifCall>
         <sequence line="2562">
          <message>
           <sequence role="select">
            <valueOf>
             <str val="xforms:setvalue found !!!! XXX, node&#xA;                    "/>
            </valueOf>
            <valueOf line="2563">
             <fn name="serialize">
              <dot type="element()"/>
             </fn>
            </valueOf>
            <valueOf>
             <str val=", id= "/>
            </valueOf>
            <valueOf line="2563">
             <convert from="xs:untypedAtomic" to="xs:string">
              <attVal name="Q{}id" chk="0"/>
             </convert>
            </valueOf>
            <valueOf>
             <str val=",&#xA;                    myid = "/>
            </valueOf>
            <valueOf line="2564">
             <fn name="string-join">
              <convert from="xs:anyAtomicType" to="xs:string">
               <data>
                <mergeAdj>
                 <varRef name="myid" slot="6"/>
                </mergeAdj>
               </data>
              </convert>
              <str val=" "/>
             </fn>
            </valueOf>
            <valueOf>
             <str val=", nodeset="/>
            </valueOf>
            <valueOf line="2565">
             <fn name="string-join">
              <convert from="xs:anyAtomicType" to="xs:string">
               <data>
                <mergeAdj>
                 <varRef name="nodeseti" slot="7"/>
                </mergeAdj>
               </data>
              </convert>
              <str val=" "/>
             </fn>
            </valueOf>
            <valueOf>
             <str val="&#xA;                    action xml "/>
            </valueOf>
            <valueOf line="2566">
             <fn name="serialize">
              <varRef name="action-map" slot="8"/>
              <map size="1">
               <str val="method"/>
               <str val="json"/>
              </map>
             </fn>
            </valueOf>
           </sequence>
           <str role="terminate" val="no"/>
           <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
          </message>
          <varRef line="2590" name="action-map" slot="8"/>
         </sequence>
        </let>
       </sequence>
      </choose>
     </let>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="3" rank="1" minImp="0" slots="0" flags="s" line="1155" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/1999/xhtml}html)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/1999/xhtml'&amp;&amp;q.local==='html';"/>
    <elem role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="1157" name="html" nsuri="" namespaces="rdf xhtml js in fn map array ev">
     <sequence>
      <copyOf flags="vc">
       <axis name="attribute" nodeTest="attribute()" jsTest="return SaxonJS.U.isAttr(item)"/>
      </copyOf>
      <elem line="1159" name="head" nsuri="" flags="l" namespaces="rdf xhtml js in fn map array ev">
       <sequence>
        <copyOf flags="vc">
         <union op="|">
          <slash>
           <axis name="child" nodeTest="element(Q{http://www.w3.org/1999/xhtml}head)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/1999/xhtml'&amp;&amp;q.local==='head';"/>
           <axis name="attribute" nodeTest="attribute()" jsTest="return SaxonJS.U.isAttr(item)"/>
          </slash>
          <slash>
           <axis name="child" nodeTest="element(Q{}head)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri===''&amp;&amp;q.local==='head';"/>
           <axis name="attribute" nodeTest="attribute()" jsTest="return SaxonJS.U.isAttr(item)"/>
          </slash>
         </union>
        </copyOf>
        <elem line="1160" name="meta" nsuri="" flags="l">
         <sequence>
          <att name="http-equiv" flags="l">
           <str val="Content-Type"/>
          </att>
          <att name="content" flags="l">
           <str val="text/html;charset=utf-8"/>
          </att>
         </sequence>
        </elem>
        <forEach line="1162">
         <union op="|">
          <filter flags="b">
           <slash>
            <axis name="child" nodeTest="element(Q{http://www.w3.org/1999/xhtml}head)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/1999/xhtml'&amp;&amp;q.local==='head';"/>
            <axis name="child" nodeTest="element(Q{http://www.w3.org/1999/xhtml}meta)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/1999/xhtml'&amp;&amp;q.local==='meta';"/>
           </slash>
           <vc op="ne" comp="CCC">
            <fn name="string">
             <axis name="attribute" nodeTest="attribute(Q{}http-equiv)" jsTest="return item.name==='http-equiv'"/>
            </fn>
            <str val="Content-Type"/>
           </vc>
          </filter>
          <filter flags="b">
           <slash>
            <axis name="child" nodeTest="element(Q{}head)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri===''&amp;&amp;q.local==='head';"/>
            <axis name="child" nodeTest="element(Q{}meta)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri===''&amp;&amp;q.local==='meta';"/>
           </slash>
           <vc op="ne" comp="CCC">
            <fn name="string">
             <axis name="attribute" nodeTest="attribute(Q{}http-equiv)" jsTest="return item.name==='http-equiv'"/>
            </fn>
            <str val="Content-Type"/>
           </vc>
          </filter>
         </union>
         <elem line="1164" name="meta" nsuri="" flags="l" namespaces="rdf xhtml js in fn map array ev">
          <copyOf flags="vc">
           <axis name="attribute" nodeTest="attribute()" jsTest="return SaxonJS.U.isAttr(item)"/>
          </copyOf>
         </elem>
        </forEach>
        <copyOf line="1169" flags="vc">
         <axis name="child" nodeTest="element(Q{}script)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri===''&amp;&amp;q.local==='script';"/>
        </copyOf>
       </sequence>
      </elem>
      <elem line="1172" name="body" nsuri="" flags="l" namespaces="rdf xhtml js in fn map array ev">
       <applyT bSlot="17">
        <slash role="select">
         <axis name="child" nodeTest="element(Q{}body)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri===''&amp;&amp;q.local==='body';"/>
         <axis name="child" nodeTest="element()" jsTest="return item.nodeType===1;"/>
        </slash>
       </applyT>
      </elem>
     </sequence>
    </elem>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="8" rank="1" minImp="0" slots="8" flags="s" line="1598" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}select)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='select';"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="1602">
     <param name="Q{}nodeset" slot="0" as="xs:string">
      <str role="select" val=""/>
      <treat role="conversion" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="8|0|XTTE0590|nodeset">
       <check card="1" diag="8|0|XTTE0590|nodeset">
        <cvUntyped to="xs:string">
         <data>
          <supplied slot="0"/>
         </data>
        </cvUntyped>
       </check>
      </treat>
     </param>
     <param line="1603" name="Q{}position" slot="1">
      <str role="select" val=""/>
      <supplied role="conversion" slot="1"/>
     </param>
     <let line="1611" var="bindingi" as="node()?" slot="2" eval="7">
      <treat line="1612" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="3|0|XTTE0570|bindingi">
       <check card="?" diag="3|0|XTTE0570|bindingi">
        <callT name="getBinding" bSlot="18">
         <withParam name="Q{}this" flags="c" as="element()">
          <dot line="1613" type="element()"/>
         </withParam>
        </callT>
       </check>
      </treat>
      <let line="1618" var="refi" as="xs:string" slot="3" eval="7">
       <treat line="1619" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="3|0|XTTE0570|refi">
        <check card="1" diag="3|0|XTTE0570|refi">
         <cvUntyped to="xs:string">
          <data>
           <callT name="getDataRef" bSlot="19">
            <withParam name="Q{}this" flags="c" as="element()">
             <dot line="1620" type="element()"/>
            </withParam>
            <withParam name="Q{}bindingi" flags="c" as="node()?">
             <varRef line="1621" name="bindingi" slot="2"/>
            </withParam>
           </callT>
          </data>
         </cvUntyped>
        </check>
       </treat>
       <let line="1631" var="instanceField" as="node()?" slot="4" eval="7">
        <treat line="1632" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="3|0|XTTE0570|instanceField">
         <check card="?" diag="3|0|XTTE0570|instanceField">
          <callT name="getReferencedInstanceField" bSlot="20">
           <withParam name="Q{}refi" flags="c" as="xs:string">
            <varRef line="1633" name="refi" slot="3"/>
           </withParam>
          </callT>
         </check>
        </treat>
        <let line="1639" var="selectedValue" as="xs:string" slot="5" eval="7">
         <choose line="1641">
          <fn name="exists">
           <varRef name="instanceField" slot="4"/>
          </fn>
          <cvUntyped line="1642" to="xs:string">
           <cast as="xs:untypedAtomic" emptiable="0">
            <fn name="string">
             <convert from="xs:anyAtomicType" to="xs:string">
              <data>
               <varRef name="instanceField" slot="4"/>
              </data>
             </convert>
            </fn>
           </cast>
          </cvUntyped>
          <true/>
          <str val=""/>
         </choose>
         <sequence line="1650">
          <message>
           <sequence role="select">
            <valueOf>
             <str val="[xforms:select] selected value = "/>
            </valueOf>
            <valueOf>
             <varRef name="selectedValue" slot="5"/>
            </valueOf>
           </sequence>
           <str role="terminate" val="no"/>
           <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
          </message>
          <applyT line="1653" bSlot="21">
           <axis role="select" name="child" nodeTest="element(Q{http://www.w3.org/2002/xforms}label)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='label';"/>
          </applyT>
          <let line="1655" var="actions" as="map(*)*" slot="6" eval="3">
           <treat line="1656" as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="3|0|XTTE0570|actions">
            <applyT bSlot="22">
             <axis role="select" name="child" nodeTest="((((((((((((((((element(Q{http://www.w3.org/2002/xforms}action) | element(Q{http://www.w3.org/2002/xforms}setvalue)) | element(Q{http://www.w3.org/2002/xforms}insert)) | element(Q{http://www.w3.org/2002/xforms}delete)) | element(Q{http://www.w3.org/2002/xforms}toggle)) | element(Q{http://www.w3.org/2002/xforms}send)) | element(Q{http://www.w3.org/2002/xforms}setfocus)) | element(Q{http://www.w3.org/2002/xforms}setindex)) | element(Q{http://www.w3.org/2002/xforms}load)) | element(Q{http://www.w3.org/2002/xforms}message)) | element(Q{http://www.w3.org/2002/xforms}dispatch)) | element(Q{http://www.w3.org/2002/xforms}rebuild)) | element(Q{http://www.w3.org/2002/xforms}reset)) | element(Q{http://www.w3.org/2002/xforms}show)) | element(Q{http://www.w3.org/2002/xforms}hide)) | element(Q{http://www.w3.org/2002/xforms}script)) | element(Q{http://www.w3.org/2002/xforms}unload))" jsTest="function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='action';};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='setvalue';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='insert';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='delete';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='toggle';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='send';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='setfocus';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='setindex';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='load';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='message';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='dispatch';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='rebuild';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='reset';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='show';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='hide';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='script';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='unload';};return a()||b();"/>
             <withParam name="Q{}nodeset" as="xs:string">
              <varRef line="1658" name="refi" slot="3"/>
             </withParam>
            </applyT>
           </treat>
           <let line="1669" var="myid" as="item()?" slot="7" eval="7">
            <choose>
             <fn name="exists">
              <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
             </fn>
             <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
             <true/>
             <fn name="concat">
              <fn name="generate-id">
               <dot type="element()"/>
              </fn>
              <atomSing card="?" diag="0|1||fn:concat">
               <varRef name="position" slot="1"/>
              </atomSing>
             </fn>
            </choose>
            <sequence line="1672">
             <choose>
              <fn name="exists">
               <varRef name="actions" slot="6"/>
              </fn>
              <ifCall line="1681" name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
               <check card="1" diag="0|0||ixsl:call">
                <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
               </check>
               <str val="addAction"/>
               <arrayBlock>
                <varRef name="myid" slot="7"/>
                <varRef name="actions" slot="6"/>
               </arrayBlock>
              </ifCall>
             </choose>
             <elem line="1687" name="span" nsuri="" namespaces="rdf xhtml js in fn map array ev">
              <sequence>
               <att name="style" flags="l">
                <str val="display:inline"/>
               </att>
               <elem line="1689" name="select" nsuri="" flags="l" namespaces="rdf xhtml js in fn map array ev">
                <sequence>
                 <copyOf flags="vc">
                  <filter flags="b">
                   <axis name="attribute" nodeTest="attribute()" jsTest="return SaxonJS.U.isAttr(item)"/>
                   <vc op="ne" comp="CCC">
                    <fn name="local-name">
                     <dot type="attribute()"/>
                    </fn>
                    <str val="ref"/>
                   </vc>
                  </filter>
                 </copyOf>
                 <choose line="1690">
                  <fn name="exists">
                   <varRef name="refi" slot="3"/>
                  </fn>
                  <att line="1691" name="data-ref" flags="l">
                   <varRef name="refi" slot="3"/>
                  </att>
                 </choose>
                 <att line="1702" name="data-element" flags="l">
                  <lastOf line="1685">
                   <fn name="tokenize">
                    <varRef name="refi" slot="3"/>
                    <str val="/"/>
                    <str val=""/>
                   </fn>
                  </lastOf>
                 </att>
                 <choose line="1703">
                  <and op="and">
                   <fn name="exists">
                    <varRef name="bindingi" slot="2"/>
                   </fn>
                   <fn name="exists">
                    <slash simple="1">
                     <varRef name="bindingi" slot="2"/>
                     <axis name="attribute" nodeTest="attribute(Q{}constraint)" jsTest="return item.name==='constraint'"/>
                    </slash>
                   </fn>
                  </and>
                  <att line="1704" name="data-constraint" flags="l">
                   <convert from="xs:untypedAtomic" to="xs:string">
                    <data>
                     <slash simple="1">
                      <varRef name="bindingi" slot="2"/>
                      <axis name="attribute" nodeTest="attribute(Q{}constraint)" jsTest="return item.name==='constraint'"/>
                     </slash>
                    </data>
                   </convert>
                  </att>
                 </choose>
                 <choose line="1706">
                  <vc op="eq" onEmpty="0" comp="CCC">
                   <fn name="local-name">
                    <dot type="element()"/>
                   </fn>
                   <str val="select"/>
                  </vc>
                  <sequence line="1709">
                   <att name="multiple" flags="l">
                    <str val="true"/>
                   </att>
                   <att name="size" flags="l">
                    <convert from="xs:integer" to="xs:string">
                     <fn name="count">
                      <axis name="descendant" nodeTest="element(Q{http://www.w3.org/2002/xforms}item)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='item';"/>
                     </fn>
                    </convert>
                   </att>
                  </sequence>
                 </choose>
                 <choose line="1712">
                  <fn name="exists">
                   <varRef name="actions" slot="6"/>
                  </fn>
                  <att line="1713" name="data-action" flags="l">
                   <fn name="string-join">
                    <convert from="xs:anyAtomicType" to="xs:string">
                     <data>
                      <varRef name="myid" slot="7"/>
                     </data>
                    </convert>
                    <str val=" "/>
                   </fn>
                  </att>
                 </choose>
                 <applyT line="1718" bSlot="23">
                  <axis role="select" name="child" nodeTest="element(Q{http://www.w3.org/2002/xforms}item)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='item';"/>
                  <withParam name="Q{}selectedValue" as="xs:string">
                   <varRef line="1723" name="selectedValue" slot="5"/>
                  </withParam>
                 </applyT>
                </sequence>
               </elem>
              </sequence>
             </elem>
            </sequence>
           </let>
          </let>
         </sequence>
        </let>
       </let>
      </let>
     </let>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="18" rank="1" minImp="0" slots="9" flags="s" line="2497" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}setvalue)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='setvalue';"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2498">
     <param name="Q{}instance1" slot="0" flags="t" as="node()?">
      <empty role="select"/>
      <treat role="conversion" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="8|0|XTTE0590|instance1">
       <check card="?" diag="8|0|XTTE0590|instance1">
        <supplied slot="0"/>
       </check>
      </treat>
     </param>
     <param line="2499" name="Q{}bindings" slot="1" flags="t" as="map(xs:string, node())">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, node())" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.isNode(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|bindings">
       <check card="1" diag="8|0|XTTE0590|bindings">
        <supplied slot="1"/>
       </check>
      </treat>
     </param>
     <param line="2500" name="Q{}submissions" slot="2" flags="t" as="map(xs:string, xs:string)">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, xs:string)" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.Atomic.string.matches(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|submissions">
       <check card="1" diag="8|0|XTTE0590|submissions">
        <supplied slot="2"/>
       </check>
      </treat>
     </param>
     <param line="2501" name="Q{}position" slot="3">
      <str role="select" val=""/>
      <supplied role="conversion" slot="3"/>
     </param>
     <param line="2502" name="Q{}nodeset" slot="4">
      <str role="select" val=""/>
      <supplied role="conversion" slot="4"/>
     </param>
     <param line="2503" name="Q{}updateMode" slot="5" flags="t">
      <false role="select"/>
      <supplied role="conversion" slot="5"/>
     </param>
     <param line="2509" name="Q{}myid" slot="6" flags="t">
      <choose role="select">
       <fn name="exists">
        <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       </fn>
       <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       <true/>
       <fn name="concat">
        <fn name="generate-id">
         <dot type="element()"/>
        </fn>
        <atomSing card="?" diag="0|1||fn:concat">
         <varRef name="position" slot="3"/>
        </atomSing>
       </fn>
      </choose>
      <supplied role="conversion" slot="6"/>
     </param>
     <let line="2512" var="nodeseti" as="item()*" slot="7" eval="3">
      <choose>
       <gc op="=" card="N:1" comp="GAC|http://www.w3.org/2005/xpath-functions/collation/codepoint">
        <data>
         <varRef name="nodeset" slot="4"/>
        </data>
        <str val=""/>
       </gc>
       <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
       <true/>
       <varRef name="nodeset" slot="4"/>
      </choose>
      <choose line="2514">
       <fn name="not">
        <varRef name="updateMode" slot="5"/>
       </fn>
       <sequence line="2516">
        <message>
         <sequence role="select">
          <valueOf>
           <str val="xforms:setvalue found !!!! XXX, node&#xA;                        "/>
          </valueOf>
          <valueOf line="2517">
           <fn name="serialize">
            <dot type="element()"/>
           </fn>
          </valueOf>
          <valueOf>
           <str val=", id= "/>
          </valueOf>
          <valueOf line="2517">
           <convert from="xs:untypedAtomic" to="xs:string">
            <attVal name="Q{}id" chk="0"/>
           </convert>
          </valueOf>
          <valueOf>
           <str val=",&#xA;                    myid = "/>
          </valueOf>
          <valueOf line="2518">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="myid" slot="6"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
          <valueOf>
           <str val=", nodeset="/>
          </valueOf>
          <valueOf line="2519">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="nodeseti" slot="7"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
         </sequence>
         <str role="terminate" val="no"/>
         <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
        </message>
        <let line="2522" var="action-map" as="map(xs:anyAtomicType, item()*)" slot="8" eval="8">
         <ifCall line="2526" name="Q{http://www.w3.org/2005/xpath-functions/map}merge" type="map(*)">
          <sequence>
           <choose>
            <fn name="exists">
             <varRef name="nodeset" slot="4"/>
            </fn>
            <ifCall line="2527" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@ref"/>
             <cast as="xs:string" emptiable="1">
              <atomSing card="?" diag="2|0||cast as">
               <varRef name="nodeset" slot="4"/>
              </atomSing>
             </cast>
            </ifCall>
           </choose>
           <choose line="2530">
            <fn name="exists">
             <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
            </fn>
            <ifCall line="2531" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@event"/>
             <cast as="xs:string" emptiable="1">
              <atomSing card="?" diag="2|0||cast as">
               <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
              </atomSing>
             </cast>
            </ifCall>
           </choose>
           <choose line="2534">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
            </fn>
            <ifCall line="2535" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@position"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2537">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
            </fn>
            <ifCall line="2538" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@at"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2540">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
            </fn>
            <ifCall line="2541" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@if"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2543">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
            </fn>
            <ifCall line="2544" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@while"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
             </fn>
            </ifCall>
           </choose>
           <treat line="2547" as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="18|0|XTTE3375|">
            <forEachGroup algorithm="by">
             <dot role="select" type="element()"/>
             <fn role="key" name="local-name">
              <dot type="element()"/>
             </fn>
             <str role="collation" val="http://www.w3.org/2005/xpath-functions/collation/codepoint"/>
             <applyT role="content" line="2548" mode="Q{}xforms-action-map" bSlot="1">
              <dot role="select" type="element()"/>
              <withParam name="Q{}nodeset">
               <varRef line="2549" name="nodeset" slot="4"/>
              </withParam>
             </applyT>
            </forEachGroup>
           </treat>
          </sequence>
          <map size="2">
           <str val="duplicates"/>
           <str val="reject"/>
           <str val="duplicates-error-code"/>
           <str val="XTDE3365"/>
          </map>
         </ifCall>
         <sequence line="2562">
          <message>
           <sequence role="select">
            <valueOf>
             <str val="xforms:setvalue found !!!! XXX, node&#xA;                    "/>
            </valueOf>
            <valueOf line="2563">
             <fn name="serialize">
              <dot type="element()"/>
             </fn>
            </valueOf>
            <valueOf>
             <str val=", id= "/>
            </valueOf>
            <valueOf line="2563">
             <convert from="xs:untypedAtomic" to="xs:string">
              <attVal name="Q{}id" chk="0"/>
             </convert>
            </valueOf>
            <valueOf>
             <str val=",&#xA;                    myid = "/>
            </valueOf>
            <valueOf line="2564">
             <fn name="string-join">
              <convert from="xs:anyAtomicType" to="xs:string">
               <data>
                <mergeAdj>
                 <varRef name="myid" slot="6"/>
                </mergeAdj>
               </data>
              </convert>
              <str val=" "/>
             </fn>
            </valueOf>
            <valueOf>
             <str val=", nodeset="/>
            </valueOf>
            <valueOf line="2565">
             <fn name="string-join">
              <convert from="xs:anyAtomicType" to="xs:string">
               <data>
                <mergeAdj>
                 <varRef name="nodeseti" slot="7"/>
                </mergeAdj>
               </data>
              </convert>
              <str val=" "/>
             </fn>
            </valueOf>
            <valueOf>
             <str val="&#xA;                    action xml "/>
            </valueOf>
            <valueOf line="2566">
             <fn name="serialize">
              <varRef name="action-map" slot="8"/>
              <map size="1">
               <str val="method"/>
               <str val="json"/>
              </map>
             </fn>
            </valueOf>
           </sequence>
           <str role="terminate" val="no"/>
           <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
          </message>
          <varRef line="2590" name="action-map" slot="8"/>
         </sequence>
        </let>
       </sequence>
      </choose>
     </let>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="18" rank="1" minImp="0" slots="9" flags="s" line="2497" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}hide)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='hide';"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2498">
     <param name="Q{}instance1" slot="0" flags="t" as="node()?">
      <empty role="select"/>
      <treat role="conversion" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="8|0|XTTE0590|instance1">
       <check card="?" diag="8|0|XTTE0590|instance1">
        <supplied slot="0"/>
       </check>
      </treat>
     </param>
     <param line="2499" name="Q{}bindings" slot="1" flags="t" as="map(xs:string, node())">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, node())" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.isNode(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|bindings">
       <check card="1" diag="8|0|XTTE0590|bindings">
        <supplied slot="1"/>
       </check>
      </treat>
     </param>
     <param line="2500" name="Q{}submissions" slot="2" flags="t" as="map(xs:string, xs:string)">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, xs:string)" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.Atomic.string.matches(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|submissions">
       <check card="1" diag="8|0|XTTE0590|submissions">
        <supplied slot="2"/>
       </check>
      </treat>
     </param>
     <param line="2501" name="Q{}position" slot="3">
      <str role="select" val=""/>
      <supplied role="conversion" slot="3"/>
     </param>
     <param line="2502" name="Q{}nodeset" slot="4">
      <str role="select" val=""/>
      <supplied role="conversion" slot="4"/>
     </param>
     <param line="2503" name="Q{}updateMode" slot="5" flags="t">
      <false role="select"/>
      <supplied role="conversion" slot="5"/>
     </param>
     <param line="2509" name="Q{}myid" slot="6" flags="t">
      <choose role="select">
       <fn name="exists">
        <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       </fn>
       <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       <true/>
       <fn name="concat">
        <fn name="generate-id">
         <dot type="element()"/>
        </fn>
        <atomSing card="?" diag="0|1||fn:concat">
         <varRef name="position" slot="3"/>
        </atomSing>
       </fn>
      </choose>
      <supplied role="conversion" slot="6"/>
     </param>
     <let line="2512" var="nodeseti" as="item()*" slot="7" eval="3">
      <choose>
       <gc op="=" card="N:1" comp="GAC|http://www.w3.org/2005/xpath-functions/collation/codepoint">
        <data>
         <varRef name="nodeset" slot="4"/>
        </data>
        <str val=""/>
       </gc>
       <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
       <true/>
       <varRef name="nodeset" slot="4"/>
      </choose>
      <choose line="2514">
       <fn name="not">
        <varRef name="updateMode" slot="5"/>
       </fn>
       <sequence line="2516">
        <message>
         <sequence role="select">
          <valueOf>
           <str val="xforms:setvalue found !!!! XXX, node&#xA;                        "/>
          </valueOf>
          <valueOf line="2517">
           <fn name="serialize">
            <dot type="element()"/>
           </fn>
          </valueOf>
          <valueOf>
           <str val=", id= "/>
          </valueOf>
          <valueOf line="2517">
           <convert from="xs:untypedAtomic" to="xs:string">
            <attVal name="Q{}id" chk="0"/>
           </convert>
          </valueOf>
          <valueOf>
           <str val=",&#xA;                    myid = "/>
          </valueOf>
          <valueOf line="2518">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="myid" slot="6"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
          <valueOf>
           <str val=", nodeset="/>
          </valueOf>
          <valueOf line="2519">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="nodeseti" slot="7"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
         </sequence>
         <str role="terminate" val="no"/>
         <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
        </message>
        <let line="2522" var="action-map" as="map(xs:anyAtomicType, item()*)" slot="8" eval="8">
         <ifCall line="2526" name="Q{http://www.w3.org/2005/xpath-functions/map}merge" type="map(*)">
          <sequence>
           <choose>
            <fn name="exists">
             <varRef name="nodeset" slot="4"/>
            </fn>
            <ifCall line="2527" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@ref"/>
             <cast as="xs:string" emptiable="1">
              <atomSing card="?" diag="2|0||cast as">
               <varRef name="nodeset" slot="4"/>
              </atomSing>
             </cast>
            </ifCall>
           </choose>
           <choose line="2530">
            <fn name="exists">
             <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
            </fn>
            <ifCall line="2531" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@event"/>
             <cast as="xs:string" emptiable="1">
              <atomSing card="?" diag="2|0||cast as">
               <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
              </atomSing>
             </cast>
            </ifCall>
           </choose>
           <choose line="2534">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
            </fn>
            <ifCall line="2535" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@position"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2537">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
            </fn>
            <ifCall line="2538" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@at"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2540">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
            </fn>
            <ifCall line="2541" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@if"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2543">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
            </fn>
            <ifCall line="2544" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@while"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
             </fn>
            </ifCall>
           </choose>
           <treat line="2547" as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="18|0|XTTE3375|">
            <forEachGroup algorithm="by">
             <dot role="select" type="element()"/>
             <fn role="key" name="local-name">
              <dot type="element()"/>
             </fn>
             <str role="collation" val="http://www.w3.org/2005/xpath-functions/collation/codepoint"/>
             <applyT role="content" line="2548" mode="Q{}xforms-action-map" bSlot="1">
              <dot role="select" type="element()"/>
              <withParam name="Q{}nodeset">
               <varRef line="2549" name="nodeset" slot="4"/>
              </withParam>
             </applyT>
            </forEachGroup>
           </treat>
          </sequence>
          <map size="2">
           <str val="duplicates"/>
           <str val="reject"/>
           <str val="duplicates-error-code"/>
           <str val="XTDE3365"/>
          </map>
         </ifCall>
         <sequence line="2562">
          <message>
           <sequence role="select">
            <valueOf>
             <str val="xforms:setvalue found !!!! XXX, node&#xA;                    "/>
            </valueOf>
            <valueOf line="2563">
             <fn name="serialize">
              <dot type="element()"/>
             </fn>
            </valueOf>
            <valueOf>
             <str val=", id= "/>
            </valueOf>
            <valueOf line="2563">
             <convert from="xs:untypedAtomic" to="xs:string">
              <attVal name="Q{}id" chk="0"/>
             </convert>
            </valueOf>
            <valueOf>
             <str val=",&#xA;                    myid = "/>
            </valueOf>
            <valueOf line="2564">
             <fn name="string-join">
              <convert from="xs:anyAtomicType" to="xs:string">
               <data>
                <mergeAdj>
                 <varRef name="myid" slot="6"/>
                </mergeAdj>
               </data>
              </convert>
              <str val=" "/>
             </fn>
            </valueOf>
            <valueOf>
             <str val=", nodeset="/>
            </valueOf>
            <valueOf line="2565">
             <fn name="string-join">
              <convert from="xs:anyAtomicType" to="xs:string">
               <data>
                <mergeAdj>
                 <varRef name="nodeseti" slot="7"/>
                </mergeAdj>
               </data>
              </convert>
              <str val=" "/>
             </fn>
            </valueOf>
            <valueOf>
             <str val="&#xA;                    action xml "/>
            </valueOf>
            <valueOf line="2566">
             <fn name="serialize">
              <varRef name="action-map" slot="8"/>
              <map size="1">
               <str val="method"/>
               <str val="json"/>
              </map>
             </fn>
            </valueOf>
           </sequence>
           <str role="terminate" val="no"/>
           <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
          </message>
          <varRef line="2590" name="action-map" slot="8"/>
         </sequence>
        </let>
       </sequence>
      </choose>
     </let>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="4" rank="1" minImp="0" slots="10" flags="s" line="1179" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}output)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='output';"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="1180">
     <param name="Q{}instance1" slot="0" flags="t" as="node()?">
      <empty role="select"/>
      <treat role="conversion" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="8|0|XTTE0590|instance1">
       <check card="?" diag="8|0|XTTE0590|instance1">
        <supplied slot="0"/>
       </check>
      </treat>
     </param>
     <param line="1181" name="Q{}bindings" slot="1" flags="t" as="map(xs:string, node())">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, node())" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.isNode(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|bindings">
       <check card="1" diag="8|0|XTTE0590|bindings">
        <supplied slot="1"/>
       </check>
      </treat>
     </param>
     <param line="1183" name="Q{}nodeset" slot="2" as="xs:string">
      <str role="select" val=""/>
      <treat role="conversion" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="8|0|XTTE0590|nodeset">
       <check card="1" diag="8|0|XTTE0590|nodeset">
        <cvUntyped to="xs:string">
         <data>
          <supplied slot="2"/>
         </data>
        </cvUntyped>
       </check>
      </treat>
     </param>
     <param line="1184" name="Q{}position" slot="3">
      <str role="select" val=""/>
      <supplied role="conversion" slot="3"/>
     </param>
     <message line="1186">
      <sequence role="select">
       <valueOf flags="S">
        <str val="xforms:output="/>
       </valueOf>
       <valueOf>
        <fn name="serialize">
         <varRef name="instance1" slot="0"/>
        </fn>
       </valueOf>
       <valueOf>
        <str val=" ref= "/>
       </valueOf>
       <valueOf line="1187">
        <convert from="xs:untypedAtomic" to="xs:string">
         <attVal name="Q{}ref" chk="0"/>
        </convert>
       </valueOf>
       <valueOf>
        <str val=", "/>
       </valueOf>
       <valueOf line="1187">
        <fn name="serialize">
         <dot type="element(Q{http://www.w3.org/2002/xforms}output)"/>
        </fn>
       </valueOf>
       <valueOf>
        <str val=" nodeset = "/>
       </valueOf>
       <valueOf line="1188">
        <varRef name="nodeset" slot="2"/>
       </valueOf>
      </sequence>
      <str role="terminate" val="no"/>
      <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
     </message>
     <let line="1191" var="ref-binding" as="xs:string" slot="4" eval="7">
      <choose line="1193">
       <fn name="exists">
        <axis name="attribute" nodeTest="attribute(Q{}ref)" jsTest="return item.name==='ref'"/>
       </fn>
       <cvUntyped line="1194" to="xs:string">
        <cast as="xs:untypedAtomic" emptiable="0">
         <fn name="string">
          <convert from="xs:untypedAtomic" to="xs:string">
           <attVal name="Q{}ref" chk="0"/>
          </convert>
         </fn>
        </cast>
       </cvUntyped>
       <fn line="1196" name="exists">
        <axis name="attribute" nodeTest="attribute(Q{}bind)" jsTest="return item.name==='bind'"/>
       </fn>
       <cvUntyped line="1197" to="xs:string">
        <cast as="xs:untypedAtomic" emptiable="0">
         <fn name="string">
          <convert from="xs:untypedAtomic" to="xs:string">
           <attVal name="Q{}bind" chk="0"/>
          </convert>
         </fn>
        </cast>
       </cvUntyped>
       <true/>
       <str val=""/>
      </choose>
      <let line="1212" var="bindingi" as="node()?" slot="5" eval="7">
       <choose>
        <fn name="empty">
         <varRef name="ref-binding" slot="4"/>
        </fn>
        <empty/>
        <true/>
        <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
         <varRef name="bindings" slot="1"/>
         <varRef name="ref-binding" slot="4"/>
        </ifCall>
       </choose>
       <let line="1213" var="refi" as="xs:string" slot="6" eval="7">
        <choose line="1215">
         <fn name="exists">
          <axis name="attribute" nodeTest="attribute(Q{}ref)" jsTest="return item.name==='ref'"/>
         </fn>
         <cvUntyped line="1222" to="xs:string">
          <cast as="xs:untypedAtomic" emptiable="0">
           <choose>
            <fn name="not">
             <varRef name="nodeset" slot="2"/>
            </fn>
            <fn name="concat">
             <varRef name="nodeset" slot="2"/>
             <attVal name="Q{}ref" chk="0"/>
            </fn>
            <true/>
            <fn name="concat">
             <varRef name="nodeset" slot="2"/>
             <str val="/"/>
             <attVal name="Q{}ref" chk="0"/>
            </fn>
           </choose>
          </cast>
         </cvUntyped>
         <fn line="1224" name="exists">
          <varRef name="bindingi" slot="5"/>
         </fn>
         <cvUntyped line="1231" to="xs:string">
          <cast as="xs:untypedAtomic" emptiable="0">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <choose>
              <fn name="exists">
               <slash simple="1">
                <varRef name="bindingi" slot="5"/>
                <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
               </slash>
              </fn>
              <data>
               <slash simple="1">
                <varRef name="bindingi" slot="5"/>
                <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
               </slash>
              </data>
              <true/>
              <data>
               <slash simple="1">
                <varRef name="bindingi" slot="5"/>
                <axis name="attribute" nodeTest="attribute(Q{}ref)" jsTest="return item.name==='ref'"/>
               </slash>
              </data>
             </choose>
            </convert>
            <str val=" "/>
           </fn>
          </cast>
         </cvUntyped>
         <true/>
         <str val=""/>
        </choose>
        <let line="1240" var="instanceForBinding" as="node()?" slot="7" eval="7">
         <choose line="1242">
          <and op="and">
           <fn name="exists">
            <varRef name="bindingi" slot="5"/>
           </fn>
           <fn name="exists">
            <slash simple="1">
             <varRef name="bindingi" slot="5"/>
             <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
            </slash>
           </fn>
          </and>
          <check line="1243" card="?" diag="3|0|XTTE0570|instanceForBinding">
           <sequence>
            <treat as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="3|0|XTTE0570|instanceForBinding">
             <message>
              <sequence role="select">
               <valueOf>
                <str val="&#xA;                        Instance= "/>
               </valueOf>
               <valueOf line="1244">
                <fn name="serialize">
                 <varRef name="instance1" slot="0"/>
                </fn>
               </valueOf>
               <valueOf>
                <str val="&#xA;                        instanceForBinding found binding/@nodeset "/>
               </valueOf>
               <valueOf line="1245">
                <convert from="xs:untypedAtomic" to="xs:string">
                 <data>
                  <slash simple="1">
                   <varRef name="bindingi" slot="5"/>
                   <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
                  </slash>
                 </data>
                </convert>
               </valueOf>
              </sequence>
              <str role="terminate" val="no"/>
              <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
             </message>
            </treat>
            <treat line="1246" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="3|0|XTTE0570|instanceForBinding">
             <evaluate dxns="">
              <check role="xpath" card="1" diag="4|0||xsl:evaluate/xpath">
               <cvUntyped to="xs:string">
                <data>
                 <slash simple="1">
                  <varRef name="bindingi" slot="5"/>
                  <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
                 </slash>
                </data>
               </cvUntyped>
              </check>
              <varRef role="cxt" name="instance1" slot="0"/>
              <str role="sa" val="no"/>
              <map role="wp" size="0"/>
             </evaluate>
            </treat>
           </sequence>
          </check>
          <true/>
          <varRef line="1249" name="instance1" slot="0"/>
         </choose>
         <let line="1254" var="valueExecuted" as="xs:string" slot="8" eval="8">
          <evaluate line="1255" as="xs:string" dxns="">
           <check role="xpath" card="1" diag="4|0||xsl:evaluate/xpath">
            <cvUntyped to="xs:string">
             <attVal name="Q{}value" chk="0"/>
            </cvUntyped>
           </check>
           <varRef role="cxt" name="instance1" slot="0"/>
           <str role="sa" val="no"/>
           <map role="wp" size="0"/>
          </evaluate>
          <let line="1258" var="relevantVar" as="xs:boolean" slot="9" eval="7">
           <choose line="1260">
            <and op="and">
             <and op="and">
              <fn name="exists">
               <varRef name="bindingi" slot="5"/>
              </fn>
              <fn name="exists">
               <slash simple="1">
                <varRef name="bindingi" slot="5"/>
                <axis name="attribute" nodeTest="attribute(Q{}relevant)" jsTest="return item.name==='relevant'"/>
               </slash>
              </fn>
             </and>
             <fn name="exists">
              <varRef name="instanceForBinding" slot="7"/>
             </fn>
            </and>
            <treat line="1261" as="xs:boolean" jsTest="return SaxonJS.U.Atomic.boolean.matches(item);" diag="3|0|XTTE0570|relevantVar">
             <check card="1" diag="3|0|XTTE0570|relevantVar">
              <cvUntyped to="xs:boolean">
               <data>
                <evaluate dxns="">
                 <ufCall role="xpath" name="Q{http://www.w3.org/2002/xforms}impose" tailCall="false" bSlot="24" eval="4">
                  <check card="1" diag="0|0||xforms:impose">
                   <cvUntyped to="xs:string">
                    <data>
                     <slash simple="1">
                      <varRef name="bindingi" slot="5"/>
                      <axis name="attribute" nodeTest="attribute(Q{}relevant)" jsTest="return item.name==='relevant'"/>
                     </slash>
                    </data>
                   </cvUntyped>
                  </check>
                 </ufCall>
                 <varRef role="cxt" name="instanceForBinding" slot="7"/>
                 <str role="sa" val="no"/>
                 <map role="wp" size="0"/>
                </evaluate>
               </data>
              </cvUntyped>
             </check>
            </treat>
            <true/>
            <true/>
           </choose>
           <sequence line="1269">
            <applyT bSlot="25">
             <axis role="select" name="child" nodeTest="(element(Q{http://www.w3.org/2002/xforms}label) | element(Q{http://www.w3.org/2002/xforms}hint))" jsTest="function a() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='label';};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='hint';};return a()||b();"/>
             <withParam name="Q{}instance1" as="node()?">
              <varRef line="1270" name="instance1" slot="0"/>
             </withParam>
             <withParam name="Q{}nodeset" as="xs:string">
              <varRef line="1271" name="refi" slot="6"/>
             </withParam>
             <withParam name="Q{}bindings" as="map(xs:string, node())">
              <varRef line="1272" name="bindings" slot="1"/>
             </withParam>
             <withParam name="Q{}position">
              <varRef line="1273" name="position" slot="3"/>
             </withParam>
            </applyT>
            <elem line="1276" name="span" nsuri="" namespaces="rdf xhtml js in fn map array ev">
             <sequence>
              <att name="style" flags="l">
               <choose>
                <varRef name="relevantVar" slot="9"/>
                <str val="display:inline"/>
                <true/>
                <str val="display:none"/>
               </choose>
              </att>
              <att line="1277" name="data-ref" flags="l">
               <varRef name="refi" slot="6"/>
              </att>
              <choose line="1279">
               <fn name="exists">
                <axis name="attribute" nodeTest="attribute(Q{}class)" jsTest="return item.name==='class'"/>
               </fn>
               <att line="1280" name="class" flags="l">
                <convert from="xs:untypedAtomic" to="xs:string">
                 <attVal name="Q{}class" chk="0"/>
                </convert>
               </att>
              </choose>
              <varRef line="1284" name="valueExecuted" slot="8"/>
             </sequence>
            </elem>
           </sequence>
          </let>
         </let>
        </let>
       </let>
      </let>
     </let>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="18" rank="1" minImp="0" slots="9" flags="s" line="2497" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}setfocus)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='setfocus';"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2498">
     <param name="Q{}instance1" slot="0" flags="t" as="node()?">
      <empty role="select"/>
      <treat role="conversion" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="8|0|XTTE0590|instance1">
       <check card="?" diag="8|0|XTTE0590|instance1">
        <supplied slot="0"/>
       </check>
      </treat>
     </param>
     <param line="2499" name="Q{}bindings" slot="1" flags="t" as="map(xs:string, node())">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, node())" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.isNode(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|bindings">
       <check card="1" diag="8|0|XTTE0590|bindings">
        <supplied slot="1"/>
       </check>
      </treat>
     </param>
     <param line="2500" name="Q{}submissions" slot="2" flags="t" as="map(xs:string, xs:string)">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, xs:string)" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.Atomic.string.matches(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|submissions">
       <check card="1" diag="8|0|XTTE0590|submissions">
        <supplied slot="2"/>
       </check>
      </treat>
     </param>
     <param line="2501" name="Q{}position" slot="3">
      <str role="select" val=""/>
      <supplied role="conversion" slot="3"/>
     </param>
     <param line="2502" name="Q{}nodeset" slot="4">
      <str role="select" val=""/>
      <supplied role="conversion" slot="4"/>
     </param>
     <param line="2503" name="Q{}updateMode" slot="5" flags="t">
      <false role="select"/>
      <supplied role="conversion" slot="5"/>
     </param>
     <param line="2509" name="Q{}myid" slot="6" flags="t">
      <choose role="select">
       <fn name="exists">
        <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       </fn>
       <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       <true/>
       <fn name="concat">
        <fn name="generate-id">
         <dot type="element()"/>
        </fn>
        <atomSing card="?" diag="0|1||fn:concat">
         <varRef name="position" slot="3"/>
        </atomSing>
       </fn>
      </choose>
      <supplied role="conversion" slot="6"/>
     </param>
     <let line="2512" var="nodeseti" as="item()*" slot="7" eval="3">
      <choose>
       <gc op="=" card="N:1" comp="GAC|http://www.w3.org/2005/xpath-functions/collation/codepoint">
        <data>
         <varRef name="nodeset" slot="4"/>
        </data>
        <str val=""/>
       </gc>
       <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
       <true/>
       <varRef name="nodeset" slot="4"/>
      </choose>
      <choose line="2514">
       <fn name="not">
        <varRef name="updateMode" slot="5"/>
       </fn>
       <sequence line="2516">
        <message>
         <sequence role="select">
          <valueOf>
           <str val="xforms:setvalue found !!!! XXX, node&#xA;                        "/>
          </valueOf>
          <valueOf line="2517">
           <fn name="serialize">
            <dot type="element()"/>
           </fn>
          </valueOf>
          <valueOf>
           <str val=", id= "/>
          </valueOf>
          <valueOf line="2517">
           <convert from="xs:untypedAtomic" to="xs:string">
            <attVal name="Q{}id" chk="0"/>
           </convert>
          </valueOf>
          <valueOf>
           <str val=",&#xA;                    myid = "/>
          </valueOf>
          <valueOf line="2518">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="myid" slot="6"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
          <valueOf>
           <str val=", nodeset="/>
          </valueOf>
          <valueOf line="2519">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="nodeseti" slot="7"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
         </sequence>
         <str role="terminate" val="no"/>
         <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
        </message>
        <let line="2522" var="action-map" as="map(xs:anyAtomicType, item()*)" slot="8" eval="8">
         <ifCall line="2526" name="Q{http://www.w3.org/2005/xpath-functions/map}merge" type="map(*)">
          <sequence>
           <choose>
            <fn name="exists">
             <varRef name="nodeset" slot="4"/>
            </fn>
            <ifCall line="2527" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@ref"/>
             <cast as="xs:string" emptiable="1">
              <atomSing card="?" diag="2|0||cast as">
               <varRef name="nodeset" slot="4"/>
              </atomSing>
             </cast>
            </ifCall>
           </choose>
           <choose line="2530">
            <fn name="exists">
             <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
            </fn>
            <ifCall line="2531" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@event"/>
             <cast as="xs:string" emptiable="1">
              <atomSing card="?" diag="2|0||cast as">
               <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
              </atomSing>
             </cast>
            </ifCall>
           </choose>
           <choose line="2534">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
            </fn>
            <ifCall line="2535" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@position"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2537">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
            </fn>
            <ifCall line="2538" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@at"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2540">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
            </fn>
            <ifCall line="2541" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@if"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2543">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
            </fn>
            <ifCall line="2544" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@while"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
             </fn>
            </ifCall>
           </choose>
           <treat line="2547" as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="18|0|XTTE3375|">
            <forEachGroup algorithm="by">
             <dot role="select" type="element()"/>
             <fn role="key" name="local-name">
              <dot type="element()"/>
             </fn>
             <str role="collation" val="http://www.w3.org/2005/xpath-functions/collation/codepoint"/>
             <applyT role="content" line="2548" mode="Q{}xforms-action-map" bSlot="1">
              <dot role="select" type="element()"/>
              <withParam name="Q{}nodeset">
               <varRef line="2549" name="nodeset" slot="4"/>
              </withParam>
             </applyT>
            </forEachGroup>
           </treat>
          </sequence>
          <map size="2">
           <str val="duplicates"/>
           <str val="reject"/>
           <str val="duplicates-error-code"/>
           <str val="XTDE3365"/>
          </map>
         </ifCall>
         <sequence line="2562">
          <message>
           <sequence role="select">
            <valueOf>
             <str val="xforms:setvalue found !!!! XXX, node&#xA;                    "/>
            </valueOf>
            <valueOf line="2563">
             <fn name="serialize">
              <dot type="element()"/>
             </fn>
            </valueOf>
            <valueOf>
             <str val=", id= "/>
            </valueOf>
            <valueOf line="2563">
             <convert from="xs:untypedAtomic" to="xs:string">
              <attVal name="Q{}id" chk="0"/>
             </convert>
            </valueOf>
            <valueOf>
             <str val=",&#xA;                    myid = "/>
            </valueOf>
            <valueOf line="2564">
             <fn name="string-join">
              <convert from="xs:anyAtomicType" to="xs:string">
               <data>
                <mergeAdj>
                 <varRef name="myid" slot="6"/>
                </mergeAdj>
               </data>
              </convert>
              <str val=" "/>
             </fn>
            </valueOf>
            <valueOf>
             <str val=", nodeset="/>
            </valueOf>
            <valueOf line="2565">
             <fn name="string-join">
              <convert from="xs:anyAtomicType" to="xs:string">
               <data>
                <mergeAdj>
                 <varRef name="nodeseti" slot="7"/>
                </mergeAdj>
               </data>
              </convert>
              <str val=" "/>
             </fn>
            </valueOf>
            <valueOf>
             <str val="&#xA;                    action xml "/>
            </valueOf>
            <valueOf line="2566">
             <fn name="serialize">
              <varRef name="action-map" slot="8"/>
              <map size="1">
               <str val="method"/>
               <str val="json"/>
              </map>
             </fn>
            </valueOf>
           </sequence>
           <str role="terminate" val="no"/>
           <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
          </message>
          <varRef line="2590" name="action-map" slot="8"/>
         </sequence>
        </let>
       </sequence>
      </choose>
     </let>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="3" rank="1" minImp="0" slots="0" flags="s" line="1155" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{}html)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri===''&amp;&amp;q.local==='html';"/>
    <elem role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="1157" name="html" nsuri="" namespaces="rdf xhtml js in fn map array ev">
     <sequence>
      <copyOf flags="vc">
       <axis name="attribute" nodeTest="attribute()" jsTest="return SaxonJS.U.isAttr(item)"/>
      </copyOf>
      <elem line="1159" name="head" nsuri="" flags="l" namespaces="rdf xhtml js in fn map array ev">
       <sequence>
        <copyOf flags="vc">
         <union op="|">
          <slash>
           <axis name="child" nodeTest="element(Q{http://www.w3.org/1999/xhtml}head)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/1999/xhtml'&amp;&amp;q.local==='head';"/>
           <axis name="attribute" nodeTest="attribute()" jsTest="return SaxonJS.U.isAttr(item)"/>
          </slash>
          <slash>
           <axis name="child" nodeTest="element(Q{}head)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri===''&amp;&amp;q.local==='head';"/>
           <axis name="attribute" nodeTest="attribute()" jsTest="return SaxonJS.U.isAttr(item)"/>
          </slash>
         </union>
        </copyOf>
        <elem line="1160" name="meta" nsuri="" flags="l">
         <sequence>
          <att name="http-equiv" flags="l">
           <str val="Content-Type"/>
          </att>
          <att name="content" flags="l">
           <str val="text/html;charset=utf-8"/>
          </att>
         </sequence>
        </elem>
        <forEach line="1162">
         <union op="|">
          <filter flags="b">
           <slash>
            <axis name="child" nodeTest="element(Q{http://www.w3.org/1999/xhtml}head)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/1999/xhtml'&amp;&amp;q.local==='head';"/>
            <axis name="child" nodeTest="element(Q{http://www.w3.org/1999/xhtml}meta)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/1999/xhtml'&amp;&amp;q.local==='meta';"/>
           </slash>
           <vc op="ne" comp="CCC">
            <fn name="string">
             <axis name="attribute" nodeTest="attribute(Q{}http-equiv)" jsTest="return item.name==='http-equiv'"/>
            </fn>
            <str val="Content-Type"/>
           </vc>
          </filter>
          <filter flags="b">
           <slash>
            <axis name="child" nodeTest="element(Q{}head)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri===''&amp;&amp;q.local==='head';"/>
            <axis name="child" nodeTest="element(Q{}meta)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri===''&amp;&amp;q.local==='meta';"/>
           </slash>
           <vc op="ne" comp="CCC">
            <fn name="string">
             <axis name="attribute" nodeTest="attribute(Q{}http-equiv)" jsTest="return item.name==='http-equiv'"/>
            </fn>
            <str val="Content-Type"/>
           </vc>
          </filter>
         </union>
         <elem line="1164" name="meta" nsuri="" flags="l" namespaces="rdf xhtml js in fn map array ev">
          <copyOf flags="vc">
           <axis name="attribute" nodeTest="attribute()" jsTest="return SaxonJS.U.isAttr(item)"/>
          </copyOf>
         </elem>
        </forEach>
        <copyOf line="1169" flags="vc">
         <axis name="child" nodeTest="element(Q{}script)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri===''&amp;&amp;q.local==='script';"/>
        </copyOf>
       </sequence>
      </elem>
      <elem line="1172" name="body" nsuri="" flags="l" namespaces="rdf xhtml js in fn map array ev">
       <applyT bSlot="17">
        <slash role="select">
         <axis name="child" nodeTest="element(Q{}body)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri===''&amp;&amp;q.local==='body';"/>
         <axis name="child" nodeTest="element()" jsTest="return item.nodeType===1;"/>
        </slash>
       </applyT>
      </elem>
     </sequence>
    </elem>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="16" rank="1" minImp="0" slots="8" flags="s" line="2331" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}trigger)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='trigger';"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2332">
     <param name="Q{}instance1" slot="0" flags="t" as="node()?">
      <empty role="select"/>
      <treat role="conversion" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="8|0|XTTE0590|instance1">
       <check card="?" diag="8|0|XTTE0590|instance1">
        <supplied slot="0"/>
       </check>
      </treat>
     </param>
     <param line="2333" name="Q{}bindings" slot="1" flags="t" as="map(xs:string, node())">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, node())" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.isNode(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|bindings">
       <check card="1" diag="8|0|XTTE0590|bindings">
        <supplied slot="1"/>
       </check>
      </treat>
     </param>
     <param line="2334" name="Q{}submissions" slot="2" flags="t" as="map(xs:string, xs:string)">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, xs:string)" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.Atomic.string.matches(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|submissions">
       <check card="1" diag="8|0|XTTE0590|submissions">
        <supplied slot="2"/>
       </check>
      </treat>
     </param>
     <param line="2335" name="Q{}position" slot="3">
      <str role="select" val=""/>
      <supplied role="conversion" slot="3"/>
     </param>
     <param line="2336" name="Q{}nodeset" slot="4">
      <str role="select" val=""/>
      <supplied role="conversion" slot="4"/>
     </param>
     <let line="2345" var="innerbody" as="document-node()" slot="5" eval="7">
      <doc line="2347" validation="preserve">
       <choose>
        <fn name="exists">
         <filter flags="b">
          <axis name="child" nodeTest="element()" jsTest="return item.nodeType===1;"/>
          <vc op="eq" comp="CCC">
           <fn name="local-name">
            <dot type="element()"/>
           </fn>
           <str val="label"/>
          </vc>
         </filter>
        </fn>
        <applyT line="2349" bSlot="26">
         <axis role="select" name="child" nodeTest="element(Q{http://www.w3.org/2002/xforms}label)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='label';"/>
         <withParam name="Q{}instance1" as="node()?">
          <varRef line="2350" name="instance1" slot="0"/>
         </withParam>
         <withParam name="Q{}bindings" as="map(xs:string, node())">
          <varRef line="2351" name="bindings" slot="1"/>
         </withParam>
        </applyT>
        <true/>
        <valueOf line="2355" flags="l">
         <str val=" "/>
        </valueOf>
       </choose>
      </doc>
      <let line="2363" var="myid" as="item()?" slot="6" eval="7">
       <choose>
        <fn name="exists">
         <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
        </fn>
        <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
        <true/>
        <fn name="concat">
         <fn name="generate-id">
          <dot type="element(Q{http://www.w3.org/2002/xforms}trigger)"/>
         </fn>
         <atomSing card="?" diag="0|1||fn:concat">
          <varRef name="position" slot="3"/>
         </atomSing>
        </fn>
       </choose>
       <let line="2373" var="actions" as="map(*)*" slot="7" eval="3">
        <treat line="2374" as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="3|0|XTTE0570|actions">
         <applyT bSlot="27">
          <axis role="select" name="child" nodeTest="((((((((((((((((element(Q{http://www.w3.org/2002/xforms}action) | element(Q{http://www.w3.org/2002/xforms}setvalue)) | element(Q{http://www.w3.org/2002/xforms}insert)) | element(Q{http://www.w3.org/2002/xforms}delete)) | element(Q{http://www.w3.org/2002/xforms}toggle)) | element(Q{http://www.w3.org/2002/xforms}send)) | element(Q{http://www.w3.org/2002/xforms}setfocus)) | element(Q{http://www.w3.org/2002/xforms}setindex)) | element(Q{http://www.w3.org/2002/xforms}load)) | element(Q{http://www.w3.org/2002/xforms}message)) | element(Q{http://www.w3.org/2002/xforms}dispatch)) | element(Q{http://www.w3.org/2002/xforms}rebuild)) | element(Q{http://www.w3.org/2002/xforms}reset)) | element(Q{http://www.w3.org/2002/xforms}show)) | element(Q{http://www.w3.org/2002/xforms}hide)) | element(Q{http://www.w3.org/2002/xforms}script)) | element(Q{http://www.w3.org/2002/xforms}unload))" jsTest="function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='action';};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='setvalue';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='insert';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='delete';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='toggle';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='send';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='setfocus';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='setindex';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='load';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='message';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='dispatch';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='rebuild';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='reset';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='show';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='hide';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='script';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='unload';};return a()||b();"/>
          <withParam name="Q{}instance1" as="node()?">
           <varRef line="2375" name="instance1" slot="0"/>
          </withParam>
          <withParam name="Q{}nodeset">
           <varRef line="2376" name="nodeset" slot="4"/>
          </withParam>
          <withParam name="Q{}bindings" as="map(xs:string, node())">
           <varRef line="2377" name="bindings" slot="1"/>
          </withParam>
          <withParam name="Q{}position">
           <varRef line="2378" name="position" slot="3"/>
          </withParam>
          <withParam name="Q{}myid" flags="t" as="item()?">
           <varRef line="2379" name="myid" slot="6"/>
          </withParam>
         </applyT>
        </treat>
        <sequence line="2384">
         <choose>
          <fn name="exists">
           <varRef name="actions" slot="7"/>
          </fn>
          <ifCall line="2395" name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
           <check card="1" diag="0|0||ixsl:call">
            <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
           </check>
           <str val="addAction"/>
           <arrayBlock>
            <varRef name="myid" slot="6"/>
            <varRef name="actions" slot="7"/>
           </arrayBlock>
          </ifCall>
         </choose>
         <elem line="2399" name="span" nsuri="" namespaces="rdf xhtml js in fn map array ev">
          <sequence>
           <att name="style" flags="l">
            <str val="display:'inline'"/>
           </att>
           <choose line="2401">
            <gc op="=" card="1:1" comp="CCC">
             <attVal name="Q{}appearance" chk="0"/>
             <str val="minimal"/>
            </gc>
            <elem line="2403" name="a" nsuri="" flags="l" namespaces="rdf xhtml js in fn map array ev">
             <sequence>
              <att name="data-action" flags="l">
               <fn name="string-join">
                <convert from="xs:anyAtomicType" to="xs:string">
                 <data>
                  <varRef name="myid" slot="6"/>
                 </data>
                </convert>
                <str val=" "/>
               </fn>
              </att>
              <copyOf line="2404" flags="vc">
               <varRef name="innerbody" slot="5"/>
              </copyOf>
             </sequence>
            </elem>
            <true/>
            <elem line="2408" name="button" nsuri="" flags="l" namespaces="rdf xhtml js in fn map array ev">
             <sequence>
              <att name="type" flags="l">
               <str val="button"/>
              </att>
              <att line="2411" name="data-action" flags="l">
               <fn name="string-join">
                <convert from="xs:anyAtomicType" to="xs:string">
                 <data>
                  <varRef name="myid" slot="6"/>
                 </data>
                </convert>
                <str val=" "/>
               </fn>
              </att>
              <copyOf line="2416" flags="vc">
               <varRef name="innerbody" slot="5"/>
              </copyOf>
             </sequence>
            </elem>
           </choose>
          </sequence>
         </elem>
        </sequence>
       </let>
      </let>
     </let>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="18" rank="1" minImp="0" slots="9" flags="s" line="2497" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}rebuild)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='rebuild';"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2498">
     <param name="Q{}instance1" slot="0" flags="t" as="node()?">
      <empty role="select"/>
      <treat role="conversion" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="8|0|XTTE0590|instance1">
       <check card="?" diag="8|0|XTTE0590|instance1">
        <supplied slot="0"/>
       </check>
      </treat>
     </param>
     <param line="2499" name="Q{}bindings" slot="1" flags="t" as="map(xs:string, node())">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, node())" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.isNode(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|bindings">
       <check card="1" diag="8|0|XTTE0590|bindings">
        <supplied slot="1"/>
       </check>
      </treat>
     </param>
     <param line="2500" name="Q{}submissions" slot="2" flags="t" as="map(xs:string, xs:string)">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, xs:string)" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.Atomic.string.matches(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|submissions">
       <check card="1" diag="8|0|XTTE0590|submissions">
        <supplied slot="2"/>
       </check>
      </treat>
     </param>
     <param line="2501" name="Q{}position" slot="3">
      <str role="select" val=""/>
      <supplied role="conversion" slot="3"/>
     </param>
     <param line="2502" name="Q{}nodeset" slot="4">
      <str role="select" val=""/>
      <supplied role="conversion" slot="4"/>
     </param>
     <param line="2503" name="Q{}updateMode" slot="5" flags="t">
      <false role="select"/>
      <supplied role="conversion" slot="5"/>
     </param>
     <param line="2509" name="Q{}myid" slot="6" flags="t">
      <choose role="select">
       <fn name="exists">
        <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       </fn>
       <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       <true/>
       <fn name="concat">
        <fn name="generate-id">
         <dot type="element()"/>
        </fn>
        <atomSing card="?" diag="0|1||fn:concat">
         <varRef name="position" slot="3"/>
        </atomSing>
       </fn>
      </choose>
      <supplied role="conversion" slot="6"/>
     </param>
     <let line="2512" var="nodeseti" as="item()*" slot="7" eval="3">
      <choose>
       <gc op="=" card="N:1" comp="GAC|http://www.w3.org/2005/xpath-functions/collation/codepoint">
        <data>
         <varRef name="nodeset" slot="4"/>
        </data>
        <str val=""/>
       </gc>
       <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
       <true/>
       <varRef name="nodeset" slot="4"/>
      </choose>
      <choose line="2514">
       <fn name="not">
        <varRef name="updateMode" slot="5"/>
       </fn>
       <sequence line="2516">
        <message>
         <sequence role="select">
          <valueOf>
           <str val="xforms:setvalue found !!!! XXX, node&#xA;                        "/>
          </valueOf>
          <valueOf line="2517">
           <fn name="serialize">
            <dot type="element()"/>
           </fn>
          </valueOf>
          <valueOf>
           <str val=", id= "/>
          </valueOf>
          <valueOf line="2517">
           <convert from="xs:untypedAtomic" to="xs:string">
            <attVal name="Q{}id" chk="0"/>
           </convert>
          </valueOf>
          <valueOf>
           <str val=",&#xA;                    myid = "/>
          </valueOf>
          <valueOf line="2518">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="myid" slot="6"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
          <valueOf>
           <str val=", nodeset="/>
          </valueOf>
          <valueOf line="2519">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="nodeseti" slot="7"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
         </sequence>
         <str role="terminate" val="no"/>
         <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
        </message>
        <let line="2522" var="action-map" as="map(xs:anyAtomicType, item()*)" slot="8" eval="8">
         <ifCall line="2526" name="Q{http://www.w3.org/2005/xpath-functions/map}merge" type="map(*)">
          <sequence>
           <choose>
            <fn name="exists">
             <varRef name="nodeset" slot="4"/>
            </fn>
            <ifCall line="2527" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@ref"/>
             <cast as="xs:string" emptiable="1">
              <atomSing card="?" diag="2|0||cast as">
               <varRef name="nodeset" slot="4"/>
              </atomSing>
             </cast>
            </ifCall>
           </choose>
           <choose line="2530">
            <fn name="exists">
             <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
            </fn>
            <ifCall line="2531" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@event"/>
             <cast as="xs:string" emptiable="1">
              <atomSing card="?" diag="2|0||cast as">
               <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
              </atomSing>
             </cast>
            </ifCall>
           </choose>
           <choose line="2534">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
            </fn>
            <ifCall line="2535" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@position"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2537">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
            </fn>
            <ifCall line="2538" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@at"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2540">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
            </fn>
            <ifCall line="2541" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@if"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2543">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
            </fn>
            <ifCall line="2544" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@while"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
             </fn>
            </ifCall>
           </choose>
           <treat line="2547" as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="18|0|XTTE3375|">
            <forEachGroup algorithm="by">
             <dot role="select" type="element()"/>
             <fn role="key" name="local-name">
              <dot type="element()"/>
             </fn>
             <str role="collation" val="http://www.w3.org/2005/xpath-functions/collation/codepoint"/>
             <applyT role="content" line="2548" mode="Q{}xforms-action-map" bSlot="1">
              <dot role="select" type="element()"/>
              <withParam name="Q{}nodeset">
               <varRef line="2549" name="nodeset" slot="4"/>
              </withParam>
             </applyT>
            </forEachGroup>
           </treat>
          </sequence>
          <map size="2">
           <str val="duplicates"/>
           <str val="reject"/>
           <str val="duplicates-error-code"/>
           <str val="XTDE3365"/>
          </map>
         </ifCall>
         <sequence line="2562">
          <message>
           <sequence role="select">
            <valueOf>
             <str val="xforms:setvalue found !!!! XXX, node&#xA;                    "/>
            </valueOf>
            <valueOf line="2563">
             <fn name="serialize">
              <dot type="element()"/>
             </fn>
            </valueOf>
            <valueOf>
             <str val=", id= "/>
            </valueOf>
            <valueOf line="2563">
             <convert from="xs:untypedAtomic" to="xs:string">
              <attVal name="Q{}id" chk="0"/>
             </convert>
            </valueOf>
            <valueOf>
             <str val=",&#xA;                    myid = "/>
            </valueOf>
            <valueOf line="2564">
             <fn name="string-join">
              <convert from="xs:anyAtomicType" to="xs:string">
               <data>
                <mergeAdj>
                 <varRef name="myid" slot="6"/>
                </mergeAdj>
               </data>
              </convert>
              <str val=" "/>
             </fn>
            </valueOf>
            <valueOf>
             <str val=", nodeset="/>
            </valueOf>
            <valueOf line="2565">
             <fn name="string-join">
              <convert from="xs:anyAtomicType" to="xs:string">
               <data>
                <mergeAdj>
                 <varRef name="nodeseti" slot="7"/>
                </mergeAdj>
               </data>
              </convert>
              <str val=" "/>
             </fn>
            </valueOf>
            <valueOf>
             <str val="&#xA;                    action xml "/>
            </valueOf>
            <valueOf line="2566">
             <fn name="serialize">
              <varRef name="action-map" slot="8"/>
              <map size="1">
               <str val="method"/>
               <str val="json"/>
              </map>
             </fn>
            </valueOf>
           </sequence>
           <str role="terminate" val="no"/>
           <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
          </message>
          <varRef line="2590" name="action-map" slot="8"/>
         </sequence>
        </let>
       </sequence>
      </choose>
     </let>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="18" rank="1" minImp="0" slots="9" flags="s" line="2497" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}delete)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='delete';"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2498">
     <param name="Q{}instance1" slot="0" flags="t" as="node()?">
      <empty role="select"/>
      <treat role="conversion" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="8|0|XTTE0590|instance1">
       <check card="?" diag="8|0|XTTE0590|instance1">
        <supplied slot="0"/>
       </check>
      </treat>
     </param>
     <param line="2499" name="Q{}bindings" slot="1" flags="t" as="map(xs:string, node())">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, node())" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.isNode(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|bindings">
       <check card="1" diag="8|0|XTTE0590|bindings">
        <supplied slot="1"/>
       </check>
      </treat>
     </param>
     <param line="2500" name="Q{}submissions" slot="2" flags="t" as="map(xs:string, xs:string)">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, xs:string)" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.Atomic.string.matches(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|submissions">
       <check card="1" diag="8|0|XTTE0590|submissions">
        <supplied slot="2"/>
       </check>
      </treat>
     </param>
     <param line="2501" name="Q{}position" slot="3">
      <str role="select" val=""/>
      <supplied role="conversion" slot="3"/>
     </param>
     <param line="2502" name="Q{}nodeset" slot="4">
      <str role="select" val=""/>
      <supplied role="conversion" slot="4"/>
     </param>
     <param line="2503" name="Q{}updateMode" slot="5" flags="t">
      <false role="select"/>
      <supplied role="conversion" slot="5"/>
     </param>
     <param line="2509" name="Q{}myid" slot="6" flags="t">
      <choose role="select">
       <fn name="exists">
        <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       </fn>
       <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       <true/>
       <fn name="concat">
        <fn name="generate-id">
         <dot type="element()"/>
        </fn>
        <atomSing card="?" diag="0|1||fn:concat">
         <varRef name="position" slot="3"/>
        </atomSing>
       </fn>
      </choose>
      <supplied role="conversion" slot="6"/>
     </param>
     <let line="2512" var="nodeseti" as="item()*" slot="7" eval="3">
      <choose>
       <gc op="=" card="N:1" comp="GAC|http://www.w3.org/2005/xpath-functions/collation/codepoint">
        <data>
         <varRef name="nodeset" slot="4"/>
        </data>
        <str val=""/>
       </gc>
       <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
       <true/>
       <varRef name="nodeset" slot="4"/>
      </choose>
      <choose line="2514">
       <fn name="not">
        <varRef name="updateMode" slot="5"/>
       </fn>
       <sequence line="2516">
        <message>
         <sequence role="select">
          <valueOf>
           <str val="xforms:setvalue found !!!! XXX, node&#xA;                        "/>
          </valueOf>
          <valueOf line="2517">
           <fn name="serialize">
            <dot type="element()"/>
           </fn>
          </valueOf>
          <valueOf>
           <str val=", id= "/>
          </valueOf>
          <valueOf line="2517">
           <convert from="xs:untypedAtomic" to="xs:string">
            <attVal name="Q{}id" chk="0"/>
           </convert>
          </valueOf>
          <valueOf>
           <str val=",&#xA;                    myid = "/>
          </valueOf>
          <valueOf line="2518">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="myid" slot="6"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
          <valueOf>
           <str val=", nodeset="/>
          </valueOf>
          <valueOf line="2519">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="nodeseti" slot="7"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
         </sequence>
         <str role="terminate" val="no"/>
         <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
        </message>
        <let line="2522" var="action-map" as="map(xs:anyAtomicType, item()*)" slot="8" eval="8">
         <ifCall line="2526" name="Q{http://www.w3.org/2005/xpath-functions/map}merge" type="map(*)">
          <sequence>
           <choose>
            <fn name="exists">
             <varRef name="nodeset" slot="4"/>
            </fn>
            <ifCall line="2527" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@ref"/>
             <cast as="xs:string" emptiable="1">
              <atomSing card="?" diag="2|0||cast as">
               <varRef name="nodeset" slot="4"/>
              </atomSing>
             </cast>
            </ifCall>
           </choose>
           <choose line="2530">
            <fn name="exists">
             <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
            </fn>
            <ifCall line="2531" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@event"/>
             <cast as="xs:string" emptiable="1">
              <atomSing card="?" diag="2|0||cast as">
               <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
              </atomSing>
             </cast>
            </ifCall>
           </choose>
           <choose line="2534">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
            </fn>
            <ifCall line="2535" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@position"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2537">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
            </fn>
            <ifCall line="2538" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@at"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2540">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
            </fn>
            <ifCall line="2541" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@if"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2543">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
            </fn>
            <ifCall line="2544" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@while"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
             </fn>
            </ifCall>
           </choose>
           <treat line="2547" as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="18|0|XTTE3375|">
            <forEachGroup algorithm="by">
             <dot role="select" type="element()"/>
             <fn role="key" name="local-name">
              <dot type="element()"/>
             </fn>
             <str role="collation" val="http://www.w3.org/2005/xpath-functions/collation/codepoint"/>
             <applyT role="content" line="2548" mode="Q{}xforms-action-map" bSlot="1">
              <dot role="select" type="element()"/>
              <withParam name="Q{}nodeset">
               <varRef line="2549" name="nodeset" slot="4"/>
              </withParam>
             </applyT>
            </forEachGroup>
           </treat>
          </sequence>
          <map size="2">
           <str val="duplicates"/>
           <str val="reject"/>
           <str val="duplicates-error-code"/>
           <str val="XTDE3365"/>
          </map>
         </ifCall>
         <sequence line="2562">
          <message>
           <sequence role="select">
            <valueOf>
             <str val="xforms:setvalue found !!!! XXX, node&#xA;                    "/>
            </valueOf>
            <valueOf line="2563">
             <fn name="serialize">
              <dot type="element()"/>
             </fn>
            </valueOf>
            <valueOf>
             <str val=", id= "/>
            </valueOf>
            <valueOf line="2563">
             <convert from="xs:untypedAtomic" to="xs:string">
              <attVal name="Q{}id" chk="0"/>
             </convert>
            </valueOf>
            <valueOf>
             <str val=",&#xA;                    myid = "/>
            </valueOf>
            <valueOf line="2564">
             <fn name="string-join">
              <convert from="xs:anyAtomicType" to="xs:string">
               <data>
                <mergeAdj>
                 <varRef name="myid" slot="6"/>
                </mergeAdj>
               </data>
              </convert>
              <str val=" "/>
             </fn>
            </valueOf>
            <valueOf>
             <str val=", nodeset="/>
            </valueOf>
            <valueOf line="2565">
             <fn name="string-join">
              <convert from="xs:anyAtomicType" to="xs:string">
               <data>
                <mergeAdj>
                 <varRef name="nodeseti" slot="7"/>
                </mergeAdj>
               </data>
              </convert>
              <str val=" "/>
             </fn>
            </valueOf>
            <valueOf>
             <str val="&#xA;                    action xml "/>
            </valueOf>
            <valueOf line="2566">
             <fn name="serialize">
              <varRef name="action-map" slot="8"/>
              <map size="1">
               <str val="method"/>
               <str val="json"/>
              </map>
             </fn>
            </valueOf>
           </sequence>
           <str role="terminate" val="no"/>
           <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
          </message>
          <varRef line="2590" name="action-map" slot="8"/>
         </sequence>
        </let>
       </sequence>
      </choose>
     </let>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="18" rank="1" minImp="0" slots="9" flags="s" line="2497" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}unload)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='unload';"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2498">
     <param name="Q{}instance1" slot="0" flags="t" as="node()?">
      <empty role="select"/>
      <treat role="conversion" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="8|0|XTTE0590|instance1">
       <check card="?" diag="8|0|XTTE0590|instance1">
        <supplied slot="0"/>
       </check>
      </treat>
     </param>
     <param line="2499" name="Q{}bindings" slot="1" flags="t" as="map(xs:string, node())">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, node())" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.isNode(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|bindings">
       <check card="1" diag="8|0|XTTE0590|bindings">
        <supplied slot="1"/>
       </check>
      </treat>
     </param>
     <param line="2500" name="Q{}submissions" slot="2" flags="t" as="map(xs:string, xs:string)">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, xs:string)" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.Atomic.string.matches(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|submissions">
       <check card="1" diag="8|0|XTTE0590|submissions">
        <supplied slot="2"/>
       </check>
      </treat>
     </param>
     <param line="2501" name="Q{}position" slot="3">
      <str role="select" val=""/>
      <supplied role="conversion" slot="3"/>
     </param>
     <param line="2502" name="Q{}nodeset" slot="4">
      <str role="select" val=""/>
      <supplied role="conversion" slot="4"/>
     </param>
     <param line="2503" name="Q{}updateMode" slot="5" flags="t">
      <false role="select"/>
      <supplied role="conversion" slot="5"/>
     </param>
     <param line="2509" name="Q{}myid" slot="6" flags="t">
      <choose role="select">
       <fn name="exists">
        <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       </fn>
       <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       <true/>
       <fn name="concat">
        <fn name="generate-id">
         <dot type="element()"/>
        </fn>
        <atomSing card="?" diag="0|1||fn:concat">
         <varRef name="position" slot="3"/>
        </atomSing>
       </fn>
      </choose>
      <supplied role="conversion" slot="6"/>
     </param>
     <let line="2512" var="nodeseti" as="item()*" slot="7" eval="3">
      <choose>
       <gc op="=" card="N:1" comp="GAC|http://www.w3.org/2005/xpath-functions/collation/codepoint">
        <data>
         <varRef name="nodeset" slot="4"/>
        </data>
        <str val=""/>
       </gc>
       <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
       <true/>
       <varRef name="nodeset" slot="4"/>
      </choose>
      <choose line="2514">
       <fn name="not">
        <varRef name="updateMode" slot="5"/>
       </fn>
       <sequence line="2516">
        <message>
         <sequence role="select">
          <valueOf>
           <str val="xforms:setvalue found !!!! XXX, node&#xA;                        "/>
          </valueOf>
          <valueOf line="2517">
           <fn name="serialize">
            <dot type="element()"/>
           </fn>
          </valueOf>
          <valueOf>
           <str val=", id= "/>
          </valueOf>
          <valueOf line="2517">
           <convert from="xs:untypedAtomic" to="xs:string">
            <attVal name="Q{}id" chk="0"/>
           </convert>
          </valueOf>
          <valueOf>
           <str val=",&#xA;                    myid = "/>
          </valueOf>
          <valueOf line="2518">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="myid" slot="6"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
          <valueOf>
           <str val=", nodeset="/>
          </valueOf>
          <valueOf line="2519">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="nodeseti" slot="7"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
         </sequence>
         <str role="terminate" val="no"/>
         <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
        </message>
        <let line="2522" var="action-map" as="map(xs:anyAtomicType, item()*)" slot="8" eval="8">
         <ifCall line="2526" name="Q{http://www.w3.org/2005/xpath-functions/map}merge" type="map(*)">
          <sequence>
           <choose>
            <fn name="exists">
             <varRef name="nodeset" slot="4"/>
            </fn>
            <ifCall line="2527" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@ref"/>
             <cast as="xs:string" emptiable="1">
              <atomSing card="?" diag="2|0||cast as">
               <varRef name="nodeset" slot="4"/>
              </atomSing>
             </cast>
            </ifCall>
           </choose>
           <choose line="2530">
            <fn name="exists">
             <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
            </fn>
            <ifCall line="2531" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@event"/>
             <cast as="xs:string" emptiable="1">
              <atomSing card="?" diag="2|0||cast as">
               <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
              </atomSing>
             </cast>
            </ifCall>
           </choose>
           <choose line="2534">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
            </fn>
            <ifCall line="2535" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@position"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2537">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
            </fn>
            <ifCall line="2538" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@at"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2540">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
            </fn>
            <ifCall line="2541" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@if"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2543">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
            </fn>
            <ifCall line="2544" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@while"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
             </fn>
            </ifCall>
           </choose>
           <treat line="2547" as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="18|0|XTTE3375|">
            <forEachGroup algorithm="by">
             <dot role="select" type="element()"/>
             <fn role="key" name="local-name">
              <dot type="element()"/>
             </fn>
             <str role="collation" val="http://www.w3.org/2005/xpath-functions/collation/codepoint"/>
             <applyT role="content" line="2548" mode="Q{}xforms-action-map" bSlot="1">
              <dot role="select" type="element()"/>
              <withParam name="Q{}nodeset">
               <varRef line="2549" name="nodeset" slot="4"/>
              </withParam>
             </applyT>
            </forEachGroup>
           </treat>
          </sequence>
          <map size="2">
           <str val="duplicates"/>
           <str val="reject"/>
           <str val="duplicates-error-code"/>
           <str val="XTDE3365"/>
          </map>
         </ifCall>
         <sequence line="2562">
          <message>
           <sequence role="select">
            <valueOf>
             <str val="xforms:setvalue found !!!! XXX, node&#xA;                    "/>
            </valueOf>
            <valueOf line="2563">
             <fn name="serialize">
              <dot type="element()"/>
             </fn>
            </valueOf>
            <valueOf>
             <str val=", id= "/>
            </valueOf>
            <valueOf line="2563">
             <convert from="xs:untypedAtomic" to="xs:string">
              <attVal name="Q{}id" chk="0"/>
             </convert>
            </valueOf>
            <valueOf>
             <str val=",&#xA;                    myid = "/>
            </valueOf>
            <valueOf line="2564">
             <fn name="string-join">
              <convert from="xs:anyAtomicType" to="xs:string">
               <data>
                <mergeAdj>
                 <varRef name="myid" slot="6"/>
                </mergeAdj>
               </data>
              </convert>
              <str val=" "/>
             </fn>
            </valueOf>
            <valueOf>
             <str val=", nodeset="/>
            </valueOf>
            <valueOf line="2565">
             <fn name="string-join">
              <convert from="xs:anyAtomicType" to="xs:string">
               <data>
                <mergeAdj>
                 <varRef name="nodeseti" slot="7"/>
                </mergeAdj>
               </data>
              </convert>
              <str val=" "/>
             </fn>
            </valueOf>
            <valueOf>
             <str val="&#xA;                    action xml "/>
            </valueOf>
            <valueOf line="2566">
             <fn name="serialize">
              <varRef name="action-map" slot="8"/>
              <map size="1">
               <str val="method"/>
               <str val="json"/>
              </map>
             </fn>
            </valueOf>
           </sequence>
           <str role="terminate" val="no"/>
           <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
          </message>
          <varRef line="2590" name="action-map" slot="8"/>
         </sequence>
        </let>
       </sequence>
      </choose>
     </let>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="15" rank="1" minImp="0" slots="4" flags="s" line="1919" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}submit)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='submit';"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="1920">
     <param name="Q{}instance1" slot="0" flags="t" as="node()?">
      <empty role="select"/>
      <treat role="conversion" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="8|0|XTTE0590|instance1">
       <check card="?" diag="8|0|XTTE0590|instance1">
        <supplied slot="0"/>
       </check>
      </treat>
     </param>
     <param line="1921" name="Q{}bindings" slot="1" flags="t" as="map(xs:string, node())">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, node())" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.isNode(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|bindings">
       <check card="1" diag="8|0|XTTE0590|bindings">
        <supplied slot="1"/>
       </check>
      </treat>
     </param>
     <param line="1922" name="Q{}submissions" slot="2" flags="t" as="map(xs:string, xs:string)">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, xs:string)" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.Atomic.string.matches(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|submissions">
       <check card="1" diag="8|0|XTTE0590|submissions">
        <supplied slot="2"/>
       </check>
      </treat>
     </param>
     <let line="1923" var="innerbody" as="document-node()" slot="3" eval="7">
      <doc line="1925" validation="preserve">
       <choose>
        <fn name="exists">
         <axis name="child" nodeTest="element(Q{http://www.w3.org/2002/xforms}label)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='label';"/>
        </fn>
        <applyT line="1926" bSlot="28">
         <axis role="select" name="child" nodeTest="( element() | text() | comment() | processing-instruction() )" jsTest="return SaxonJS.U.isNode(item) &amp;&amp; (item.nodeType===1 || item.nodeType===3 || item.nodeType===7 || item.nodeType===8);"/>
         <withParam name="Q{}instance1" as="node()?">
          <varRef line="1927" name="instance1" slot="0"/>
         </withParam>
         <withParam name="Q{}bindings" as="map(xs:string, node())">
          <varRef line="1928" name="bindings" slot="1"/>
         </withParam>
        </applyT>
        <true/>
        <valueOf line="1932" flags="l">
         <str val=" "/>
        </valueOf>
       </choose>
      </doc>
      <choose line="1938">
       <gc op="=" card="1:1" comp="CCC">
        <attVal name="Q{}appearance" chk="0"/>
        <str val="minimal"/>
       </gc>
       <elem line="1940" name="a" nsuri="" namespaces="rdf xhtml js in fn map array ev">
        <copyOf flags="vc">
         <varRef name="innerbody" slot="3"/>
        </copyOf>
       </elem>
       <true/>
       <elem line="1944" name="button" nsuri="" namespaces="rdf xhtml js in fn map array ev">
        <sequence>
         <att name="type" flags="l">
          <str val="button"/>
         </att>
         <copyOf line="1945" flags="vc">
          <filter flags="b">
           <axis name="attribute" nodeTest="attribute()" jsTest="return SaxonJS.U.isAttr(item)"/>
           <vc op="ne" comp="CCC">
            <fn name="local-name">
             <dot type="attribute()"/>
            </fn>
            <str val="ref"/>
           </vc>
          </filter>
         </copyOf>
         <choose line="1946">
          <and op="and">
           <fn name="exists">
            <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
           </fn>
           <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}contains" type="xs:boolean">
            <varRef name="submissions" slot="2"/>
            <atomSing diag="0|1||map:contains">
             <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
            </atomSing>
           </ifCall>
          </and>
          <att line="1947" name="data-submit" flags="l">
           <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
            <varRef name="submissions" slot="2"/>
            <atomSing diag="0|1||map:get">
             <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
            </atomSing>
           </ifCall>
          </att>
         </choose>
         <copyOf line="1949" flags="vc">
          <varRef name="innerbody" slot="3"/>
         </copyOf>
        </sequence>
       </elem>
      </choose>
     </let>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="18" rank="1" minImp="0" slots="9" flags="s" line="2497" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}load)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='load';"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2498">
     <param name="Q{}instance1" slot="0" flags="t" as="node()?">
      <empty role="select"/>
      <treat role="conversion" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="8|0|XTTE0590|instance1">
       <check card="?" diag="8|0|XTTE0590|instance1">
        <supplied slot="0"/>
       </check>
      </treat>
     </param>
     <param line="2499" name="Q{}bindings" slot="1" flags="t" as="map(xs:string, node())">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, node())" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.isNode(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|bindings">
       <check card="1" diag="8|0|XTTE0590|bindings">
        <supplied slot="1"/>
       </check>
      </treat>
     </param>
     <param line="2500" name="Q{}submissions" slot="2" flags="t" as="map(xs:string, xs:string)">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, xs:string)" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.Atomic.string.matches(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|submissions">
       <check card="1" diag="8|0|XTTE0590|submissions">
        <supplied slot="2"/>
       </check>
      </treat>
     </param>
     <param line="2501" name="Q{}position" slot="3">
      <str role="select" val=""/>
      <supplied role="conversion" slot="3"/>
     </param>
     <param line="2502" name="Q{}nodeset" slot="4">
      <str role="select" val=""/>
      <supplied role="conversion" slot="4"/>
     </param>
     <param line="2503" name="Q{}updateMode" slot="5" flags="t">
      <false role="select"/>
      <supplied role="conversion" slot="5"/>
     </param>
     <param line="2509" name="Q{}myid" slot="6" flags="t">
      <choose role="select">
       <fn name="exists">
        <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       </fn>
       <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       <true/>
       <fn name="concat">
        <fn name="generate-id">
         <dot type="element()"/>
        </fn>
        <atomSing card="?" diag="0|1||fn:concat">
         <varRef name="position" slot="3"/>
        </atomSing>
       </fn>
      </choose>
      <supplied role="conversion" slot="6"/>
     </param>
     <let line="2512" var="nodeseti" as="item()*" slot="7" eval="3">
      <choose>
       <gc op="=" card="N:1" comp="GAC|http://www.w3.org/2005/xpath-functions/collation/codepoint">
        <data>
         <varRef name="nodeset" slot="4"/>
        </data>
        <str val=""/>
       </gc>
       <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
       <true/>
       <varRef name="nodeset" slot="4"/>
      </choose>
      <choose line="2514">
       <fn name="not">
        <varRef name="updateMode" slot="5"/>
       </fn>
       <sequence line="2516">
        <message>
         <sequence role="select">
          <valueOf>
           <str val="xforms:setvalue found !!!! XXX, node&#xA;                        "/>
          </valueOf>
          <valueOf line="2517">
           <fn name="serialize">
            <dot type="element()"/>
           </fn>
          </valueOf>
          <valueOf>
           <str val=", id= "/>
          </valueOf>
          <valueOf line="2517">
           <convert from="xs:untypedAtomic" to="xs:string">
            <attVal name="Q{}id" chk="0"/>
           </convert>
          </valueOf>
          <valueOf>
           <str val=",&#xA;                    myid = "/>
          </valueOf>
          <valueOf line="2518">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="myid" slot="6"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
          <valueOf>
           <str val=", nodeset="/>
          </valueOf>
          <valueOf line="2519">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="nodeseti" slot="7"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
         </sequence>
         <str role="terminate" val="no"/>
         <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
        </message>
        <let line="2522" var="action-map" as="map(xs:anyAtomicType, item()*)" slot="8" eval="8">
         <ifCall line="2526" name="Q{http://www.w3.org/2005/xpath-functions/map}merge" type="map(*)">
          <sequence>
           <choose>
            <fn name="exists">
             <varRef name="nodeset" slot="4"/>
            </fn>
            <ifCall line="2527" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@ref"/>
             <cast as="xs:string" emptiable="1">
              <atomSing card="?" diag="2|0||cast as">
               <varRef name="nodeset" slot="4"/>
              </atomSing>
             </cast>
            </ifCall>
           </choose>
           <choose line="2530">
            <fn name="exists">
             <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
            </fn>
            <ifCall line="2531" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@event"/>
             <cast as="xs:string" emptiable="1">
              <atomSing card="?" diag="2|0||cast as">
               <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
              </atomSing>
             </cast>
            </ifCall>
           </choose>
           <choose line="2534">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
            </fn>
            <ifCall line="2535" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@position"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2537">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
            </fn>
            <ifCall line="2538" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@at"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2540">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
            </fn>
            <ifCall line="2541" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@if"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2543">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
            </fn>
            <ifCall line="2544" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@while"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
             </fn>
            </ifCall>
           </choose>
           <treat line="2547" as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="18|0|XTTE3375|">
            <forEachGroup algorithm="by">
             <dot role="select" type="element()"/>
             <fn role="key" name="local-name">
              <dot type="element()"/>
             </fn>
             <str role="collation" val="http://www.w3.org/2005/xpath-functions/collation/codepoint"/>
             <applyT role="content" line="2548" mode="Q{}xforms-action-map" bSlot="1">
              <dot role="select" type="element()"/>
              <withParam name="Q{}nodeset">
               <varRef line="2549" name="nodeset" slot="4"/>
              </withParam>
             </applyT>
            </forEachGroup>
           </treat>
          </sequence>
          <map size="2">
           <str val="duplicates"/>
           <str val="reject"/>
           <str val="duplicates-error-code"/>
           <str val="XTDE3365"/>
          </map>
         </ifCall>
         <sequence line="2562">
          <message>
           <sequence role="select">
            <valueOf>
             <str val="xforms:setvalue found !!!! XXX, node&#xA;                    "/>
            </valueOf>
            <valueOf line="2563">
             <fn name="serialize">
              <dot type="element()"/>
             </fn>
            </valueOf>
            <valueOf>
             <str val=", id= "/>
            </valueOf>
            <valueOf line="2563">
             <convert from="xs:untypedAtomic" to="xs:string">
              <attVal name="Q{}id" chk="0"/>
             </convert>
            </valueOf>
            <valueOf>
             <str val=",&#xA;                    myid = "/>
            </valueOf>
            <valueOf line="2564">
             <fn name="string-join">
              <convert from="xs:anyAtomicType" to="xs:string">
               <data>
                <mergeAdj>
                 <varRef name="myid" slot="6"/>
                </mergeAdj>
               </data>
              </convert>
              <str val=" "/>
             </fn>
            </valueOf>
            <valueOf>
             <str val=", nodeset="/>
            </valueOf>
            <valueOf line="2565">
             <fn name="string-join">
              <convert from="xs:anyAtomicType" to="xs:string">
               <data>
                <mergeAdj>
                 <varRef name="nodeseti" slot="7"/>
                </mergeAdj>
               </data>
              </convert>
              <str val=" "/>
             </fn>
            </valueOf>
            <valueOf>
             <str val="&#xA;                    action xml "/>
            </valueOf>
            <valueOf line="2566">
             <fn name="serialize">
              <varRef name="action-map" slot="8"/>
              <map size="1">
               <str val="method"/>
               <str val="json"/>
              </map>
             </fn>
            </valueOf>
           </sequence>
           <str role="terminate" val="no"/>
           <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
          </message>
          <varRef line="2590" name="action-map" slot="8"/>
         </sequence>
        </let>
       </sequence>
      </choose>
     </let>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="8" rank="1" minImp="0" slots="8" flags="s" line="1598" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}select1)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='select1';"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="1602">
     <param name="Q{}nodeset" slot="0" as="xs:string">
      <str role="select" val=""/>
      <treat role="conversion" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="8|0|XTTE0590|nodeset">
       <check card="1" diag="8|0|XTTE0590|nodeset">
        <cvUntyped to="xs:string">
         <data>
          <supplied slot="0"/>
         </data>
        </cvUntyped>
       </check>
      </treat>
     </param>
     <param line="1603" name="Q{}position" slot="1">
      <str role="select" val=""/>
      <supplied role="conversion" slot="1"/>
     </param>
     <let line="1611" var="bindingi" as="node()?" slot="2" eval="7">
      <treat line="1612" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="3|0|XTTE0570|bindingi">
       <check card="?" diag="3|0|XTTE0570|bindingi">
        <callT name="getBinding" bSlot="18">
         <withParam name="Q{}this" flags="c" as="element()">
          <dot line="1613" type="element()"/>
         </withParam>
        </callT>
       </check>
      </treat>
      <let line="1618" var="refi" as="xs:string" slot="3" eval="7">
       <treat line="1619" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="3|0|XTTE0570|refi">
        <check card="1" diag="3|0|XTTE0570|refi">
         <cvUntyped to="xs:string">
          <data>
           <callT name="getDataRef" bSlot="19">
            <withParam name="Q{}this" flags="c" as="element()">
             <dot line="1620" type="element()"/>
            </withParam>
            <withParam name="Q{}bindingi" flags="c" as="node()?">
             <varRef line="1621" name="bindingi" slot="2"/>
            </withParam>
           </callT>
          </data>
         </cvUntyped>
        </check>
       </treat>
       <let line="1631" var="instanceField" as="node()?" slot="4" eval="7">
        <treat line="1632" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="3|0|XTTE0570|instanceField">
         <check card="?" diag="3|0|XTTE0570|instanceField">
          <callT name="getReferencedInstanceField" bSlot="20">
           <withParam name="Q{}refi" flags="c" as="xs:string">
            <varRef line="1633" name="refi" slot="3"/>
           </withParam>
          </callT>
         </check>
        </treat>
        <let line="1639" var="selectedValue" as="xs:string" slot="5" eval="7">
         <choose line="1641">
          <fn name="exists">
           <varRef name="instanceField" slot="4"/>
          </fn>
          <cvUntyped line="1642" to="xs:string">
           <cast as="xs:untypedAtomic" emptiable="0">
            <fn name="string">
             <convert from="xs:anyAtomicType" to="xs:string">
              <data>
               <varRef name="instanceField" slot="4"/>
              </data>
             </convert>
            </fn>
           </cast>
          </cvUntyped>
          <true/>
          <str val=""/>
         </choose>
         <sequence line="1650">
          <message>
           <sequence role="select">
            <valueOf>
             <str val="[xforms:select] selected value = "/>
            </valueOf>
            <valueOf>
             <varRef name="selectedValue" slot="5"/>
            </valueOf>
           </sequence>
           <str role="terminate" val="no"/>
           <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
          </message>
          <applyT line="1653" bSlot="21">
           <axis role="select" name="child" nodeTest="element(Q{http://www.w3.org/2002/xforms}label)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='label';"/>
          </applyT>
          <let line="1655" var="actions" as="map(*)*" slot="6" eval="3">
           <treat line="1656" as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="3|0|XTTE0570|actions">
            <applyT bSlot="22">
             <axis role="select" name="child" nodeTest="((((((((((((((((element(Q{http://www.w3.org/2002/xforms}action) | element(Q{http://www.w3.org/2002/xforms}setvalue)) | element(Q{http://www.w3.org/2002/xforms}insert)) | element(Q{http://www.w3.org/2002/xforms}delete)) | element(Q{http://www.w3.org/2002/xforms}toggle)) | element(Q{http://www.w3.org/2002/xforms}send)) | element(Q{http://www.w3.org/2002/xforms}setfocus)) | element(Q{http://www.w3.org/2002/xforms}setindex)) | element(Q{http://www.w3.org/2002/xforms}load)) | element(Q{http://www.w3.org/2002/xforms}message)) | element(Q{http://www.w3.org/2002/xforms}dispatch)) | element(Q{http://www.w3.org/2002/xforms}rebuild)) | element(Q{http://www.w3.org/2002/xforms}reset)) | element(Q{http://www.w3.org/2002/xforms}show)) | element(Q{http://www.w3.org/2002/xforms}hide)) | element(Q{http://www.w3.org/2002/xforms}script)) | element(Q{http://www.w3.org/2002/xforms}unload))" jsTest="function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='action';};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='setvalue';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='insert';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='delete';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='toggle';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='send';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='setfocus';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='setindex';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='load';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='message';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='dispatch';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='rebuild';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='reset';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='show';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='hide';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='script';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='unload';};return a()||b();"/>
             <withParam name="Q{}nodeset" as="xs:string">
              <varRef line="1658" name="refi" slot="3"/>
             </withParam>
            </applyT>
           </treat>
           <let line="1669" var="myid" as="item()?" slot="7" eval="7">
            <choose>
             <fn name="exists">
              <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
             </fn>
             <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
             <true/>
             <fn name="concat">
              <fn name="generate-id">
               <dot type="element()"/>
              </fn>
              <atomSing card="?" diag="0|1||fn:concat">
               <varRef name="position" slot="1"/>
              </atomSing>
             </fn>
            </choose>
            <sequence line="1672">
             <choose>
              <fn name="exists">
               <varRef name="actions" slot="6"/>
              </fn>
              <ifCall line="1681" name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
               <check card="1" diag="0|0||ixsl:call">
                <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
               </check>
               <str val="addAction"/>
               <arrayBlock>
                <varRef name="myid" slot="7"/>
                <varRef name="actions" slot="6"/>
               </arrayBlock>
              </ifCall>
             </choose>
             <elem line="1687" name="span" nsuri="" namespaces="rdf xhtml js in fn map array ev">
              <sequence>
               <att name="style" flags="l">
                <str val="display:inline"/>
               </att>
               <elem line="1689" name="select" nsuri="" flags="l" namespaces="rdf xhtml js in fn map array ev">
                <sequence>
                 <copyOf flags="vc">
                  <filter flags="b">
                   <axis name="attribute" nodeTest="attribute()" jsTest="return SaxonJS.U.isAttr(item)"/>
                   <vc op="ne" comp="CCC">
                    <fn name="local-name">
                     <dot type="attribute()"/>
                    </fn>
                    <str val="ref"/>
                   </vc>
                  </filter>
                 </copyOf>
                 <choose line="1690">
                  <fn name="exists">
                   <varRef name="refi" slot="3"/>
                  </fn>
                  <att line="1691" name="data-ref" flags="l">
                   <varRef name="refi" slot="3"/>
                  </att>
                 </choose>
                 <att line="1702" name="data-element" flags="l">
                  <lastOf line="1685">
                   <fn name="tokenize">
                    <varRef name="refi" slot="3"/>
                    <str val="/"/>
                    <str val=""/>
                   </fn>
                  </lastOf>
                 </att>
                 <choose line="1703">
                  <and op="and">
                   <fn name="exists">
                    <varRef name="bindingi" slot="2"/>
                   </fn>
                   <fn name="exists">
                    <slash simple="1">
                     <varRef name="bindingi" slot="2"/>
                     <axis name="attribute" nodeTest="attribute(Q{}constraint)" jsTest="return item.name==='constraint'"/>
                    </slash>
                   </fn>
                  </and>
                  <att line="1704" name="data-constraint" flags="l">
                   <convert from="xs:untypedAtomic" to="xs:string">
                    <data>
                     <slash simple="1">
                      <varRef name="bindingi" slot="2"/>
                      <axis name="attribute" nodeTest="attribute(Q{}constraint)" jsTest="return item.name==='constraint'"/>
                     </slash>
                    </data>
                   </convert>
                  </att>
                 </choose>
                 <choose line="1706">
                  <vc op="eq" onEmpty="0" comp="CCC">
                   <fn name="local-name">
                    <dot type="element()"/>
                   </fn>
                   <str val="select"/>
                  </vc>
                  <sequence line="1709">
                   <att name="multiple" flags="l">
                    <str val="true"/>
                   </att>
                   <att name="size" flags="l">
                    <convert from="xs:integer" to="xs:string">
                     <fn name="count">
                      <axis name="descendant" nodeTest="element(Q{http://www.w3.org/2002/xforms}item)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='item';"/>
                     </fn>
                    </convert>
                   </att>
                  </sequence>
                 </choose>
                 <choose line="1712">
                  <fn name="exists">
                   <varRef name="actions" slot="6"/>
                  </fn>
                  <att line="1713" name="data-action" flags="l">
                   <fn name="string-join">
                    <convert from="xs:anyAtomicType" to="xs:string">
                     <data>
                      <varRef name="myid" slot="7"/>
                     </data>
                    </convert>
                    <str val=" "/>
                   </fn>
                  </att>
                 </choose>
                 <applyT line="1718" bSlot="23">
                  <axis role="select" name="child" nodeTest="element(Q{http://www.w3.org/2002/xforms}item)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='item';"/>
                  <withParam name="Q{}selectedValue" as="xs:string">
                   <varRef line="1723" name="selectedValue" slot="5"/>
                  </withParam>
                 </applyT>
                </sequence>
               </elem>
              </sequence>
             </elem>
            </sequence>
           </let>
          </let>
         </sequence>
        </let>
       </let>
      </let>
     </let>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="17" rank="1" minImp="0" slots="7" flags="s" line="2424" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}action)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='action';"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2425">
     <param name="Q{}instance1" slot="0" flags="t" as="node()?">
      <empty role="select"/>
      <treat role="conversion" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="8|0|XTTE0590|instance1">
       <check card="?" diag="8|0|XTTE0590|instance1">
        <supplied slot="0"/>
       </check>
      </treat>
     </param>
     <param line="2426" name="Q{}bindings" slot="1" flags="t" as="map(xs:string, node())">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, node())" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.isNode(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|bindings">
       <check card="1" diag="8|0|XTTE0590|bindings">
        <supplied slot="1"/>
       </check>
      </treat>
     </param>
     <param line="2427" name="Q{}submissions" slot="2" flags="t" as="map(xs:string, xs:string)">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, xs:string)" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.Atomic.string.matches(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|submissions">
       <check card="1" diag="8|0|XTTE0590|submissions">
        <supplied slot="2"/>
       </check>
      </treat>
     </param>
     <param line="2428" name="Q{}position" slot="3">
      <str role="select" val=""/>
      <supplied role="conversion" slot="3"/>
     </param>
     <param line="2429" name="Q{}nodeset" slot="4">
      <str role="select" val=""/>
      <supplied role="conversion" slot="4"/>
     </param>
     <param line="2435" name="Q{}myid" slot="5" flags="t">
      <choose role="select">
       <fn name="exists">
        <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       </fn>
       <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       <true/>
       <fn name="concat">
        <fn name="generate-id">
         <dot type="element(Q{http://www.w3.org/2002/xforms}action)"/>
        </fn>
        <atomSing card="?" diag="0|1||fn:concat">
         <varRef name="position" slot="3"/>
        </atomSing>
       </fn>
      </choose>
      <supplied role="conversion" slot="5"/>
     </param>
     <let line="2442" var="action-map" as="map(xs:anyAtomicType, item()*)" slot="6" eval="8">
      <ifCall line="2446" name="Q{http://www.w3.org/2005/xpath-functions/map}merge" type="map(*)">
       <sequence>
        <choose>
         <fn name="exists">
          <varRef name="nodeset" slot="4"/>
         </fn>
         <ifCall line="2447" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
          <str val="@ref"/>
          <cast as="xs:string" emptiable="1">
           <atomSing card="?" diag="2|0||cast as">
            <varRef name="nodeset" slot="4"/>
           </atomSing>
          </cast>
         </ifCall>
        </choose>
        <choose line="2450">
         <fn name="exists">
          <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
         </fn>
         <ifCall line="2451" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
          <str val="@event"/>
          <cast as="xs:string" emptiable="1">
           <atomSing card="?" diag="2|0||cast as">
            <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
           </atomSing>
          </cast>
         </ifCall>
        </choose>
        <choose line="2454">
         <fn name="exists">
          <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
         </fn>
         <ifCall line="2455" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
          <str val="@position"/>
          <fn name="string">
           <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
          </fn>
         </ifCall>
        </choose>
        <choose line="2457">
         <fn name="exists">
          <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
         </fn>
         <ifCall line="2458" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
          <str val="@at"/>
          <fn name="string">
           <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
          </fn>
         </ifCall>
        </choose>
        <choose line="2460">
         <fn name="exists">
          <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
         </fn>
         <ifCall line="2461" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
          <str val="@if"/>
          <fn name="string">
           <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
          </fn>
         </ifCall>
        </choose>
        <choose line="2463">
         <fn name="exists">
          <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
         </fn>
         <ifCall line="2464" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
          <str val="@while"/>
          <fn name="string">
           <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
          </fn>
         </ifCall>
        </choose>
        <treat line="2468" as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="18|0|XTTE3375|">
         <forEachGroup algorithm="by">
          <axis role="select" name="child" nodeTest="(((((((((((((((element(Q{http://www.w3.org/2002/xforms}setvalue) | element(Q{http://www.w3.org/2002/xforms}insert)) | element(Q{http://www.w3.org/2002/xforms}delete)) | element(Q{http://www.w3.org/2002/xforms}toggle)) | element(Q{http://www.w3.org/2002/xforms}send)) | element(Q{http://www.w3.org/2002/xforms}setfocus)) | element(Q{http://www.w3.org/2002/xforms}setindex)) | element(Q{http://www.w3.org/2002/xforms}load)) | element(Q{http://www.w3.org/2002/xforms}message)) | element(Q{http://www.w3.org/2002/xforms}dispatch)) | element(Q{http://www.w3.org/2002/xforms}rebuild)) | element(Q{http://www.w3.org/2002/xforms}reset)) | element(Q{http://www.w3.org/2002/xforms}show)) | element(Q{http://www.w3.org/2002/xforms}hide)) | element(Q{http://www.w3.org/2002/xforms}script)) | element(Q{http://www.w3.org/2002/xforms}unload))" jsTest="function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {function a() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='setvalue';};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='insert';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='delete';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='toggle';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='send';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='setfocus';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='setindex';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='load';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='message';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='dispatch';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='rebuild';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='reset';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='show';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='hide';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='script';};return a()||b();};function b() {var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='unload';};return a()||b();"/>
          <fn role="key" name="local-name">
           <dot type="element()"/>
          </fn>
          <str role="collation" val="http://www.w3.org/2005/xpath-functions/collation/codepoint"/>
          <applyT role="content" line="2470" mode="Q{}xforms-action-map" bSlot="29">
           <dot role="select" type="(((((((((((((((element(Q{http://www.w3.org/2002/xforms}setvalue) | element(Q{http://www.w3.org/2002/xforms}insert)) | element(Q{http://www.w3.org/2002/xforms}delete)) | element(Q{http://www.w3.org/2002/xforms}toggle)) | element(Q{http://www.w3.org/2002/xforms}send)) | element(Q{http://www.w3.org/2002/xforms}setfocus)) | element(Q{http://www.w3.org/2002/xforms}setindex)) | element(Q{http://www.w3.org/2002/xforms}load)) | element(Q{http://www.w3.org/2002/xforms}message)) | element(Q{http://www.w3.org/2002/xforms}dispatch)) | element(Q{http://www.w3.org/2002/xforms}rebuild)) | element(Q{http://www.w3.org/2002/xforms}reset)) | element(Q{http://www.w3.org/2002/xforms}show)) | element(Q{http://www.w3.org/2002/xforms}hide)) | element(Q{http://www.w3.org/2002/xforms}script)) | element(Q{http://www.w3.org/2002/xforms}unload))"/>
           <withParam name="Q{}nodeset">
            <varRef line="2471" name="nodeset" slot="4"/>
           </withParam>
          </applyT>
         </forEachGroup>
        </treat>
       </sequence>
       <map size="2">
        <str val="duplicates"/>
        <str val="reject"/>
        <str val="duplicates-error-code"/>
        <str val="XTDE3365"/>
       </map>
      </ifCall>
      <sequence line="2480">
       <message>
        <sequence role="select">
         <valueOf>
          <str val="xforms:action found !!!! XXX, node&#xA;            "/>
         </valueOf>
         <valueOf line="2481">
          <fn name="serialize">
           <dot type="element(Q{http://www.w3.org/2002/xforms}action)"/>
          </fn>
         </valueOf>
         <valueOf>
          <str val=", id= "/>
         </valueOf>
         <valueOf line="2481">
          <convert from="xs:untypedAtomic" to="xs:string">
           <attVal name="Q{}id" chk="0"/>
          </convert>
         </valueOf>
         <valueOf>
          <str val=",&#xA;            myid = "/>
         </valueOf>
         <valueOf line="2482">
          <fn name="string-join">
           <convert from="xs:anyAtomicType" to="xs:string">
            <data>
             <mergeAdj>
              <varRef name="myid" slot="5"/>
             </mergeAdj>
            </data>
           </convert>
           <str val=" "/>
          </fn>
         </valueOf>
         <valueOf>
          <str val=", nodeset="/>
         </valueOf>
         <valueOf line="2483">
          <fn name="string-join">
           <convert from="xs:anyAtomicType" to="xs:string">
            <data>
             <mergeAdj>
              <varRef name="nodeset" slot="4"/>
             </mergeAdj>
            </data>
           </convert>
           <str val=" "/>
          </fn>
         </valueOf>
         <valueOf>
          <str val="&#xA;            action xml "/>
         </valueOf>
         <valueOf line="2484">
          <fn name="serialize">
           <varRef name="action-map" slot="6"/>
          </fn>
         </valueOf>
        </sequence>
        <str role="terminate" val="no"/>
        <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
       </message>
       <choose line="2487">
        <and op="and">
         <fn name="exists">
          <varRef name="action-map" slot="6"/>
         </fn>
         <fn name="exists">
          <varRef name="myid" slot="5"/>
         </fn>
        </and>
        <varRef line="2489" name="action-map" slot="6"/>
       </choose>
      </sequence>
     </let>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="18" rank="1" minImp="0" slots="9" flags="s" line="2497" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}show)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='show';"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2498">
     <param name="Q{}instance1" slot="0" flags="t" as="node()?">
      <empty role="select"/>
      <treat role="conversion" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="8|0|XTTE0590|instance1">
       <check card="?" diag="8|0|XTTE0590|instance1">
        <supplied slot="0"/>
       </check>
      </treat>
     </param>
     <param line="2499" name="Q{}bindings" slot="1" flags="t" as="map(xs:string, node())">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, node())" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.isNode(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|bindings">
       <check card="1" diag="8|0|XTTE0590|bindings">
        <supplied slot="1"/>
       </check>
      </treat>
     </param>
     <param line="2500" name="Q{}submissions" slot="2" flags="t" as="map(xs:string, xs:string)">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, xs:string)" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.Atomic.string.matches(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|submissions">
       <check card="1" diag="8|0|XTTE0590|submissions">
        <supplied slot="2"/>
       </check>
      </treat>
     </param>
     <param line="2501" name="Q{}position" slot="3">
      <str role="select" val=""/>
      <supplied role="conversion" slot="3"/>
     </param>
     <param line="2502" name="Q{}nodeset" slot="4">
      <str role="select" val=""/>
      <supplied role="conversion" slot="4"/>
     </param>
     <param line="2503" name="Q{}updateMode" slot="5" flags="t">
      <false role="select"/>
      <supplied role="conversion" slot="5"/>
     </param>
     <param line="2509" name="Q{}myid" slot="6" flags="t">
      <choose role="select">
       <fn name="exists">
        <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       </fn>
       <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       <true/>
       <fn name="concat">
        <fn name="generate-id">
         <dot type="element()"/>
        </fn>
        <atomSing card="?" diag="0|1||fn:concat">
         <varRef name="position" slot="3"/>
        </atomSing>
       </fn>
      </choose>
      <supplied role="conversion" slot="6"/>
     </param>
     <let line="2512" var="nodeseti" as="item()*" slot="7" eval="3">
      <choose>
       <gc op="=" card="N:1" comp="GAC|http://www.w3.org/2005/xpath-functions/collation/codepoint">
        <data>
         <varRef name="nodeset" slot="4"/>
        </data>
        <str val=""/>
       </gc>
       <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
       <true/>
       <varRef name="nodeset" slot="4"/>
      </choose>
      <choose line="2514">
       <fn name="not">
        <varRef name="updateMode" slot="5"/>
       </fn>
       <sequence line="2516">
        <message>
         <sequence role="select">
          <valueOf>
           <str val="xforms:setvalue found !!!! XXX, node&#xA;                        "/>
          </valueOf>
          <valueOf line="2517">
           <fn name="serialize">
            <dot type="element()"/>
           </fn>
          </valueOf>
          <valueOf>
           <str val=", id= "/>
          </valueOf>
          <valueOf line="2517">
           <convert from="xs:untypedAtomic" to="xs:string">
            <attVal name="Q{}id" chk="0"/>
           </convert>
          </valueOf>
          <valueOf>
           <str val=",&#xA;                    myid = "/>
          </valueOf>
          <valueOf line="2518">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="myid" slot="6"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
          <valueOf>
           <str val=", nodeset="/>
          </valueOf>
          <valueOf line="2519">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="nodeseti" slot="7"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
         </sequence>
         <str role="terminate" val="no"/>
         <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
        </message>
        <let line="2522" var="action-map" as="map(xs:anyAtomicType, item()*)" slot="8" eval="8">
         <ifCall line="2526" name="Q{http://www.w3.org/2005/xpath-functions/map}merge" type="map(*)">
          <sequence>
           <choose>
            <fn name="exists">
             <varRef name="nodeset" slot="4"/>
            </fn>
            <ifCall line="2527" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@ref"/>
             <cast as="xs:string" emptiable="1">
              <atomSing card="?" diag="2|0||cast as">
               <varRef name="nodeset" slot="4"/>
              </atomSing>
             </cast>
            </ifCall>
           </choose>
           <choose line="2530">
            <fn name="exists">
             <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
            </fn>
            <ifCall line="2531" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@event"/>
             <cast as="xs:string" emptiable="1">
              <atomSing card="?" diag="2|0||cast as">
               <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
              </atomSing>
             </cast>
            </ifCall>
           </choose>
           <choose line="2534">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
            </fn>
            <ifCall line="2535" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@position"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2537">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
            </fn>
            <ifCall line="2538" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@at"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2540">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
            </fn>
            <ifCall line="2541" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@if"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2543">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
            </fn>
            <ifCall line="2544" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@while"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
             </fn>
            </ifCall>
           </choose>
           <treat line="2547" as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="18|0|XTTE3375|">
            <forEachGroup algorithm="by">
             <dot role="select" type="element()"/>
             <fn role="key" name="local-name">
              <dot type="element()"/>
             </fn>
             <str role="collation" val="http://www.w3.org/2005/xpath-functions/collation/codepoint"/>
             <applyT role="content" line="2548" mode="Q{}xforms-action-map" bSlot="1">
              <dot role="select" type="element()"/>
              <withParam name="Q{}nodeset">
               <varRef line="2549" name="nodeset" slot="4"/>
              </withParam>
             </applyT>
            </forEachGroup>
           </treat>
          </sequence>
          <map size="2">
           <str val="duplicates"/>
           <str val="reject"/>
           <str val="duplicates-error-code"/>
           <str val="XTDE3365"/>
          </map>
         </ifCall>
         <sequence line="2562">
          <message>
           <sequence role="select">
            <valueOf>
             <str val="xforms:setvalue found !!!! XXX, node&#xA;                    "/>
            </valueOf>
            <valueOf line="2563">
             <fn name="serialize">
              <dot type="element()"/>
             </fn>
            </valueOf>
            <valueOf>
             <str val=", id= "/>
            </valueOf>
            <valueOf line="2563">
             <convert from="xs:untypedAtomic" to="xs:string">
              <attVal name="Q{}id" chk="0"/>
             </convert>
            </valueOf>
            <valueOf>
             <str val=",&#xA;                    myid = "/>
            </valueOf>
            <valueOf line="2564">
             <fn name="string-join">
              <convert from="xs:anyAtomicType" to="xs:string">
               <data>
                <mergeAdj>
                 <varRef name="myid" slot="6"/>
                </mergeAdj>
               </data>
              </convert>
              <str val=" "/>
             </fn>
            </valueOf>
            <valueOf>
             <str val=", nodeset="/>
            </valueOf>
            <valueOf line="2565">
             <fn name="string-join">
              <convert from="xs:anyAtomicType" to="xs:string">
               <data>
                <mergeAdj>
                 <varRef name="nodeseti" slot="7"/>
                </mergeAdj>
               </data>
              </convert>
              <str val=" "/>
             </fn>
            </valueOf>
            <valueOf>
             <str val="&#xA;                    action xml "/>
            </valueOf>
            <valueOf line="2566">
             <fn name="serialize">
              <varRef name="action-map" slot="8"/>
              <map size="1">
               <str val="method"/>
               <str val="json"/>
              </map>
             </fn>
            </valueOf>
           </sequence>
           <str role="terminate" val="no"/>
           <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
          </message>
          <varRef line="2590" name="action-map" slot="8"/>
         </sequence>
        </let>
       </sequence>
      </choose>
     </let>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="14" rank="1" minImp="0" slots="8" flags="s" line="1822" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}repeat)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='repeat';"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="1823">
     <param name="Q{}instance1" slot="0" flags="t" as="node()?">
      <empty role="select"/>
      <treat role="conversion" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="8|0|XTTE0590|instance1">
       <check card="?" diag="8|0|XTTE0590|instance1">
        <supplied slot="0"/>
       </check>
      </treat>
     </param>
     <param line="1824" name="Q{}bindings" slot="1" flags="t" as="map(xs:string, node())">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, node())" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.isNode(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|bindings">
       <check card="1" diag="8|0|XTTE0590|bindings">
        <supplied slot="1"/>
       </check>
      </treat>
     </param>
     <param line="1825" name="Q{}submissions" slot="2" flags="t" as="map(xs:string, xs:string)">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, xs:string)" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.Atomic.string.matches(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|submissions">
       <check card="1" diag="8|0|XTTE0590|submissions">
        <supplied slot="2"/>
       </check>
      </treat>
     </param>
     <param line="1826" name="Q{}nodeset" slot="3" as="xs:string">
      <str role="select" val=""/>
      <treat role="conversion" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="8|0|XTTE0590|nodeset">
       <check card="1" diag="8|0|XTTE0590|nodeset">
        <cvUntyped to="xs:string">
         <data>
          <supplied slot="3"/>
         </data>
        </cvUntyped>
       </check>
      </treat>
     </param>
     <let line="1829" var="context" as="element(Q{http://www.w3.org/2002/xforms}repeat)" slot="4" eval="7">
      <dot type="element(Q{http://www.w3.org/2002/xforms}repeat)"/>
      <let line="1832" var="refi" as="xs:string" slot="5" eval="7">
       <choose line="1834">
        <fn name="exists">
         <axis name="attribute" nodeTest="attribute(Q{}ref)" jsTest="return item.name==='ref'"/>
        </fn>
        <cvUntyped line="1841" to="xs:string">
         <cast as="xs:untypedAtomic" emptiable="0">
          <choose>
           <fn name="not">
            <varRef name="nodeset" slot="3"/>
           </fn>
           <fn name="concat">
            <varRef name="nodeset" slot="3"/>
            <attVal name="Q{}ref" chk="0"/>
           </fn>
           <true/>
           <fn name="concat">
            <varRef name="nodeset" slot="3"/>
            <str val="/"/>
            <attVal name="Q{}ref" chk="0"/>
           </fn>
          </choose>
         </cast>
        </cvUntyped>
        <fn line="1843" name="exists">
         <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
        </fn>
        <cvUntyped line="1850" to="xs:string">
         <cast as="xs:untypedAtomic" emptiable="0">
          <choose>
           <fn name="not">
            <varRef name="nodeset" slot="3"/>
           </fn>
           <fn name="concat">
            <varRef name="nodeset" slot="3"/>
            <attVal name="Q{}nodeset" chk="0"/>
           </fn>
           <true/>
           <fn name="concat">
            <varRef name="nodeset" slot="3"/>
            <str val="/"/>
            <attVal name="Q{}nodeset" chk="0"/>
           </fn>
          </choose>
         </cast>
        </cvUntyped>
        <true/>
        <str val=""/>
       </choose>
       <choose line="1868">
        <fn name="exists">
         <varRef name="instance1" slot="0"/>
        </fn>
        <sequence line="1869">
         <message>
          <sequence role="select">
           <valueOf>
            <str val="&#xA;                repeat:&#xA;                nodeset = "/>
           </valueOf>
           <fn line="1871" name="serialize">
            <varRef name="nodeset" slot="3"/>
           </fn>
           <valueOf>
            <str val="&#xA;                refi = "/>
           </valueOf>
           <fn line="1872" name="serialize">
            <varRef name="refi" slot="5"/>
           </fn>
           <valueOf>
            <str val="&#xA;                instance1 = "/>
           </valueOf>
           <fn line="1873" name="serialize">
            <varRef name="instance1" slot="0"/>
           </fn>
          </sequence>
          <str role="terminate" val="no"/>
          <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
         </message>
         <let line="1875" var="selectedRepeatVar" as="node()*" slot="6" eval="8">
          <treat line="1877" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="3|0|XTTE0570|selectedRepeatVar">
           <evaluate dxns="">
            <varRef role="xpath" name="refi" slot="5"/>
            <varRef role="cxt" name="instance1" slot="0"/>
            <str role="sa" val="no"/>
            <map role="wp" size="0"/>
           </evaluate>
          </treat>
          <sequence line="1883">
           <message>
            <choose role="select">
             <fn name="exists">
              <varRef name="selectedRepeatVar" slot="6"/>
             </fn>
             <sequence>
              <valueOf>
               <str val="xforms:repeat ref="/>
              </valueOf>
              <varRef name="refi" slot="5"/>
              <valueOf>
               <str val=", count = "/>
              </valueOf>
              <fn name="count">
               <varRef name="selectedRepeatVar" slot="6"/>
              </fn>
             </sequence>
             <true/>
             <sequence line="1884">
              <valueOf>
               <str val="No repeatfound for ref "/>
              </valueOf>
              <varRef name="refi" slot="5"/>
              <valueOf>
               <str val=" with context "/>
              </valueOf>
              <valueOf>
               <cast as="xs:string" emptiable="0">
                <atomSing diag="2|0||cast as">
                 <varRef name="context" slot="4"/>
                </atomSing>
               </cast>
              </valueOf>
             </sequence>
            </choose>
            <str role="terminate" val="no"/>
            <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
           </message>
           <choose line="1891">
            <fn name="exists">
             <varRef name="selectedRepeatVar" slot="6"/>
            </fn>
            <let line="1901" var="vv:v0" as="element()*" slot="7" eval="4">
             <slash simple="1">
              <varRef name="context" slot="4"/>
              <axis name="child" nodeTest="element()" jsTest="return item.nodeType===1;"/>
             </slash>
             <elem line="1892" name="div" nsuri="" namespaces="rdf xhtml js in fn map array ev">
              <sequence>
               <att name="data-repeatable-context" flags="l">
                <varRef name="refi" slot="5"/>
               </att>
               <att name="data-count" flags="l">
                <convert from="xs:integer" to="xs:string">
                 <fn name="count">
                  <varRef name="selectedRepeatVar" slot="6"/>
                 </fn>
                </convert>
               </att>
               <choose line="1893">
                <fn name="exists">
                 <varRef name="refi" slot="5"/>
                </fn>
                <att line="1894" name="data-repeatable-context" flags="l">
                 <varRef name="refi" slot="5"/>
                </att>
               </choose>
               <choose line="1896">
                <fn name="exists">
                 <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
                </fn>
                <att line="1897" name="id" flags="l">
                 <convert from="xs:untypedAtomic" to="xs:string">
                  <attVal name="Q{}id" chk="0"/>
                 </convert>
                </att>
               </choose>
               <forEach line="1899">
                <varRef name="selectedRepeatVar" slot="6"/>
                <elem line="1900" name="div" nsuri="" flags="l" namespaces="rdf xhtml js in fn map array ev">
                 <sequence>
                  <att name="data-repeat-item" flags="l">
                   <str val="true"/>
                  </att>
                  <applyT line="1901" bSlot="30">
                   <varRef role="select" name="vv:v0" slot="7"/>
                   <withParam name="Q{}instance1" as="node()?">
                    <varRef line="1902" name="instance1" slot="0"/>
                   </withParam>
                   <withParam name="Q{}position" as="xs:integer">
                    <fn line="1903" name="position"/>
                   </withParam>
                   <withParam name="Q{}nodeset" as="xs:string">
                    <fn line="1905" name="concat">
                     <varRef name="refi" slot="5"/>
                     <str val="["/>
                     <fn name="position"/>
                     <str val="]"/>
                    </fn>
                   </withParam>
                   <withParam name="Q{}bindings" as="map(xs:string, node())">
                    <varRef line="1906" name="bindings" slot="1"/>
                   </withParam>
                   <withParam name="Q{}submissions" as="map(xs:string, xs:string)">
                    <varRef line="1907" name="submissions" slot="2"/>
                   </withParam>
                  </applyT>
                 </sequence>
                </elem>
               </forEach>
              </sequence>
             </elem>
            </let>
           </choose>
          </sequence>
         </let>
        </sequence>
       </choose>
      </let>
     </let>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="0" rank="1" minImp="0" slots="0" flags="s" line="1127" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}model)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='model';"/>
    <empty role="action"/>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="18" rank="1" minImp="0" slots="9" flags="s" line="2497" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}send)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='send';"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2498">
     <param name="Q{}instance1" slot="0" flags="t" as="node()?">
      <empty role="select"/>
      <treat role="conversion" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="8|0|XTTE0590|instance1">
       <check card="?" diag="8|0|XTTE0590|instance1">
        <supplied slot="0"/>
       </check>
      </treat>
     </param>
     <param line="2499" name="Q{}bindings" slot="1" flags="t" as="map(xs:string, node())">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, node())" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.isNode(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|bindings">
       <check card="1" diag="8|0|XTTE0590|bindings">
        <supplied slot="1"/>
       </check>
      </treat>
     </param>
     <param line="2500" name="Q{}submissions" slot="2" flags="t" as="map(xs:string, xs:string)">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, xs:string)" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.Atomic.string.matches(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|submissions">
       <check card="1" diag="8|0|XTTE0590|submissions">
        <supplied slot="2"/>
       </check>
      </treat>
     </param>
     <param line="2501" name="Q{}position" slot="3">
      <str role="select" val=""/>
      <supplied role="conversion" slot="3"/>
     </param>
     <param line="2502" name="Q{}nodeset" slot="4">
      <str role="select" val=""/>
      <supplied role="conversion" slot="4"/>
     </param>
     <param line="2503" name="Q{}updateMode" slot="5" flags="t">
      <false role="select"/>
      <supplied role="conversion" slot="5"/>
     </param>
     <param line="2509" name="Q{}myid" slot="6" flags="t">
      <choose role="select">
       <fn name="exists">
        <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       </fn>
       <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
       <true/>
       <fn name="concat">
        <fn name="generate-id">
         <dot type="element()"/>
        </fn>
        <atomSing card="?" diag="0|1||fn:concat">
         <varRef name="position" slot="3"/>
        </atomSing>
       </fn>
      </choose>
      <supplied role="conversion" slot="6"/>
     </param>
     <let line="2512" var="nodeseti" as="item()*" slot="7" eval="3">
      <choose>
       <gc op="=" card="N:1" comp="GAC|http://www.w3.org/2005/xpath-functions/collation/codepoint">
        <data>
         <varRef name="nodeset" slot="4"/>
        </data>
        <str val=""/>
       </gc>
       <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
       <true/>
       <varRef name="nodeset" slot="4"/>
      </choose>
      <choose line="2514">
       <fn name="not">
        <varRef name="updateMode" slot="5"/>
       </fn>
       <sequence line="2516">
        <message>
         <sequence role="select">
          <valueOf>
           <str val="xforms:setvalue found !!!! XXX, node&#xA;                        "/>
          </valueOf>
          <valueOf line="2517">
           <fn name="serialize">
            <dot type="element()"/>
           </fn>
          </valueOf>
          <valueOf>
           <str val=", id= "/>
          </valueOf>
          <valueOf line="2517">
           <convert from="xs:untypedAtomic" to="xs:string">
            <attVal name="Q{}id" chk="0"/>
           </convert>
          </valueOf>
          <valueOf>
           <str val=",&#xA;                    myid = "/>
          </valueOf>
          <valueOf line="2518">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="myid" slot="6"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
          <valueOf>
           <str val=", nodeset="/>
          </valueOf>
          <valueOf line="2519">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="nodeseti" slot="7"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
         </sequence>
         <str role="terminate" val="no"/>
         <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
        </message>
        <let line="2522" var="action-map" as="map(xs:anyAtomicType, item()*)" slot="8" eval="8">
         <ifCall line="2526" name="Q{http://www.w3.org/2005/xpath-functions/map}merge" type="map(*)">
          <sequence>
           <choose>
            <fn name="exists">
             <varRef name="nodeset" slot="4"/>
            </fn>
            <ifCall line="2527" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@ref"/>
             <cast as="xs:string" emptiable="1">
              <atomSing card="?" diag="2|0||cast as">
               <varRef name="nodeset" slot="4"/>
              </atomSing>
             </cast>
            </ifCall>
           </choose>
           <choose line="2530">
            <fn name="exists">
             <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
            </fn>
            <ifCall line="2531" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@event"/>
             <cast as="xs:string" emptiable="1">
              <atomSing card="?" diag="2|0||cast as">
               <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
              </atomSing>
             </cast>
            </ifCall>
           </choose>
           <choose line="2534">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
            </fn>
            <ifCall line="2535" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@position"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2537">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
            </fn>
            <ifCall line="2538" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@at"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2540">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
            </fn>
            <ifCall line="2541" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@if"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
             </fn>
            </ifCall>
           </choose>
           <choose line="2543">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
            </fn>
            <ifCall line="2544" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
             <str val="@while"/>
             <fn name="string">
              <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
             </fn>
            </ifCall>
           </choose>
           <treat line="2547" as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="18|0|XTTE3375|">
            <forEachGroup algorithm="by">
             <dot role="select" type="element()"/>
             <fn role="key" name="local-name">
              <dot type="element()"/>
             </fn>
             <str role="collation" val="http://www.w3.org/2005/xpath-functions/collation/codepoint"/>
             <applyT role="content" line="2548" mode="Q{}xforms-action-map" bSlot="1">
              <dot role="select" type="element()"/>
              <withParam name="Q{}nodeset">
               <varRef line="2549" name="nodeset" slot="4"/>
              </withParam>
             </applyT>
            </forEachGroup>
           </treat>
          </sequence>
          <map size="2">
           <str val="duplicates"/>
           <str val="reject"/>
           <str val="duplicates-error-code"/>
           <str val="XTDE3365"/>
          </map>
         </ifCall>
         <sequence line="2562">
          <message>
           <sequence role="select">
            <valueOf>
             <str val="xforms:setvalue found !!!! XXX, node&#xA;                    "/>
            </valueOf>
            <valueOf line="2563">
             <fn name="serialize">
              <dot type="element()"/>
             </fn>
            </valueOf>
            <valueOf>
             <str val=", id= "/>
            </valueOf>
            <valueOf line="2563">
             <convert from="xs:untypedAtomic" to="xs:string">
              <attVal name="Q{}id" chk="0"/>
             </convert>
            </valueOf>
            <valueOf>
             <str val=",&#xA;                    myid = "/>
            </valueOf>
            <valueOf line="2564">
             <fn name="string-join">
              <convert from="xs:anyAtomicType" to="xs:string">
               <data>
                <mergeAdj>
                 <varRef name="myid" slot="6"/>
                </mergeAdj>
               </data>
              </convert>
              <str val=" "/>
             </fn>
            </valueOf>
            <valueOf>
             <str val=", nodeset="/>
            </valueOf>
            <valueOf line="2565">
             <fn name="string-join">
              <convert from="xs:anyAtomicType" to="xs:string">
               <data>
                <mergeAdj>
                 <varRef name="nodeseti" slot="7"/>
                </mergeAdj>
               </data>
              </convert>
              <str val=" "/>
             </fn>
            </valueOf>
            <valueOf>
             <str val="&#xA;                    action xml "/>
            </valueOf>
            <valueOf line="2566">
             <fn name="serialize">
              <varRef name="action-map" slot="8"/>
              <map size="1">
               <str val="method"/>
               <str val="json"/>
              </map>
             </fn>
            </valueOf>
           </sequence>
           <str role="terminate" val="no"/>
           <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
          </message>
          <varRef line="2590" name="action-map" slot="8"/>
         </sequence>
        </let>
       </sequence>
      </choose>
     </let>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="-0.5" seq="9" rank="0" minImp="0" slots="4" flags="s" line="1733" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="attribute()" jsTest="return SaxonJS.U.isAttr(item)"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="1734">
     <param name="Q{}instance1" slot="0" flags="t" as="node()?">
      <empty role="select"/>
      <treat role="conversion" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="8|0|XTTE0590|instance1">
       <check card="?" diag="8|0|XTTE0590|instance1">
        <supplied slot="0"/>
       </check>
      </treat>
     </param>
     <param line="1735" name="Q{}bindings" slot="1" flags="t" as="map(xs:string, node())">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, node())" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.isNode(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|bindings">
       <check card="1" diag="8|0|XTTE0590|bindings">
        <supplied slot="1"/>
       </check>
      </treat>
     </param>
     <param line="1736" name="Q{}submissions" slot="2" flags="t" as="map(xs:string, xs:string)">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, xs:string)" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.Atomic.string.matches(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|submissions">
       <check card="1" diag="8|0|XTTE0590|submissions">
        <supplied slot="2"/>
       </check>
      </treat>
     </param>
     <param line="1738" name="Q{}nodeset" slot="3" as="xs:string">
      <str role="select" val=""/>
      <treat role="conversion" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="8|0|XTTE0590|nodeset">
       <check card="1" diag="8|0|XTTE0590|nodeset">
        <cvUntyped to="xs:string">
         <data>
          <supplied slot="3"/>
         </data>
        </cvUntyped>
       </check>
      </treat>
     </param>
     <copy line="1740" flags="cin">
      <sequence role="content">
       <applyT bSlot="31">
        <axis role="select" name="attribute" nodeTest="attribute()" jsTest="return SaxonJS.U.isAttr(item)"/>
       </applyT>
       <applyT line="1741" bSlot="32">
        <axis role="select" name="child" nodeTest="( element() | text() | comment() | processing-instruction() )" jsTest="return SaxonJS.U.isNode(item) &amp;&amp; (item.nodeType===1 || item.nodeType===3 || item.nodeType===7 || item.nodeType===8);"/>
        <withParam name="Q{}instance1" as="node()?">
         <varRef line="1742" name="instance1" slot="0"/>
        </withParam>
        <withParam name="Q{}bindings" as="map(xs:string, node())">
         <varRef line="1743" name="bindings" slot="1"/>
        </withParam>
        <withParam name="Q{}submissions" as="map(xs:string, xs:string)">
         <varRef line="1745" name="submissions" slot="2"/>
        </withParam>
        <withParam name="Q{}nodeset" as="xs:string">
         <varRef line="1746" name="nodeset" slot="3"/>
        </withParam>
       </applyT>
      </sequence>
     </copy>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="0.5" seq="10" rank="2" minImp="0" slots="0" flags="s" line="1754" module="saxon-xforms.xsl">
    <p.withPredicate role="match">
     <p.nodeTest test="text()" jsTest="return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===3;"/>
     <axis ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="1754" name="ancestor" nodeTest="element(Q{http://www.w3.org/2002/xforms}model)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='model';"/>
    </p.withPredicate>
    <empty role="action"/>
   </templateRule>
   <templateRule prec="0" prio="-0.5" seq="9" rank="0" minImp="0" slots="4" flags="s" line="1733" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="( element() | text() | comment() | processing-instruction() )" jsTest="return SaxonJS.U.isNode(item) &amp;&amp; (item.nodeType===1 || item.nodeType===3 || item.nodeType===7 || item.nodeType===8);"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="1734">
     <param name="Q{}instance1" slot="0" flags="t" as="node()?">
      <empty role="select"/>
      <treat role="conversion" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="8|0|XTTE0590|instance1">
       <check card="?" diag="8|0|XTTE0590|instance1">
        <supplied slot="0"/>
       </check>
      </treat>
     </param>
     <param line="1735" name="Q{}bindings" slot="1" flags="t" as="map(xs:string, node())">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, node())" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.isNode(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|bindings">
       <check card="1" diag="8|0|XTTE0590|bindings">
        <supplied slot="1"/>
       </check>
      </treat>
     </param>
     <param line="1736" name="Q{}submissions" slot="2" flags="t" as="map(xs:string, xs:string)">
      <map role="select" size="0"/>
      <treat role="conversion" as="map(xs:string, xs:string)" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.Atomic.string.matches(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|submissions">
       <check card="1" diag="8|0|XTTE0590|submissions">
        <supplied slot="2"/>
       </check>
      </treat>
     </param>
     <param line="1738" name="Q{}nodeset" slot="3" as="xs:string">
      <str role="select" val=""/>
      <treat role="conversion" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="8|0|XTTE0590|nodeset">
       <check card="1" diag="8|0|XTTE0590|nodeset">
        <cvUntyped to="xs:string">
         <data>
          <supplied slot="3"/>
         </data>
        </cvUntyped>
       </check>
      </treat>
     </param>
     <copy line="1740" flags="cin">
      <sequence role="content">
       <applyT bSlot="31">
        <axis role="select" name="attribute" nodeTest="attribute()" jsTest="return SaxonJS.U.isAttr(item)"/>
       </applyT>
       <applyT line="1741" bSlot="32">
        <axis role="select" name="child" nodeTest="( element() | text() | comment() | processing-instruction() )" jsTest="return SaxonJS.U.isNode(item) &amp;&amp; (item.nodeType===1 || item.nodeType===3 || item.nodeType===7 || item.nodeType===8);"/>
        <withParam name="Q{}instance1" as="node()?">
         <varRef line="1742" name="instance1" slot="0"/>
        </withParam>
        <withParam name="Q{}bindings" as="map(xs:string, node())">
         <varRef line="1743" name="bindings" slot="1"/>
        </withParam>
        <withParam name="Q{}submissions" as="map(xs:string, xs:string)">
         <varRef line="1745" name="submissions" slot="2"/>
        </withParam>
        <withParam name="Q{}nodeset" as="xs:string">
         <varRef line="1746" name="nodeset" slot="3"/>
        </withParam>
       </applyT>
      </sequence>
     </copy>
    </sequence>
   </templateRule>
  </mode>
 </co>
 <co id="32" binds="">
  <template name="Q{}getDataRef" flags="os" line="3345" module="saxon-xforms.xsl" slots="3">
   <sequence role="body" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="3346">
    <param name="Q{}this" slot="0" flags="r" as="element()">
     <treat role="conversion" as="element()" jsTest="return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1;" diag="8|0|XTTE0590|this">
      <check card="1" diag="8|0|XTTE0590|this">
       <supplied slot="0"/>
      </check>
     </treat>
    </param>
    <param line="3347" name="Q{}nodeset" slot="1" as="xs:string">
     <str role="select" val=""/>
     <treat role="conversion" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="8|0|XTTE0590|nodeset">
      <check card="1" diag="8|0|XTTE0590|nodeset">
       <cvUntyped to="xs:string">
        <data>
         <supplied slot="1"/>
        </data>
       </cvUntyped>
      </check>
     </treat>
    </param>
    <param line="3348" name="Q{}bindingi" slot="2" as="node()?">
     <empty role="select"/>
     <treat role="conversion" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="8|0|XTTE0590|bindingi">
      <check card="?" diag="8|0|XTTE0590|bindingi">
       <supplied slot="2"/>
      </check>
     </treat>
    </param>
    <choose line="3351">
     <fn name="exists">
      <slash simple="1">
       <varRef name="this" slot="0"/>
       <axis name="attribute" nodeTest="attribute(Q{}ref)" jsTest="return item.name==='ref'"/>
      </slash>
     </fn>
     <valueOf line="3358">
      <choose>
       <fn name="not">
        <varRef name="nodeset" slot="1"/>
       </fn>
       <fn name="concat">
        <varRef name="nodeset" slot="1"/>
        <data>
         <slash simple="1">
          <varRef name="this" slot="0"/>
          <axis name="attribute" nodeTest="attribute(Q{}ref)" jsTest="return item.name==='ref'"/>
         </slash>
        </data>
       </fn>
       <true/>
       <fn name="concat">
        <varRef name="nodeset" slot="1"/>
        <str val="/"/>
        <data>
         <slash simple="1">
          <varRef name="this" slot="0"/>
          <axis name="attribute" nodeTest="attribute(Q{}ref)" jsTest="return item.name==='ref'"/>
         </slash>
        </data>
       </fn>
      </choose>
     </valueOf>
     <fn line="3360" name="exists">
      <varRef name="bindingi" slot="2"/>
     </fn>
     <valueOf line="3367">
      <fn name="string-join">
       <convert from="xs:anyAtomicType" to="xs:string">
        <choose>
         <fn name="exists">
          <slash simple="1">
           <varRef name="bindingi" slot="2"/>
           <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
          </slash>
         </fn>
         <data>
          <slash simple="1">
           <varRef name="bindingi" slot="2"/>
           <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
          </slash>
         </data>
         <true/>
         <data>
          <slash simple="1">
           <varRef name="bindingi" slot="2"/>
           <axis name="attribute" nodeTest="attribute(Q{}ref)" jsTest="return item.name==='ref'"/>
          </slash>
         </data>
        </choose>
       </convert>
       <str val=" "/>
      </fn>
     </valueOf>
     <true/>
     <valueOf line="3370" flags="S">
      <str val=""/>
     </valueOf>
    </choose>
   </sequence>
  </template>
 </co>
 <co id="33" binds="">
  <mode name="Q{}xforms-action" onNo="TC" flags="W" patternSlots="0">
   <templateRule prec="0" prio="0.0" seq="0" rank="0" minImp="0" slots="1" flags="s" line="2596" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}insert)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='insert';"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2597">
     <param name="Q{}nodeset" slot="0">
      <str role="select" val=""/>
      <supplied role="conversion" slot="0"/>
     </param>
     <elem line="2599" name="insert" nsuri="" namespaces="rdf xhtml js in fn map array ev">
      <sequence>
       <choose>
        <fn name="exists">
         <axis name="attribute" nodeTest="attribute(Q{}ref)" jsTest="return item.name==='ref'"/>
        </fn>
        <elem line="2602" name="ref" nsuri="" flags="l">
         <choose>
          <gc op="=" card="1:1" comp="CCC">
           <attVal name="Q{}nodeset" chk="0"/>
           <str val="."/>
          </gc>
          <valueOf line="2603" flags="l">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="nodeset" slot="0"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
          <true/>
          <valueOf line="2606" flags="l">
           <convert from="xs:untypedAtomic" to="xs:string">
            <attVal name="Q{}ref" chk="0"/>
           </convert>
          </valueOf>
         </choose>
        </elem>
       </choose>
       <choose line="2611">
        <fn name="exists">
         <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
        </fn>
        <elem line="2614" name="ref" nsuri="" flags="l">
         <choose>
          <gc op="=" card="1:1" comp="CCC">
           <attVal name="Q{}nodeset" chk="0"/>
           <str val="."/>
          </gc>
          <valueOf line="2615" flags="l">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="nodeset" slot="0"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
          <true/>
          <valueOf line="2618" flags="l">
           <convert from="xs:untypedAtomic" to="xs:string">
            <attVal name="Q{}nodeset" chk="0"/>
           </convert>
          </valueOf>
         </choose>
        </elem>
       </choose>
       <choose line="2624">
        <fn name="exists">
         <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
        </fn>
        <elem line="2626" name="position" nsuri="" flags="l">
         <valueOf flags="l">
          <convert from="xs:untypedAtomic" to="xs:string">
           <attVal name="Q{}position" chk="0"/>
          </convert>
         </valueOf>
        </elem>
       </choose>
       <choose line="2629">
        <fn name="exists">
         <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
        </fn>
        <elem line="2631" name="at" nsuri="" flags="l">
         <valueOf flags="l">
          <convert from="xs:untypedAtomic" to="xs:string">
           <attVal name="Q{}at" chk="0"/>
          </convert>
         </valueOf>
        </elem>
       </choose>
       <choose line="2634">
        <fn name="exists">
         <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
        </fn>
        <elem line="2636" name="if" nsuri="" flags="l">
         <valueOf flags="l">
          <convert from="xs:untypedAtomic" to="xs:string">
           <attVal name="Q{}if" chk="0"/>
          </convert>
         </valueOf>
        </elem>
       </choose>
       <choose line="2639">
        <fn name="exists">
         <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
        </fn>
        <elem line="2641" name="while" nsuri="" flags="l">
         <valueOf flags="l">
          <convert from="xs:untypedAtomic" to="xs:string">
           <attVal name="Q{}while" chk="0"/>
          </convert>
         </valueOf>
        </elem>
       </choose>
      </sequence>
     </elem>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="3" rank="0" minImp="0" slots="1" flags="s" line="2763" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}reset)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='reset';"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2764">
     <param name="Q{}nodeset" slot="0">
      <str role="select" val=""/>
      <supplied role="conversion" slot="0"/>
     </param>
     <elem line="2766" name="reset" nsuri="" namespaces="rdf xhtml js in fn map array ev">
      <sequence>
       <choose>
        <fn name="exists">
         <axis name="attribute" nodeTest="attribute(Q{}ref)" jsTest="return item.name==='ref'"/>
        </fn>
        <elem line="2769" name="ref" nsuri="" flags="l">
         <choose>
          <gc op="=" card="1:1" comp="CCC">
           <attVal name="Q{}nodeset" chk="0"/>
           <str val="."/>
          </gc>
          <valueOf line="2770" flags="l">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="nodeset" slot="0"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
          <true/>
          <valueOf line="2773" flags="l">
           <convert from="xs:untypedAtomic" to="xs:string">
            <attVal name="Q{}ref" chk="0"/>
           </convert>
          </valueOf>
         </choose>
        </elem>
       </choose>
       <choose line="2778">
        <fn name="exists">
         <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
        </fn>
        <elem line="2781" name="ref" nsuri="" flags="l">
         <choose>
          <gc op="=" card="1:1" comp="CCC">
           <attVal name="Q{}nodeset" chk="0"/>
           <str val="."/>
          </gc>
          <valueOf line="2782" flags="l">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="nodeset" slot="0"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
          <true/>
          <valueOf line="2785" flags="l">
           <convert from="xs:untypedAtomic" to="xs:string">
            <attVal name="Q{}nodeset" chk="0"/>
           </convert>
          </valueOf>
         </choose>
        </elem>
       </choose>
       <choose line="2791">
        <fn name="exists">
         <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
        </fn>
        <elem line="2793" name="position" nsuri="" flags="l">
         <valueOf flags="l">
          <convert from="xs:untypedAtomic" to="xs:string">
           <attVal name="Q{}position" chk="0"/>
          </convert>
         </valueOf>
        </elem>
       </choose>
       <choose line="2796">
        <fn name="exists">
         <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
        </fn>
        <elem line="2798" name="at" nsuri="" flags="l">
         <valueOf flags="l">
          <convert from="xs:untypedAtomic" to="xs:string">
           <attVal name="Q{}at" chk="0"/>
          </convert>
         </valueOf>
        </elem>
       </choose>
       <choose line="2801">
        <fn name="exists">
         <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
        </fn>
        <elem line="2803" name="if" nsuri="" flags="l">
         <valueOf flags="l">
          <convert from="xs:untypedAtomic" to="xs:string">
           <attVal name="Q{}if" chk="0"/>
          </convert>
         </valueOf>
        </elem>
       </choose>
       <choose line="2806">
        <fn name="exists">
         <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
        </fn>
        <elem line="2808" name="while" nsuri="" flags="l">
         <valueOf flags="l">
          <convert from="xs:untypedAtomic" to="xs:string">
           <attVal name="Q{}while" chk="0"/>
          </convert>
         </valueOf>
        </elem>
       </choose>
       <choose line="2811">
        <fn name="exists">
         <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
        </fn>
        <elem line="2813" name="event" nsuri="" flags="l">
         <valueOf flags="l">
          <fn name="string-join">
           <convert from="xs:untypedAtomic" to="xs:string">
            <data>
             <axis name="attribute" nodeTest="@*:event" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===2&amp;&amp;q.local==='event'"/>
            </data>
           </convert>
           <str val=" "/>
          </fn>
         </valueOf>
        </elem>
       </choose>
      </sequence>
     </elem>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="2" rank="0" minImp="0" slots="1" flags="s" line="2698" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}setvalue)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='setvalue';"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2699">
     <param name="Q{}nodeset" slot="0">
      <str role="select" val=""/>
      <supplied role="conversion" slot="0"/>
     </param>
     <message line="2700">
      <sequence role="select">
       <valueOf>
        <str val="setvalue ZZZ= "/>
       </valueOf>
       <valueOf line="2701">
        <fn name="serialize">
         <dot type="element(Q{http://www.w3.org/2002/xforms}setvalue)"/>
        </fn>
       </valueOf>
      </sequence>
      <str role="terminate" val="no"/>
      <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
     </message>
     <elem line="2703" name="setvalue" nsuri="" namespaces="rdf xhtml js in fn map array ev">
      <sequence>
       <choose>
        <fn name="exists">
         <axis name="attribute" nodeTest="attribute(Q{}value)" jsTest="return item.name==='value'"/>
        </fn>
        <att line="2705" name="value" flags="l">
         <convert from="xs:untypedAtomic" to="xs:string">
          <cast as="xs:untypedAtomic" emptiable="0">
           <fn name="string">
            <convert from="xs:untypedAtomic" to="xs:string">
             <attVal name="Q{}value" chk="0"/>
            </convert>
           </fn>
          </cast>
         </convert>
        </att>
       </choose>
       <choose line="2708">
        <fn name="exists">
         <axis name="attribute" nodeTest="attribute(Q{}ref)" jsTest="return item.name==='ref'"/>
        </fn>
        <elem line="2711" name="ref" nsuri="" flags="l">
         <choose>
          <gc op="=" card="1:1" comp="CCC">
           <attVal name="Q{}nodeset" chk="0"/>
           <str val="."/>
          </gc>
          <valueOf line="2712" flags="l">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="nodeset" slot="0"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
          <true/>
          <valueOf line="2715" flags="l">
           <convert from="xs:untypedAtomic" to="xs:string">
            <attVal name="Q{}ref" chk="0"/>
           </convert>
          </valueOf>
         </choose>
        </elem>
       </choose>
       <choose line="2720">
        <fn name="exists">
         <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
        </fn>
        <elem line="2723" name="ref" nsuri="" flags="l">
         <choose>
          <gc op="=" card="1:1" comp="CCC">
           <attVal name="Q{}nodeset" chk="0"/>
           <str val="."/>
          </gc>
          <valueOf line="2724" flags="l">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="nodeset" slot="0"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
          <true/>
          <valueOf line="2727" flags="l">
           <convert from="xs:untypedAtomic" to="xs:string">
            <attVal name="Q{}nodeset" chk="0"/>
           </convert>
          </valueOf>
         </choose>
        </elem>
       </choose>
       <choose line="2733">
        <fn name="exists">
         <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
        </fn>
        <elem line="2735" name="position" nsuri="" flags="l">
         <valueOf flags="l">
          <convert from="xs:untypedAtomic" to="xs:string">
           <attVal name="Q{}position" chk="0"/>
          </convert>
         </valueOf>
        </elem>
       </choose>
       <choose line="2738">
        <fn name="exists">
         <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
        </fn>
        <elem line="2740" name="at" nsuri="" flags="l">
         <valueOf flags="l">
          <convert from="xs:untypedAtomic" to="xs:string">
           <attVal name="Q{}at" chk="0"/>
          </convert>
         </valueOf>
        </elem>
       </choose>
       <choose line="2743">
        <fn name="exists">
         <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
        </fn>
        <elem line="2745" name="if" nsuri="" flags="l">
         <valueOf flags="l">
          <convert from="xs:untypedAtomic" to="xs:string">
           <attVal name="Q{}if" chk="0"/>
          </convert>
         </valueOf>
        </elem>
       </choose>
       <choose line="2748">
        <fn name="exists">
         <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
        </fn>
        <elem line="2750" name="while" nsuri="" flags="l">
         <valueOf flags="l">
          <convert from="xs:untypedAtomic" to="xs:string">
           <attVal name="Q{}while" chk="0"/>
          </convert>
         </valueOf>
        </elem>
       </choose>
       <choose line="2754">
        <fn name="exists">
         <axis name="child" nodeTest="text()" jsTest="return item.nodeType===3;"/>
        </fn>
        <elem line="2756" name="value" nsuri="" flags="l">
         <valueOf flags="l">
          <convert from="xs:untypedAtomic" to="xs:string">
           <data>
            <dot type="element(Q{http://www.w3.org/2002/xforms}setvalue)"/>
           </data>
          </convert>
         </valueOf>
        </elem>
       </choose>
      </sequence>
     </elem>
    </sequence>
   </templateRule>
   <templateRule prec="0" prio="0.0" seq="1" rank="0" minImp="0" slots="1" flags="s" line="2647" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element(Q{http://www.w3.org/2002/xforms}delete)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='delete';"/>
    <sequence role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2648">
     <param name="Q{}nodeset" slot="0">
      <str role="select" val=""/>
      <supplied role="conversion" slot="0"/>
     </param>
     <elem line="2650" name="delete" nsuri="" namespaces="rdf xhtml js in fn map array ev">
      <sequence>
       <choose>
        <fn name="exists">
         <axis name="attribute" nodeTest="attribute(Q{}ref)" jsTest="return item.name==='ref'"/>
        </fn>
        <elem line="2653" name="ref" nsuri="" flags="l">
         <choose>
          <gc op="=" card="1:1" comp="CCC">
           <attVal name="Q{}nodeset" chk="0"/>
           <str val="."/>
          </gc>
          <valueOf line="2654" flags="l">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="nodeset" slot="0"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
          <true/>
          <valueOf line="2657" flags="l">
           <convert from="xs:untypedAtomic" to="xs:string">
            <attVal name="Q{}ref" chk="0"/>
           </convert>
          </valueOf>
         </choose>
        </elem>
       </choose>
       <choose line="2662">
        <fn name="exists">
         <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
        </fn>
        <elem line="2665" name="ref" nsuri="" flags="l">
         <choose>
          <gc op="=" card="1:1" comp="CCC">
           <attVal name="Q{}nodeset" chk="0"/>
           <str val="."/>
          </gc>
          <valueOf line="2666" flags="l">
           <fn name="string-join">
            <convert from="xs:anyAtomicType" to="xs:string">
             <data>
              <mergeAdj>
               <varRef name="nodeset" slot="0"/>
              </mergeAdj>
             </data>
            </convert>
            <str val=" "/>
           </fn>
          </valueOf>
          <true/>
          <valueOf line="2669" flags="l">
           <convert from="xs:untypedAtomic" to="xs:string">
            <attVal name="Q{}nodeset" chk="0"/>
           </convert>
          </valueOf>
         </choose>
        </elem>
       </choose>
       <choose line="2675">
        <fn name="exists">
         <axis name="attribute" nodeTest="attribute(Q{}position)" jsTest="return item.name==='position'"/>
        </fn>
        <elem line="2677" name="position" nsuri="" flags="l">
         <valueOf flags="l">
          <convert from="xs:untypedAtomic" to="xs:string">
           <attVal name="Q{}position" chk="0"/>
          </convert>
         </valueOf>
        </elem>
       </choose>
       <choose line="2680">
        <fn name="exists">
         <axis name="attribute" nodeTest="attribute(Q{}at)" jsTest="return item.name==='at'"/>
        </fn>
        <elem line="2682" name="at" nsuri="" flags="l">
         <valueOf flags="l">
          <convert from="xs:untypedAtomic" to="xs:string">
           <attVal name="Q{}at" chk="0"/>
          </convert>
         </valueOf>
        </elem>
       </choose>
       <choose line="2685">
        <fn name="exists">
         <axis name="attribute" nodeTest="attribute(Q{}if)" jsTest="return item.name==='if'"/>
        </fn>
        <elem line="2687" name="if" nsuri="" flags="l">
         <valueOf flags="l">
          <convert from="xs:untypedAtomic" to="xs:string">
           <attVal name="Q{}if" chk="0"/>
          </convert>
         </valueOf>
        </elem>
       </choose>
       <choose line="2690">
        <fn name="exists">
         <axis name="attribute" nodeTest="attribute(Q{}while)" jsTest="return item.name==='while'"/>
        </fn>
        <elem line="2692" name="while" nsuri="" flags="l">
         <valueOf flags="l">
          <convert from="xs:untypedAtomic" to="xs:string">
           <attVal name="Q{}while" chk="0"/>
          </convert>
         </valueOf>
        </elem>
       </choose>
      </sequence>
     </elem>
    </sequence>
   </templateRule>
  </mode>
 </co>
 <co id="34" binds="1">
  <function name="Q{http://www.w3.org/2002/xforms}setInstance-JS" line="3284" module="saxon-xforms.xsl" eval="7" flags="pU" as="empty-sequence()" slots="2">
   <arg name="ref" as="xs:string"/>
   <arg name="updatedInstanceDoc" as="document-node()"/>
   <check role="body" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="3290" card="°" diag="5|0|XTTE0780|xforms:setInstance-JS">
    <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
     <check card="1" diag="0|0||ixsl:call">
      <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
     </check>
     <str val="setInstance"/>
     <arrayBlock>
      <check line="3288" card="1" diag="3|0|XTTE0570|this-instance-id">
       <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
        <ufCall name="Q{http://www.w3.org/2002/xforms}getInstanceMap" tailCall="false" bSlot="0" eval="6">
         <varRef name="ref" slot="0"/>
        </ufCall>
        <str val="instance-id"/>
       </ifCall>
      </check>
      <check line="3287" card="1" diag="3|0|XTTE0570|updatedInstance">
       <slash simple="1">
        <varRef name="updatedInstanceDoc" slot="1"/>
        <axis name="child" nodeTest="element()" jsTest="return item.nodeType===1;"/>
       </slash>
      </check>
     </arrayBlock>
    </ifCall>
   </check>
  </function>
 </co>
 <co id="35" binds="36 1">
  <function name="Q{http://www.w3.org/2002/xforms}getInstance-JS" line="3277" module="saxon-xforms.xsl" eval="7" flags="pU" as="document-node()" slots="1">
   <arg name="ref" as="xs:string"/>
   <tailCallLoop role="body" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="3281">
    <ufCall name="Q{http://www.w3.org/2002/xforms}instance" tailCall="foreign" bSlot="0" eval="7">
     <check line="3279" card="1" diag="3|0|XTTE0570|this-instance-id">
      <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
       <ufCall name="Q{http://www.w3.org/2002/xforms}getInstanceMap" tailCall="false" bSlot="1" eval="6">
        <varRef name="ref" slot="0"/>
       </ufCall>
       <str val="instance-id"/>
      </ifCall>
     </check>
    </ufCall>
   </tailCallLoop>
  </function>
 </co>
 <co id="1" binds="">
  <function name="Q{http://www.w3.org/2002/xforms}getInstanceMap" line="3256" module="saxon-xforms.xsl" eval="8" flags="pU" as="map(xs:string, xs:string)" slots="2">
   <arg name="nodeset" as="xs:string"/>
   <let role="body" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="3267" var="vv:v0" as="map(xs:string, xs:string)+" slot="1" eval="4">
    <sequence>
     <map size="1">
      <str val="instance-id"/>
      <str val="saxon-forms-default"/>
     </map>
     <ifCall line="3268" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
      <str val="xpath"/>
      <fn name="normalize-space">
       <varRef name="nodeset" slot="0"/>
      </fn>
     </ifCall>
    </sequence>
    <ifCall line="3261" name="Q{http://www.w3.org/2005/xpath-functions/map}merge" type="map(*)">
     <analyzeString>
      <fn role="select" name="normalize-space">
       <varRef name="nodeset" slot="0"/>
      </fn>
      <str role="regex" val="^instance\s*\(\s*'(.*)'\s*\)\s*/\s*(.*)$"/>
      <str role="flags" val=""/>
      <sequence role="matching" line="3263">
       <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
        <str val="instance-id"/>
        <fn name="regex-group">
         <int val="1"/>
        </fn>
       </ifCall>
       <ifCall line="3264" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
        <str val="xpath"/>
        <fn name="regex-group">
         <int val="2"/>
        </fn>
       </ifCall>
      </sequence>
      <varRef role="nonMatching" line="3267" name="vv:v0" slot="1"/>
     </analyzeString>
     <map size="2">
      <str val="duplicates"/>
      <str val="reject"/>
      <str val="duplicates-error-code"/>
      <str val="XTDE3365"/>
     </map>
    </ifCall>
   </let>
  </function>
 </co>
 <co id="37" binds="">
  <globalVariable name="Q{}debugMode" type="xs:boolean" line="30" module="saxon-xforms.xsl" visibility="PRIVATE" jsAcceptor="return SaxonJS.U.Atomic.boolean.cast(val);" jsCardCheck="function c(n) {return n==1;};">
   <true/>
  </globalVariable>
 </co>
 <co id="38" binds="">
  <function name="Q{http://www.w3.org/2002/xforms}getWhileStatement" line="682" module="saxon-xforms.xsl" eval="7" flags="pU" as="xs:string?" slots="3">
   <arg name="map" as="map(*)"/>
   <choose role="body" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="685">
    <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}contains" type="xs:boolean">
     <varRef name="map" slot="0"/>
     <str val="@while"/>
    </ifCall>
    <treat line="686" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="5|0|XTTE0780|xforms:getWhileStatement">
     <check card="?" diag="5|0|XTTE0780|xforms:getWhileStatement">
      <cvUntyped to="xs:string">
       <data>
        <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
         <varRef name="map" slot="0"/>
         <str val="@while"/>
        </ifCall>
       </data>
      </cvUntyped>
     </check>
    </treat>
    <true/>
    <treat line="689" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="5|0|XTTE0780|xforms:getWhileStatement">
     <check card="?" diag="5|0|XTTE0780|xforms:getWhileStatement">
      <cvUntyped to="xs:string">
       <data>
        <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
         <treat as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="0|0||map:get">
          <check card="1" diag="0|0||map:get">
           <let var="vv:LHS1701603542" as="map(*)" slot="1" eval="1">
            <varRef name="map" slot="0"/>
            <for var="vv:STAR544143903" as="xs:anyAtomicType" slot="2">
             <ifCall role="in" name="Q{http://www.w3.org/2005/xpath-functions/map}keys" type="xs:anyAtomicType*">
              <varRef name="vv:LHS1701603542" slot="1"/>
             </ifCall>
             <ifCall role="return" name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
              <varRef name="vv:LHS1701603542" slot="1"/>
              <varRef name="vv:STAR544143903" slot="2"/>
             </ifCall>
            </for>
           </let>
          </check>
         </treat>
         <str val="@while"/>
        </ifCall>
       </data>
      </cvUntyped>
     </check>
    </treat>
   </choose>
  </function>
 </co>
 <co id="39" binds="">
  <template name="Q{}serverError" flags="os" line="1122" module="saxon-xforms.xsl" slots="1">
   <sequence role="body" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="1123">
    <param name="Q{}responseMap" slot="0" flags="i" as="map(*)">
     <treat role="conversion" as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="8|0|XTTE0590|responseMap">
      <check card="1" diag="8|0|XTTE0590|responseMap">
       <supplied slot="0"/>
      </check>
     </treat>
    </param>
    <message line="1124">
     <sequence role="select">
      <valueOf>
       <str val="Server side error HTTP response - "/>
      </valueOf>
      <valueOf>
       <fn name="concat">
        <atomSing card="?" diag="0|0||fn:concat">
         <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
          <varRef name="responseMap" slot="0"/>
          <str val="status"/>
         </ifCall>
        </atomSing>
        <str val=" "/>
        <atomSing card="?" diag="0|2||fn:concat">
         <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
          <varRef name="responseMap" slot="0"/>
          <str val="message"/>
         </ifCall>
        </atomSing>
       </fn>
      </valueOf>
     </sequence>
     <str role="terminate" val="no"/>
     <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
    </message>
   </sequence>
  </template>
 </co>
 <co id="40" binds="41">
  <function name="Q{http://www.w3.org/2002/xforms}convert-xml-to-jxml" line="2883" module="saxon-xforms.xsl" eval="7" flags="pU" as="node()" slots="2">
   <arg name="xinstance" as="node()"/>
   <let role="body" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2885" var="rep-xml" as="document-node()" slot="1" eval="7">
    <doc line="2887" validation="preserve">
     <elem name="map" nsuri="http://www.w3.org/2005/xpath-functions" flags="dl">
      <applyT mode="Q{}json-xml" bSlot="0">
       <varRef role="select" name="xinstance" slot="0"/>
      </applyT>
     </elem>
    </doc>
    <varRef line="2890" name="rep-xml" slot="1"/>
   </let>
  </function>
 </co>
 <co id="42" binds="">
  <function name="Q{http://www.w3.org/2002/xforms}check-constraints-on-fields" line="969" module="saxon-xforms.xsl" eval="8" flags="pU" as="item()*" slots="4">
   <arg name="updatedInstanceXML" as="document-node()"/>
   <let role="body" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="972" var="constraint-fieldsi" as="element()*" slot="1" eval="8">
    <filter flags="b">
     <slash simple="1">
      <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}page" type="document-node()?"/>
      <axis name="descendant" nodeTest="element()" jsTest="return item.nodeType===1;"/>
     </slash>
     <fn name="exists">
      <axis name="attribute" nodeTest="attribute(Q{}data-constraint)" jsTest="return item.name==='data-constraint'"/>
     </fn>
    </filter>
    <forEach line="976">
     <varRef name="constraint-fieldsi" slot="1"/>
     <let line="977" var="contexti" as="node()" slot="2" eval="7">
      <treat line="978" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="3|0|XTTE0570|contexti">
       <check card="1" diag="3|0|XTTE0570|contexti">
        <evaluate dxns="">
         <check role="xpath" card="1" diag="4|0||xsl:evaluate/xpath">
          <cvUntyped to="xs:string">
           <attVal name="Q{}data-ref" chk="0"/>
          </cvUntyped>
         </check>
         <varRef role="cxt" name="updatedInstanceXML" slot="0"/>
         <str role="sa" val="no"/>
         <map role="wp" size="0"/>
        </evaluate>
       </check>
      </treat>
      <let line="981" var="resulti" as="xs:boolean" slot="3" eval="7">
       <treat line="984" as="xs:boolean" jsTest="return SaxonJS.U.Atomic.boolean.matches(item);" diag="3|0|XTTE0570|resulti">
        <check card="1" diag="3|0|XTTE0570|resulti">
         <cvUntyped to="xs:boolean">
          <data>
           <evaluate dxns="">
            <check role="xpath" card="1" diag="4|0||xsl:evaluate/xpath">
             <cvUntyped to="xs:string">
              <attVal name="Q{}data-constraint" chk="0"/>
             </cvUntyped>
            </check>
            <varRef role="cxt" name="contexti" slot="2"/>
            <str role="sa" val="no"/>
            <map role="wp" size="0"/>
           </evaluate>
          </data>
         </cvUntyped>
        </check>
       </treat>
       <choose line="992">
        <fn name="not">
         <varRef name="resulti" slot="3"/>
        </fn>
        <dot type="element()"/>
       </choose>
      </let>
     </let>
    </forEach>
   </let>
  </function>
 </co>
 <co id="43" binds="4 35 34 18 9 9 21 4 34 35 19 4 35 34 9 9 21 4 34 19">
  <mode name="Q{http://saxonica.com/ns/interactiveXSLT}onchange" onNo="TC" flags="W" patternSlots="0">
   <templateRule prec="0" prio="0.5" seq="0" rank="0" minImp="0" slots="20" flags="s" line="484" module="saxon-xforms.xsl">
    <p.withPredicate role="match">
     <p.nodeTest test="element(Q{}input)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri===''&amp;&amp;q.local==='input';"/>
     <fn ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="484" name="exists">
      <axis name="attribute" nodeTest="attribute(Q{}data-action)" jsTest="return item.name==='data-action'"/>
     </fn>
    </p.withPredicate>
    <let role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="485" var="refi" as="attribute(Q{}data-ref)?" slot="0" eval="8">
     <axis name="attribute" nodeTest="attribute(Q{}data-ref)" jsTest="return item.name==='data-ref'"/>
     <let line="488" var="xforms-value-change" as="item()?" slot="1" eval="8">
      <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
       <check card="1" diag="0|0||ixsl:call">
        <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
       </check>
       <str val="getAction"/>
       <arrayBlock>
        <fn name="string">
         <axis name="attribute" nodeTest="attribute(Q{}data-action)" jsTest="return item.name==='data-action'"/>
        </fn>
       </arrayBlock>
      </ifCall>
      <let line="492" var="updatedInstanceXML" as="document-node()" slot="2" eval="7">
       <doc line="494" validation="preserve">
        <applyT mode="Q{}form-check-initial" bSlot="0">
         <ufCall role="select" line="491" name="Q{http://www.w3.org/2002/xforms}getInstance-JS" tailCall="false" bSlot="1" eval="7">
          <check card="1" diag="0|0||xforms:getInstance-JS">
           <cvUntyped to="xs:string">
            <data>
             <varRef name="refi" slot="0"/>
            </data>
           </cvUntyped>
          </check>
         </ufCall>
        </applyT>
       </doc>
       <sequence line="497">
        <ufCall name="Q{http://www.w3.org/2002/xforms}setInstance-JS" tailCall="false" bSlot="2" eval="7 6">
         <check card="1" diag="0|0||xforms:setInstance-JS">
          <cvUntyped to="xs:string">
           <data>
            <varRef name="refi" slot="0"/>
           </data>
          </cvUntyped>
         </check>
         <varRef name="updatedInstanceXML" slot="2"/>
        </ufCall>
        <ifCall line="504" name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
         <check card="1" diag="0|0||ixsl:call">
          <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
         </check>
         <str val="setPendingUpdates"/>
         <arrayBlock>
          <treat line="500" as="map(°)" jsTest="function k(item) {return SaxonJS.U.Atomic.anyAtomicType.matches(item);};function v(item) {return true;};function c() {return true;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="3|0||pendingInstanceUpdates">
           <map size="0"/>
          </treat>
         </arrayBlock>
        </ifCall>
        <ifCall line="505" name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
         <check card="1" diag="0|0||ixsl:call">
          <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
         </check>
         <str val="setUpdates"/>
         <arrayBlock>
          <treat line="502" as="map(°)" jsTest="function k(item) {return SaxonJS.U.Atomic.anyAtomicType.matches(item);};function v(item) {return true;};function c() {return true;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="3|0||instanceUpdates">
           <map size="0"/>
          </treat>
         </arrayBlock>
        </ifCall>
        <message line="507">
         <sequence role="select">
          <valueOf>
           <str val="&#xA;            input detected onchange event, ref= "/>
          </valueOf>
          <valueOf line="508">
           <convert from="xs:untypedAtomic" to="xs:string">
            <data>
             <varRef name="refi" slot="0"/>
            </data>
           </convert>
          </valueOf>
          <valueOf>
           <str val=", actions = "/>
          </valueOf>
          <valueOf line="508">
           <fn name="serialize">
            <varRef name="xforms-value-change" slot="1"/>
           </fn>
          </valueOf>
         </sequence>
         <str role="terminate" val="no"/>
         <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
        </message>
        <forEach line="512">
         <varRef name="xforms-value-change" slot="1"/>
         <let line="513" var="action-map" as="item()" slot="3" eval="7">
          <dot/>
          <let line="515" var="ref" as="item()*" slot="4" eval="3">
           <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
            <treat as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="0|0||map:get">
             <varRef name="action-map" slot="3"/>
            </treat>
            <str val="@ref"/>
           </ifCall>
           <sequence line="519">
            <message>
             <sequence role="select">
              <valueOf>
               <str val="&#xA;                input-changed evalute ref= "/>
              </valueOf>
              <valueOf line="520">
               <fn name="string-join">
                <convert from="xs:anyAtomicType" to="xs:string">
                 <data>
                  <mergeAdj>
                   <varRef name="ref" slot="4"/>
                  </mergeAdj>
                 </data>
                </convert>
                <str val=" "/>
               </fn>
              </valueOf>
              <valueOf>
               <str val=", position = "/>
              </valueOf>
              <valueOf line="520">
               <convert from="xs:integer" to="xs:string">
                <fn name="position"/>
               </convert>
              </valueOf>
              <valueOf>
               <str val="&#xA;                action "/>
              </valueOf>
              <valueOf line="521">
               <fn name="serialize">
                <varRef name="action-map" slot="3"/>
               </fn>
              </valueOf>
             </sequence>
             <str role="terminate" val="no"/>
             <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
            </message>
            <let line="524" var="context" as="node()?" slot="5" eval="7">
             <treat line="525" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="3|0|XTTE0570|context">
              <check card="?" diag="3|0|XTTE0570|context">
               <evaluate dxns="">
                <treat role="xpath" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="4|0||xsl:evaluate/xpath">
                 <check card="1" diag="4|0||xsl:evaluate/xpath">
                  <cvUntyped to="xs:string">
                   <data>
                    <varRef name="ref" slot="4"/>
                   </data>
                  </cvUntyped>
                 </check>
                </treat>
                <varRef role="cxt" name="updatedInstanceXML" slot="2"/>
                <str role="sa" val="no"/>
                <map role="wp" size="0"/>
               </evaluate>
              </check>
             </treat>
             <let line="530" var="ifVar" as="xs:string?" slot="6" eval="7">
              <ufCall name="Q{http://www.w3.org/2002/xforms}getIfStatement" tailCall="false" bSlot="3" eval="7">
               <treat as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="0|0||xforms:getIfStatement">
                <varRef name="action-map" slot="3"/>
               </treat>
              </ufCall>
              <let line="536" var="ifExecuted" as="xs:boolean" slot="7" eval="7">
               <choose line="538">
                <fn name="exists">
                 <varRef name="ifVar" slot="6"/>
                </fn>
                <treat as="xs:boolean" jsTest="return SaxonJS.U.Atomic.boolean.matches(item);" diag="3|0|XTTE0570|ifExecuted">
                 <check card="1" diag="3|0|XTTE0570|ifExecuted">
                  <cvUntyped to="xs:boolean">
                   <data>
                    <evaluate dxns="">
                     <check role="xpath" card="1" diag="4|0||xsl:evaluate/xpath">
                      <varRef name="ifVar" slot="6"/>
                     </check>
                     <varRef role="cxt" name="context" slot="5"/>
                     <str role="sa" val="no"/>
                     <map role="wp" size="0"/>
                    </evaluate>
                   </data>
                  </cvUntyped>
                 </check>
                </treat>
                <true/>
                <true/>
               </choose>
               <choose line="546">
                <varRef name="ifExecuted" slot="7"/>
                <choose line="550">
                 <fn name="exists">
                  <ifCall line="549" name="Q{http://www.w3.org/2005/xpath-functions/map}find" type="function(*)">
                   <varRef name="action-map" slot="3"/>
                   <str val="setvalue"/>
                  </ifCall>
                 </fn>
                 <let line="589" var="vv:v1" as="xs:string?" slot="8" eval="13">
                  <convert from="xs:untypedAtomic" to="xs:string">
                   <data>
                    <varRef name="refi" slot="0"/>
                   </data>
                  </convert>
                  <let line="563" var="vv:v0" as="xs:string" slot="9" eval="13">
                   <check card="1" diag="0|0||xforms:resolveXPathStrings">
                    <cvUntyped to="xs:string">
                     <data>
                      <varRef name="refi" slot="0"/>
                     </data>
                    </cvUntyped>
                   </check>
                   <let line="551" var="setValues" as="item()*" slot="10" eval="3">
                    <sequence line="552">
                     <ifCall name="Q{http://www.w3.org/2005/xpath-functions/array}flatten" type="item()*">
                      <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
                       <treat as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="0|0||map:get">
                        <varRef name="action-map" slot="3"/>
                       </treat>
                       <str val="setvalue"/>
                      </ifCall>
                     </ifCall>
                     <ifCall line="553" name="Q{http://www.w3.org/2005/xpath-functions/array}flatten" type="item()*">
                      <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
                       <treat as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="0|0||map:get">
                        <varRef name="action-map" slot="3"/>
                       </treat>
                       <str val="setvalue"/>
                      </ifCall>
                     </ifCall>
                    </sequence>
                    <sequence line="559">
                     <forEach>
                      <ifCall name="Q{http://www.w3.org/2005/xpath-functions/array}flatten" type="item()*">
                       <varRef name="setValues" slot="10"/>
                      </ifCall>
                      <let line="563" var="refz" as="xs:string" slot="11" eval="7">
                       <ufCall name="Q{http://www.w3.org/2002/xforms}resolveXPathStrings" tailCall="false" bSlot="4" eval="6 4">
                        <varRef name="vv:v0" slot="9"/>
                        <treat as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="0|1||xforms:resolveXPathStrings">
                         <check card="1" diag="0|1||xforms:resolveXPathStrings">
                          <cvUntyped to="xs:string">
                           <let var="vv:LHS1871971238" as="function(*)" slot="12" eval="7">
                            <treat as="function(*)" jsTest="return SaxonJS.U.isMap(item) || SaxonJS.U.isArray(item);" diag="3|0||vv:LHS1871971238">
                             <dot/>
                            </treat>
                            <choose>
                             <instance of="map(*)" jsTest="return SaxonJS.U.isMap(item)">
                              <varRef name="vv:LHS1871971238" slot="12"/>
                             </instance>
                             <data>
                              <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
                               <treat module="saxon-xforms.xsl" line="563" as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="0|0||map:get">
                                <varRef name="vv:LHS1871971238" slot="12"/>
                               </treat>
                               <str val="ref"/>
                              </ifCall>
                             </data>
                             <true/>
                             <data>
                              <error message="First argument of '?' must be a sequence of maps" code="XPTY0004" isTypeErr="0"/>
                             </data>
                            </choose>
                           </let>
                          </cvUntyped>
                         </check>
                        </treat>
                       </ufCall>
                       <let line="564" var="valuez" as="document-node()" slot="13" eval="7">
                        <doc line="567" validation="preserve">
                         <choose>
                          <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}contains" type="xs:boolean">
                           <treat as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="0|0||map:contains">
                            <dot/>
                           </treat>
                           <str val="@value"/>
                          </ifCall>
                          <sequence line="568">
                           <message>
                            <sequence role="select">
                             <valueOf>
                              <str val="&#xA;                                            $refi = "/>
                             </valueOf>
                             <valueOf line="569">
                              <convert from="xs:untypedAtomic" to="xs:string">
                               <data>
                                <varRef name="refi" slot="0"/>
                               </data>
                              </convert>
                             </valueOf>
                             <valueOf>
                              <str val="&#xA;                                            @value "/>
                             </valueOf>
                             <valueOf line="570">
                              <ufCall name="Q{http://www.w3.org/2002/xforms}resolveXPathStrings" tailCall="false" bSlot="5" eval="7 7">
                               <check card="1" diag="0|0||xforms:resolveXPathStrings">
                                <cvUntyped to="xs:string">
                                 <data>
                                  <varRef name="refi" slot="0"/>
                                 </data>
                                </cvUntyped>
                               </check>
                               <treat as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="0|1||xforms:resolveXPathStrings">
                                <check card="1" diag="0|1||xforms:resolveXPathStrings">
                                 <cvUntyped to="xs:string">
                                  <data>
                                   <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
                                    <treat as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="0|0||map:get">
                                     <dot/>
                                    </treat>
                                    <str val="@value"/>
                                   </ifCall>
                                  </data>
                                 </cvUntyped>
                                </check>
                               </treat>
                              </ufCall>
                             </valueOf>
                            </sequence>
                            <str role="terminate" val="no"/>
                            <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
                           </message>
                           <let line="572" var="contexti" as="node()" slot="14" eval="8">
                            <evaluate line="573" as="node()" dxns="">
                             <check role="xpath" card="1" diag="4|0||xsl:evaluate/xpath">
                              <cvUntyped to="xs:string">
                               <data>
                                <varRef name="refi" slot="0"/>
                               </data>
                              </cvUntyped>
                             </check>
                             <varRef role="cxt" name="updatedInstanceXML" slot="2"/>
                             <str role="sa" val="no"/>
                             <map role="wp" size="0"/>
                            </evaluate>
                            <evaluate line="576" dxns="">
                             <treat role="xpath" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="4|0||xsl:evaluate/xpath">
                              <check card="1" diag="4|0||xsl:evaluate/xpath">
                               <cvUntyped to="xs:string">
                                <data>
                                 <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
                                  <treat as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="0|0||map:get">
                                   <dot/>
                                  </treat>
                                  <str val="@value"/>
                                 </ifCall>
                                </data>
                               </cvUntyped>
                              </check>
                             </treat>
                             <varRef role="cxt" name="contexti" slot="14"/>
                             <str role="sa" val="no"/>
                             <map role="wp" size="0"/>
                            </evaluate>
                           </let>
                          </sequence>
                          <ifCall line="579" name="Q{http://www.w3.org/2005/xpath-functions/map}contains" type="xs:boolean">
                           <treat as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="0|0||map:contains">
                            <dot/>
                           </treat>
                           <str val="value"/>
                          </ifCall>
                          <cast line="580" as="xs:string" emptiable="1">
                           <atomSing card="?" diag="2|0||cast as">
                            <let var="vv:LHS1632890916" as="function(*)" slot="15" eval="7">
                             <treat as="function(*)" jsTest="return SaxonJS.U.isMap(item) || SaxonJS.U.isArray(item);" diag="3|0||vv:LHS1632890916">
                              <dot/>
                             </treat>
                             <choose>
                              <instance of="map(*)" jsTest="return SaxonJS.U.isMap(item)">
                               <varRef name="vv:LHS1632890916" slot="15"/>
                              </instance>
                              <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
                               <treat as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="0|0||map:get">
                                <varRef name="vv:LHS1632890916" slot="15"/>
                               </treat>
                               <str val="value"/>
                              </ifCall>
                              <true/>
                              <error message="First argument of '?' must be a sequence of maps" code="XPTY0004" isTypeErr="0"/>
                             </choose>
                            </let>
                           </atomSing>
                          </cast>
                          <true/>
                          <str val=""/>
                         </choose>
                        </doc>
                        <sequence line="588">
                         <message>
                          <sequence role="select">
                           <valueOf>
                            <str val=" &#xA;                                refi = "/>
                           </valueOf>
                           <valueOf line="589">
                            <varRef name="vv:v1" slot="8"/>
                           </valueOf>
                           <valueOf>
                            <str val="&#xA;                                refz = "/>
                           </valueOf>
                           <valueOf line="590">
                            <varRef name="refz" slot="11"/>
                           </valueOf>
                          </sequence>
                          <str role="terminate" val="no"/>
                          <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
                         </message>
                         <message line="591">
                          <sequence role="select">
                           <valueOf>
                            <str val=" value = "/>
                           </valueOf>
                           <valueOf>
                            <cast as="xs:string" emptiable="0">
                             <data>
                              <varRef name="valuez" slot="13"/>
                             </data>
                            </cast>
                           </valueOf>
                          </sequence>
                          <str role="terminate" val="no"/>
                          <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
                         </message>
                         <choose line="594">
                          <fn name="exists">
                           <varRef name="refz" slot="11"/>
                          </fn>
                          <let line="596" var="associated-form-control" as="node()?" slot="16" eval="7">
                           <check card="?" diag="3|0|XTTE0570|associated-form-control">
                            <slash>
                             <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}page" type="document-node()?"/>
                             <fn name="key">
                              <str val="Q{http://saxon.sf.net/}kk101"/>
                              <varRef name="refz" slot="11"/>
                              <dot type="document-node()"/>
                             </fn>
                            </slash>
                           </check>
                           <sequence line="597">
                            <message>
                             <sequence role="select">
                              <valueOf>
                               <str val=" $associated-form-control = "/>
                              </valueOf>
                              <valueOf>
                               <fn name="serialize">
                                <varRef name="associated-form-control" slot="16"/>
                               </fn>
                              </valueOf>
                             </sequence>
                             <str role="terminate" val="no"/>
                             <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
                            </message>
                            <choose line="599">
                             <fn name="exists">
                              <varRef name="associated-form-control" slot="16"/>
                             </fn>
                             <sequence line="601">
                              <applyT mode="Q{}set-field" bSlot="6">
                               <varRef role="select" name="associated-form-control" slot="16"/>
                               <withParam name="Q{}value" flags="t" as="xs:string">
                                <cast line="602" as="xs:string" emptiable="0">
                                 <data>
                                  <varRef name="valuez" slot="13"/>
                                 </data>
                                </cast>
                               </withParam>
                              </applyT>
                              <ifCall line="605" name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
                               <check card="1" diag="0|0||ixsl:call">
                                <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
                               </check>
                               <str val="setUpdates"/>
                               <arrayBlock>
                                <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}put" type="map(*)">
                                 <treat as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="0|0||map:put">
                                  <check card="1" diag="0|0||map:put">
                                   <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
                                    <check card="1" diag="0|0||ixsl:call">
                                     <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
                                    </check>
                                    <str val="getUpdates"/>
                                    <arrayBlock/>
                                   </ifCall>
                                  </check>
                                 </treat>
                                 <varRef name="refz" slot="11"/>
                                 <cast as="xs:string" emptiable="0">
                                  <data>
                                   <varRef name="valuez" slot="13"/>
                                  </data>
                                 </cast>
                                </ifCall>
                               </arrayBlock>
                              </ifCall>
                              <message line="607">
                               <let role="select" var="mapxx" as="item()?" slot="17" eval="8">
                                <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
                                 <check card="1" diag="0|0||ixsl:call">
                                  <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
                                 </check>
                                 <str val="getUpdates"/>
                                 <arrayBlock/>
                                </ifCall>
                                <sequence line="606">
                                 <valueOf>
                                  <str val="&#xA;                                            Updates map = "/>
                                 </valueOf>
                                 <fn line="608" name="serialize">
                                  <varRef name="mapxx" slot="17"/>
                                 </fn>
                                </sequence>
                               </let>
                               <str role="terminate" val="no"/>
                               <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
                              </message>
                             </sequence>
                             <true/>
                             <ifCall line="614" name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
                              <check card="1" diag="0|0||ixsl:call">
                               <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
                              </check>
                              <str val="setPendingUpdates"/>
                              <arrayBlock>
                               <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}put" type="map(*)">
                                <treat as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="0|0||map:put">
                                 <check card="1" diag="0|0||map:put">
                                  <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
                                   <check card="1" diag="0|0||ixsl:call">
                                    <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
                                   </check>
                                   <str val="getPendingUpdates"/>
                                   <arrayBlock/>
                                  </ifCall>
                                 </check>
                                </treat>
                                <varRef name="refz" slot="11"/>
                                <cast as="xs:string" emptiable="0">
                                 <data>
                                  <varRef name="valuez" slot="13"/>
                                 </data>
                                </cast>
                               </ifCall>
                              </arrayBlock>
                             </ifCall>
                            </choose>
                           </sequence>
                          </let>
                         </choose>
                        </sequence>
                       </let>
                      </let>
                     </forEach>
                     <choose line="624">
                      <fn name="exists">
                       <ifCall name="Q{http://www.w3.org/2005/xpath-functions/array}flatten" type="item()*">
                        <varRef name="setValues" slot="10"/>
                       </ifCall>
                      </fn>
                      <let line="625" var="pendingUpdates" as="map(xs:string, xs:string)?" slot="18" eval="7">
                       <treat as="map(xs:string, xs:string)" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.Atomic.string.matches(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="3|0|XTTE0570|pendingUpdates">
                        <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
                         <check card="1" diag="0|0||ixsl:call">
                          <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
                         </check>
                         <str val="getPendingUpdates"/>
                         <arrayBlock/>
                        </ifCall>
                       </treat>
                       <let line="627" var="updatedInstanceXML3" as="document-node()" slot="19" eval="7">
                        <doc line="628" validation="preserve">
                         <applyT mode="Q{}form-check-initial" bSlot="7">
                          <varRef role="select" name="updatedInstanceXML" slot="2"/>
                          <withParam name="Q{}pendingUpdates" as="map(xs:string, xs:string)?">
                           <varRef line="629" name="pendingUpdates" slot="18"/>
                          </withParam>
                         </applyT>
                        </doc>
                        <ufCall line="635" name="Q{http://www.w3.org/2002/xforms}setInstance-JS" tailCall="false" bSlot="8" eval="7 6">
                         <check card="1" diag="0|0||xforms:setInstance-JS">
                          <cvUntyped to="xs:string">
                           <data>
                            <varRef name="refi" slot="0"/>
                           </data>
                          </cvUntyped>
                         </check>
                         <varRef name="updatedInstanceXML3" slot="19"/>
                        </ufCall>
                       </let>
                      </let>
                     </choose>
                    </sequence>
                   </let>
                  </let>
                 </let>
                </choose>
               </choose>
              </let>
             </let>
            </let>
           </sequence>
          </let>
         </let>
        </forEach>
        <message line="648">
         <sequence role="select">
          <valueOf>
           <str val="&#xA;            instance before checkRelevantFields= "/>
          </valueOf>
          <valueOf line="649">
           <fn name="serialize">
            <ufCall name="Q{http://www.w3.org/2002/xforms}getInstance-JS" tailCall="false" bSlot="9" eval="7">
             <check card="1" diag="0|0||xforms:getInstance-JS">
              <cvUntyped to="xs:string">
               <data>
                <varRef name="refi" slot="0"/>
               </data>
              </cvUntyped>
             </check>
            </ufCall>
           </fn>
          </valueOf>
         </sequence>
         <str role="terminate" val="no"/>
         <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
        </message>
        <ufCall line="653" name="Q{http://www.w3.org/2002/xforms}checkRelevantFields" tailCall="false" bSlot="10" eval="7">
         <check card="1" diag="0|0||xforms:checkRelevantFields">
          <cvUntyped to="xs:string">
           <attVal name="Q{}data-element" chk="0"/>
          </cvUntyped>
         </check>
        </ufCall>
       </sequence>
      </let>
     </let>
    </let>
   </templateRule>
   <templateRule prec="0" prio="0.5" seq="1" rank="0" minImp="0" slots="20" flags="s" line="747" module="saxon-xforms.xsl">
    <p.withPredicate role="match">
     <p.nodeTest test="element(Q{}select)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri===''&amp;&amp;q.local==='select';"/>
     <fn ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="747" name="exists">
      <axis name="attribute" nodeTest="attribute(Q{}data-action)" jsTest="return item.name==='data-action'"/>
     </fn>
    </p.withPredicate>
    <let role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="749" var="refi" as="attribute(Q{}data-ref)?" slot="0" eval="8">
     <axis name="attribute" nodeTest="attribute(Q{}data-ref)" jsTest="return item.name==='data-ref'"/>
     <let line="755" var="xforms-actions" as="map(*)?" slot="1" eval="7">
      <treat as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="3|0|XTTE0570|xforms-actions">
       <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
        <check card="1" diag="0|0||ixsl:call">
         <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
        </check>
        <str val="getAction"/>
        <arrayBlock>
         <fn name="string">
          <axis name="attribute" nodeTest="attribute(Q{}data-action)" jsTest="return item.name==='data-action'"/>
         </fn>
        </arrayBlock>
       </ifCall>
      </treat>
      <sequence line="757">
       <message>
        <sequence role="select">
         <valueOf>
          <str val="action map = "/>
         </valueOf>
         <fn name="serialize">
          <varRef name="xforms-actions" slot="1"/>
         </fn>
        </sequence>
        <str role="terminate" val="no"/>
        <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
       </message>
       <let line="762" var="updatedInstanceXML" as="document-node()" slot="2" eval="7">
        <doc line="764" validation="preserve">
         <applyT mode="Q{}form-check-initial" bSlot="11">
          <ufCall role="select" line="761" name="Q{http://www.w3.org/2002/xforms}getInstance-JS" tailCall="false" bSlot="12" eval="7">
           <check card="1" diag="0|0||xforms:getInstance-JS">
            <cvUntyped to="xs:string">
             <data>
              <varRef name="refi" slot="0"/>
             </data>
            </cvUntyped>
           </check>
          </ufCall>
         </applyT>
        </doc>
        <sequence line="767">
         <ufCall name="Q{http://www.w3.org/2002/xforms}setInstance-JS" tailCall="false" bSlot="13" eval="7 6">
          <check card="1" diag="0|0||xforms:setInstance-JS">
           <cvUntyped to="xs:string">
            <data>
             <varRef name="refi" slot="0"/>
            </data>
           </cvUntyped>
          </check>
          <varRef name="updatedInstanceXML" slot="2"/>
         </ufCall>
         <ifCall line="777" name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
          <check card="1" diag="0|0||ixsl:call">
           <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
          </check>
          <str val="setPendingUpdates"/>
          <arrayBlock>
           <treat line="774" as="map(°)" jsTest="function k(item) {return SaxonJS.U.Atomic.anyAtomicType.matches(item);};function v(item) {return true;};function c() {return true;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="3|0||pendingInstanceUpdates">
            <map size="0"/>
           </treat>
          </arrayBlock>
         </ifCall>
         <ifCall line="778" name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
          <check card="1" diag="0|0||ixsl:call">
           <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
          </check>
          <str val="setUpdates"/>
          <arrayBlock>
           <treat line="775" as="map(°)" jsTest="function k(item) {return SaxonJS.U.Atomic.anyAtomicType.matches(item);};function v(item) {return true;};function c() {return true;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="3|0||instanceUpdates">
            <map size="0"/>
           </treat>
          </arrayBlock>
         </ifCall>
         <message line="780">
          <sequence role="select">
           <valueOf>
            <str val=" select changed refi = "/>
           </valueOf>
           <valueOf>
            <convert from="xs:untypedAtomic" to="xs:string">
             <data>
              <varRef name="refi" slot="0"/>
             </data>
            </convert>
           </valueOf>
           <valueOf>
            <str val="&#xA;        xforms-action "/>
           </valueOf>
           <fn line="781" name="serialize">
            <varRef name="xforms-actions" slot="1"/>
           </fn>
          </sequence>
          <str role="terminate" val="no"/>
          <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
         </message>
         <forEach line="784">
          <varRef name="xforms-actions" slot="1"/>
          <let line="785" var="action-map" as="map(*)" slot="3" eval="7">
           <dot type="map(*)"/>
           <let line="789" var="ref" as="item()*" slot="4" eval="3">
            <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
             <varRef name="action-map" slot="3"/>
             <str val="@ref"/>
            </ifCall>
            <sequence line="791">
             <message>
              <sequence role="select">
               <valueOf>
                <str val=" select ref = "/>
               </valueOf>
               <valueOf>
                <fn name="string-join">
                 <convert from="xs:anyAtomicType" to="xs:string">
                  <data>
                   <mergeAdj>
                    <varRef name="ref" slot="4"/>
                   </mergeAdj>
                  </data>
                 </convert>
                 <str val=" "/>
                </fn>
               </valueOf>
              </sequence>
              <str role="terminate" val="no"/>
              <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
             </message>
             <let line="793" var="context" as="node()?" slot="5" eval="7">
              <treat line="794" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="3|0|XTTE0570|context">
               <check card="?" diag="3|0|XTTE0570|context">
                <evaluate dxns="">
                 <treat role="xpath" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="4|0||xsl:evaluate/xpath">
                  <check card="1" diag="4|0||xsl:evaluate/xpath">
                   <cvUntyped to="xs:string">
                    <data>
                     <varRef name="ref" slot="4"/>
                    </data>
                   </cvUntyped>
                  </check>
                 </treat>
                 <varRef role="cxt" name="updatedInstanceXML" slot="2"/>
                 <str role="sa" val="no"/>
                 <map role="wp" size="0"/>
                </evaluate>
               </check>
              </treat>
              <let line="797" var="ifVar" as="item()*" slot="6" eval="3">
               <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
                <varRef name="action-map" slot="3"/>
                <str val="@if"/>
               </ifCall>
               <sequence line="800">
                <message>
                 <sequence role="select">
                  <valueOf>
                   <str val=" select ref = "/>
                  </valueOf>
                  <valueOf>
                   <fn name="string-join">
                    <convert from="xs:anyAtomicType" to="xs:string">
                     <data>
                      <mergeAdj>
                       <varRef name="ref" slot="4"/>
                      </mergeAdj>
                     </data>
                    </convert>
                    <str val=" "/>
                   </fn>
                  </valueOf>
                  <valueOf>
                   <str val="&#xA;            @if "/>
                  </valueOf>
                  <valueOf line="801">
                   <fn name="string-join">
                    <convert from="xs:anyAtomicType" to="xs:string">
                     <data>
                      <mergeAdj>
                       <varRef name="ifVar" slot="6"/>
                      </mergeAdj>
                     </data>
                    </convert>
                    <str val=" "/>
                   </fn>
                  </valueOf>
                  <valueOf>
                   <str val="&#xA;                @while"/>
                  </valueOf>
                  <valueOf line="802">
                   <fn name="string-join">
                    <convert from="xs:anyAtomicType" to="xs:string">
                     <data>
                      <mergeAdj>
                       <ifCall line="799" name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
                        <varRef name="action-map" slot="3"/>
                        <str val="@while"/>
                       </ifCall>
                      </mergeAdj>
                     </data>
                    </convert>
                    <str val=" "/>
                   </fn>
                  </valueOf>
                 </sequence>
                 <str role="terminate" val="no"/>
                 <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
                </message>
                <let line="808" var="ifExecuted" as="xs:boolean" slot="7" eval="7">
                 <choose line="810">
                  <fn name="exists">
                   <varRef name="ifVar" slot="6"/>
                  </fn>
                  <treat as="xs:boolean" jsTest="return SaxonJS.U.Atomic.boolean.matches(item);" diag="3|0|XTTE0570|ifExecuted">
                   <check card="1" diag="3|0|XTTE0570|ifExecuted">
                    <cvUntyped to="xs:boolean">
                     <data>
                      <evaluate dxns="">
                       <treat role="xpath" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="4|0||xsl:evaluate/xpath">
                        <check card="1" diag="4|0||xsl:evaluate/xpath">
                         <cvUntyped to="xs:string">
                          <data>
                           <varRef name="ifVar" slot="6"/>
                          </data>
                         </cvUntyped>
                        </check>
                       </treat>
                       <varRef role="cxt" name="context" slot="5"/>
                       <str role="sa" val="no"/>
                       <map role="wp" size="0"/>
                      </evaluate>
                     </data>
                    </cvUntyped>
                   </check>
                  </treat>
                  <true/>
                  <true/>
                 </choose>
                 <choose line="818">
                  <varRef name="ifExecuted" slot="7"/>
                  <sequence line="819">
                   <message>
                    <sequence role="select">
                     <valueOf>
                      <str val="&#xA;                        @if  executed "/>
                     </valueOf>
                     <valueOf line="820">
                      <fn name="string-join">
                       <convert from="xs:anyAtomicType" to="xs:string">
                        <data>
                         <mergeAdj>
                          <varRef name="ifVar" slot="6"/>
                         </mergeAdj>
                        </data>
                       </convert>
                       <str val=" "/>
                      </fn>
                     </valueOf>
                    </sequence>
                    <str role="terminate" val="no"/>
                    <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
                   </message>
                   <choose line="825">
                    <fn name="exists">
                     <ifCall line="824" name="Q{http://www.w3.org/2005/xpath-functions/map}find" type="function(*)">
                      <varRef name="action-map" slot="3"/>
                      <str val="setvalue"/>
                     </ifCall>
                    </fn>
                    <let line="846" var="vv:v0" as="xs:string" slot="8" eval="13">
                     <check card="1" diag="0|0||xforms:resolveXPathStrings">
                      <cvUntyped to="xs:string">
                       <data>
                        <varRef name="refi" slot="0"/>
                       </data>
                      </cvUntyped>
                     </check>
                     <let line="826" var="setValues" as="item()*" slot="9" eval="3">
                      <ifCall line="828" name="Q{http://www.w3.org/2005/xpath-functions/array}flatten" type="item()*">
                       <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
                        <varRef name="action-map" slot="3"/>
                        <str val="setvalue"/>
                       </ifCall>
                      </ifCall>
                      <sequence line="830">
                       <message>
                        <sequence role="select">
                         <valueOf>
                          <str val="&#xA;                            setValues "/>
                         </valueOf>
                         <valueOf line="831">
                          <fn name="serialize">
                           <ifCall name="Q{http://www.w3.org/2005/xpath-functions/array}flatten" type="item()*">
                            <varRef name="setValues" slot="9"/>
                           </ifCall>
                          </fn>
                         </valueOf>
                        </sequence>
                        <str role="terminate" val="no"/>
                        <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
                       </message>
                       <forEach line="833">
                        <varRef name="setValues" slot="9"/>
                        <let line="834" var="ifVari" as="item()*" slot="10" eval="3">
                         <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
                          <treat as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="0|0||map:get">
                           <dot/>
                          </treat>
                          <str val="@if"/>
                         </ifCall>
                         <let line="835" var="ifExecutedi" as="xs:boolean" slot="11" eval="7">
                          <choose line="837">
                           <fn name="exists">
                            <varRef name="ifVari" slot="10"/>
                           </fn>
                           <treat as="xs:boolean" jsTest="return SaxonJS.U.Atomic.boolean.matches(item);" diag="3|0|XTTE0570|ifExecutedi">
                            <check card="1" diag="3|0|XTTE0570|ifExecutedi">
                             <cvUntyped to="xs:boolean">
                              <data>
                               <evaluate dxns="">
                                <treat role="xpath" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="4|0||xsl:evaluate/xpath">
                                 <check card="1" diag="4|0||xsl:evaluate/xpath">
                                  <cvUntyped to="xs:string">
                                   <data>
                                    <varRef name="ifVari" slot="10"/>
                                   </data>
                                  </cvUntyped>
                                 </check>
                                </treat>
                                <varRef role="cxt" name="context" slot="5"/>
                                <str role="sa" val="no"/>
                                <map role="wp" size="0"/>
                               </evaluate>
                              </data>
                             </cvUntyped>
                            </check>
                           </treat>
                           <true/>
                           <true/>
                          </choose>
                          <let line="846" var="refz" as="xs:string" slot="12" eval="7">
                           <ufCall name="Q{http://www.w3.org/2002/xforms}resolveXPathStrings" tailCall="false" bSlot="14" eval="6 4">
                            <varRef name="vv:v0" slot="8"/>
                            <treat as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="0|1||xforms:resolveXPathStrings">
                             <check card="1" diag="0|1||xforms:resolveXPathStrings">
                              <cvUntyped to="xs:string">
                               <let var="vv:LHS1864914055" as="function(*)" slot="13" eval="7">
                                <treat as="function(*)" jsTest="return SaxonJS.U.isMap(item) || SaxonJS.U.isArray(item);" diag="3|0||vv:LHS1864914055">
                                 <dot/>
                                </treat>
                                <choose>
                                 <instance of="map(*)" jsTest="return SaxonJS.U.isMap(item)">
                                  <varRef name="vv:LHS1864914055" slot="13"/>
                                 </instance>
                                 <data>
                                  <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
                                   <treat module="saxon-xforms.xsl" line="846" as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="0|0||map:get">
                                    <varRef name="vv:LHS1864914055" slot="13"/>
                                   </treat>
                                   <str val="ref"/>
                                  </ifCall>
                                 </data>
                                 <true/>
                                 <data>
                                  <error message="First argument of '?' must be a sequence of maps" code="XPTY0004" isTypeErr="0"/>
                                 </data>
                                </choose>
                               </let>
                              </cvUntyped>
                             </check>
                            </treat>
                           </ufCall>
                           <let line="847" var="valuez" as="xs:string" slot="14" eval="7">
                            <choose line="850">
                             <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}contains" type="xs:boolean">
                              <treat as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="0|0||map:contains">
                               <dot/>
                              </treat>
                              <str val="@value"/>
                             </ifCall>
                             <check line="851" card="1" diag="3|0|XTTE0570|valuez">
                              <sequence>
                               <message>
                                <sequence role="select">
                                 <valueOf>
                                  <str val="&#xA;                                            @value "/>
                                 </valueOf>
                                 <valueOf line="852">
                                  <ufCall name="Q{http://www.w3.org/2002/xforms}resolveXPathStrings" tailCall="false" bSlot="15" eval="7 7">
                                   <check card="1" diag="0|0||xforms:resolveXPathStrings">
                                    <cvUntyped to="xs:string">
                                     <data>
                                      <varRef name="refi" slot="0"/>
                                     </data>
                                    </cvUntyped>
                                   </check>
                                   <treat as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="0|1||xforms:resolveXPathStrings">
                                    <check card="1" diag="0|1||xforms:resolveXPathStrings">
                                     <cvUntyped to="xs:string">
                                      <data>
                                       <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
                                        <treat as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="0|0||map:get">
                                         <dot/>
                                        </treat>
                                        <str val="@value"/>
                                       </ifCall>
                                      </data>
                                     </cvUntyped>
                                    </check>
                                   </treat>
                                  </ufCall>
                                 </valueOf>
                                </sequence>
                                <str role="terminate" val="no"/>
                                <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
                               </message>
                               <let line="854" var="contexti" as="node()" slot="15" eval="8">
                                <evaluate line="855" as="node()" dxns="">
                                 <check role="xpath" card="1" diag="4|0||xsl:evaluate/xpath">
                                  <cvUntyped to="xs:string">
                                   <data>
                                    <varRef name="refi" slot="0"/>
                                   </data>
                                  </cvUntyped>
                                 </check>
                                 <varRef role="cxt" name="updatedInstanceXML" slot="2"/>
                                 <str role="sa" val="no"/>
                                 <map role="wp" size="0"/>
                                </evaluate>
                                <evaluate line="858" as="xs:string" dxns="">
                                 <treat role="xpath" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="4|0||xsl:evaluate/xpath">
                                  <check card="1" diag="4|0||xsl:evaluate/xpath">
                                   <cvUntyped to="xs:string">
                                    <data>
                                     <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
                                      <treat as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="0|0||map:get">
                                       <dot/>
                                      </treat>
                                      <str val="@value"/>
                                     </ifCall>
                                    </data>
                                   </cvUntyped>
                                  </check>
                                 </treat>
                                 <varRef role="cxt" name="contexti" slot="15"/>
                                 <str role="sa" val="no"/>
                                 <map role="wp" size="0"/>
                                </evaluate>
                               </let>
                              </sequence>
                             </check>
                             <ifCall line="861" name="Q{http://www.w3.org/2005/xpath-functions/map}contains" type="xs:boolean">
                              <treat as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="0|0||map:contains">
                               <dot/>
                              </treat>
                              <str val="value"/>
                             </ifCall>
                             <check line="862" card="1" diag="3|0|XTTE0570|valuez">
                              <cast as="xs:string" emptiable="1">
                               <atomSing card="?" diag="2|0||cast as">
                                <let var="vv:LHS293886870" as="function(*)" slot="16" eval="7">
                                 <treat as="function(*)" jsTest="return SaxonJS.U.isMap(item) || SaxonJS.U.isArray(item);" diag="3|0||vv:LHS293886870">
                                  <dot/>
                                 </treat>
                                 <choose>
                                  <instance of="map(*)" jsTest="return SaxonJS.U.isMap(item)">
                                   <varRef name="vv:LHS293886870" slot="16"/>
                                  </instance>
                                  <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
                                   <treat as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="0|0||map:get">
                                    <varRef name="vv:LHS293886870" slot="16"/>
                                   </treat>
                                   <str val="value"/>
                                  </ifCall>
                                  <true/>
                                  <error message="First argument of '?' must be a sequence of maps" code="XPTY0004" isTypeErr="0"/>
                                 </choose>
                                </let>
                               </atomSing>
                              </cast>
                             </check>
                             <true/>
                             <str val=""/>
                            </choose>
                            <sequence line="870">
                             <message>
                              <sequence role="select">
                               <valueOf>
                                <str val=" ref = "/>
                               </valueOf>
                               <valueOf>
                                <varRef name="refz" slot="12"/>
                               </valueOf>
                              </sequence>
                              <str role="terminate" val="no"/>
                              <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
                             </message>
                             <message line="871">
                              <sequence role="select">
                               <valueOf>
                                <str val=" value = "/>
                               </valueOf>
                               <valueOf>
                                <varRef name="valuez" slot="14"/>
                               </valueOf>
                              </sequence>
                              <str role="terminate" val="no"/>
                              <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
                             </message>
                             <choose line="874">
                              <and op="and">
                               <fn name="exists">
                                <varRef name="refz" slot="12"/>
                               </fn>
                               <varRef name="ifExecutedi" slot="11"/>
                              </and>
                              <let line="876" var="associated-form-control" as="node()?" slot="17" eval="7">
                               <check card="?" diag="3|0|XTTE0570|associated-form-control">
                                <slash>
                                 <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}page" type="document-node()?"/>
                                 <fn name="key">
                                  <str val="Q{http://saxon.sf.net/}kk101"/>
                                  <varRef name="refz" slot="12"/>
                                  <dot type="document-node()"/>
                                 </fn>
                                </slash>
                               </check>
                               <sequence line="877">
                                <message>
                                 <sequence role="select">
                                  <valueOf>
                                   <str val=" $associated-form-control = "/>
                                  </valueOf>
                                  <valueOf>
                                   <fn name="serialize">
                                    <varRef name="associated-form-control" slot="17"/>
                                   </fn>
                                  </valueOf>
                                 </sequence>
                                 <str role="terminate" val="no"/>
                                 <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
                                </message>
                                <choose line="879">
                                 <fn name="exists">
                                  <varRef name="associated-form-control" slot="17"/>
                                 </fn>
                                 <sequence line="881">
                                  <applyT mode="Q{}set-field" bSlot="16">
                                   <varRef role="select" name="associated-form-control" slot="17"/>
                                   <withParam name="Q{}value" flags="t" as="xs:string">
                                    <varRef line="882" name="valuez" slot="14"/>
                                   </withParam>
                                  </applyT>
                                  <ifCall line="884" name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
                                   <check card="1" diag="0|0||ixsl:call">
                                    <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
                                   </check>
                                   <str val="setUpdates"/>
                                   <arrayBlock>
                                    <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}put" type="map(*)">
                                     <treat as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="0|0||map:put">
                                      <check card="1" diag="0|0||map:put">
                                       <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
                                        <check card="1" diag="0|0||ixsl:call">
                                         <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
                                        </check>
                                        <str val="getUpdates"/>
                                        <arrayBlock/>
                                       </ifCall>
                                      </check>
                                     </treat>
                                     <varRef name="refz" slot="12"/>
                                     <varRef name="valuez" slot="14"/>
                                    </ifCall>
                                   </arrayBlock>
                                  </ifCall>
                                  <message line="886">
                                   <let role="select" var="mapxx" as="item()?" slot="18" eval="8">
                                    <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
                                     <check card="1" diag="0|0||ixsl:call">
                                      <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
                                     </check>
                                     <str val="getUpdates"/>
                                     <arrayBlock/>
                                    </ifCall>
                                    <sequence line="885">
                                     <valueOf>
                                      <str val="&#xA;                                            Updates map = "/>
                                     </valueOf>
                                     <fn line="887" name="serialize">
                                      <varRef name="mapxx" slot="18"/>
                                     </fn>
                                    </sequence>
                                   </let>
                                   <str role="terminate" val="no"/>
                                   <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
                                  </message>
                                 </sequence>
                                 <true/>
                                 <sequence line="893">
                                  <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
                                   <check card="1" diag="0|0||ixsl:call">
                                    <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
                                   </check>
                                   <str val="setPendingUpdates"/>
                                   <arrayBlock>
                                    <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}put" type="map(*)">
                                     <treat as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="0|0||map:put">
                                      <check card="1" diag="0|0||map:put">
                                       <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
                                        <check card="1" diag="0|0||ixsl:call">
                                         <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
                                        </check>
                                        <str val="getPendingUpdates"/>
                                        <arrayBlock/>
                                       </ifCall>
                                      </check>
                                     </treat>
                                     <varRef name="refz" slot="12"/>
                                     <varRef name="valuez" slot="14"/>
                                    </ifCall>
                                   </arrayBlock>
                                  </ifCall>
                                  <message line="894">
                                   <sequence role="select">
                                    <valueOf>
                                     <str val=" update instance only ref = "/>
                                    </valueOf>
                                    <valueOf>
                                     <varRef name="refz" slot="12"/>
                                    </valueOf>
                                   </sequence>
                                   <str role="terminate" val="no"/>
                                   <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
                                  </message>
                                 </sequence>
                                </choose>
                               </sequence>
                              </let>
                             </choose>
                            </sequence>
                           </let>
                          </let>
                         </let>
                        </let>
                       </forEach>
                      </sequence>
                     </let>
                    </let>
                   </choose>
                  </sequence>
                 </choose>
                </let>
               </sequence>
              </let>
             </let>
            </sequence>
           </let>
          </let>
         </forEach>
         <let line="924" var="updatedInstanceXML2" as="document-node()" slot="19" eval="7">
          <doc line="925" validation="preserve">
           <applyT mode="Q{}form-check-initial" bSlot="17">
            <varRef role="select" name="updatedInstanceXML" slot="2"/>
            <withParam name="Q{}pendingUpdates" as="map(xs:string, xs:string)?">
             <treat line="926" as="map(xs:string, xs:string)" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.Atomic.string.matches(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|pendingUpdates">
              <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
               <check card="1" diag="0|0||ixsl:call">
                <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
               </check>
               <str val="getPendingUpdates"/>
               <arrayBlock/>
              </ifCall>
             </treat>
            </withParam>
           </applyT>
          </doc>
          <sequence line="929">
           <ufCall name="Q{http://www.w3.org/2002/xforms}setInstance-JS" tailCall="false" bSlot="18" eval="7 6">
            <check card="1" diag="0|0||xforms:setInstance-JS">
             <cvUntyped to="xs:string">
              <data>
               <varRef name="refi" slot="0"/>
              </data>
             </cvUntyped>
            </check>
            <varRef name="updatedInstanceXML2" slot="19"/>
           </ufCall>
           <message line="933">
            <sequence role="select">
             <valueOf>
              <str val="&#xA;            instance after select change "/>
             </valueOf>
             <valueOf line="934">
              <fn name="serialize">
               <varRef name="updatedInstanceXML2" slot="19"/>
              </fn>
             </valueOf>
            </sequence>
            <str role="terminate" val="no"/>
            <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
           </message>
           <ufCall line="936" name="Q{http://www.w3.org/2002/xforms}checkRelevantFields" tailCall="false" bSlot="19" eval="7">
            <check card="1" diag="0|0||xforms:checkRelevantFields">
             <cvUntyped to="xs:string">
              <attVal name="Q{}data-element" chk="0"/>
             </cvUntyped>
            </check>
           </ufCall>
          </sequence>
         </let>
        </sequence>
       </let>
      </sequence>
     </let>
    </let>
   </templateRule>
  </mode>
 </co>
 <co id="12" binds="23 23 30">
  <template name="Q{}xformsjs-main" flags="os" line="35" module="saxon-xforms.xsl" slots="10">
   <sequence role="body" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="36">
    <param name="Q{}xforms-doc" slot="0" as="document-node()?">
     <empty role="select"/>
     <treat role="conversion" as="document-node()" jsTest="return SaxonJS.U.isNode(item) &amp;&amp; (item.nodeType===9||item.nodeType===11);" diag="8|0|XTTE0590|xforms-doc">
      <check card="?" diag="8|0|XTTE0590|xforms-doc">
       <supplied slot="0"/>
      </check>
     </treat>
    </param>
    <param line="37" name="Q{}xforms-file" slot="1" as="xs:string?">
     <empty role="select"/>
     <treat role="conversion" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="8|0|XTTE0590|xforms-file">
      <check card="?" diag="8|0|XTTE0590|xforms-file">
       <cvUntyped to="xs:string">
        <data>
         <supplied slot="1"/>
        </data>
       </cvUntyped>
      </check>
     </treat>
    </param>
    <param line="44" name="Q{}instance-xml" slot="2" as="document-node()*">
     <empty role="select"/>
     <treat role="conversion" as="document-node()" jsTest="return SaxonJS.U.isNode(item) &amp;&amp; (item.nodeType===9||item.nodeType===11);" diag="8|0|XTTE0590|instance-xml">
      <supplied slot="2"/>
     </treat>
    </param>
    <param line="45" name="Q{}xFormsId" slot="3" as="xs:string">
     <str role="select" val="xForm"/>
     <treat role="conversion" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="8|0|XTTE0590|xFormsId">
      <check card="1" diag="8|0|XTTE0590|xFormsId">
       <cvUntyped to="xs:string">
        <data>
         <supplied slot="3"/>
        </data>
       </cvUntyped>
      </check>
     </treat>
    </param>
    <let line="53" var="xforms-doci" as="document-node()?" slot="4" eval="7">
     <choose>
      <fn name="empty">
       <varRef name="xforms-doc" slot="0"/>
      </fn>
      <fn name="doc">
       <varRef name="xforms-file" slot="1"/>
      </fn>
      <true/>
      <varRef name="xforms-doc" slot="0"/>
     </choose>
     <let line="61" var="instance-doc" as="document-node()" slot="5" eval="7">
      <doc line="63" validation="preserve">
       <choose>
        <fn name="empty">
         <varRef name="instance-xml" slot="2"/>
        </fn>
        <copyOf line="64" flags="vc">
         <slash>
          <slash>
           <slash>
            <slash simple="1">
             <varRef name="xforms-doci" slot="4"/>
             <axis name="child" nodeTest="element(Q{http://www.w3.org/2002/xforms}xform)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='xform';"/>
            </slash>
            <axis name="child" nodeTest="element(Q{http://www.w3.org/2002/xforms}model)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='model';"/>
           </slash>
           <axis name="child" nodeTest="element(Q{http://www.w3.org/2002/xforms}instance)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='instance';"/>
          </slash>
          <axis name="child" nodeTest="element()" jsTest="return item.nodeType===1;"/>
         </slash>
        </copyOf>
        <true/>
        <copyOf line="67" flags="vc">
         <conditionalSort>
          <fn name="exists">
           <tail start="2">
            <varRef name="instance-xml" slot="2"/>
           </tail>
          </fn>
          <docOrder intra="0">
           <slash>
            <varRef name="instance-xml" slot="2"/>
            <axis name="child" nodeTest="element()" jsTest="return item.nodeType===1;"/>
           </slash>
          </docOrder>
         </conditionalSort>
        </copyOf>
       </choose>
      </doc>
      <let line="72" var="xforms-instances" as="element()*" slot="6" eval="8">
       <choose line="74">
        <fn name="empty">
         <varRef name="instance-xml" slot="2"/>
        </fn>
        <slash line="75">
         <slash>
          <slash simple="1">
           <varRef name="xforms-doci" slot="4"/>
           <axis name="child" nodeTest="element(Q{http://www.w3.org/2002/xforms}xform)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='xform';"/>
          </slash>
          <axis name="child" nodeTest="element(Q{http://www.w3.org/2002/xforms}model)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='model';"/>
         </slash>
         <axis name="child" nodeTest="element(Q{http://www.w3.org/2002/xforms}instance)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='instance';"/>
        </slash>
        <true/>
        <conditionalSort line="78">
         <fn name="exists">
          <tail start="2">
           <varRef name="instance-xml" slot="2"/>
          </tail>
         </fn>
         <docOrder intra="0">
          <slash>
           <varRef name="instance-xml" slot="2"/>
           <axis name="child" nodeTest="element()" jsTest="return item.nodeType===1;"/>
          </slash>
         </docOrder>
        </conditionalSort>
       </choose>
       <let line="85" var="bindings" as="map(xs:string, element(Q{http://www.w3.org/2002/xforms}bind))" slot="7" eval="8">
        <ifCall line="87" name="Q{http://www.w3.org/2005/xpath-functions/map}merge" type="map(*)">
         <forEach>
          <slash>
           <slash>
            <slash simple="1">
             <varRef name="xforms-doci" slot="4"/>
             <axis name="child" nodeTest="element(Q{http://www.w3.org/2002/xforms}xform)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='xform';"/>
            </slash>
            <axis name="child" nodeTest="element(Q{http://www.w3.org/2002/xforms}model)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='model';"/>
           </slash>
           <axis name="child" nodeTest="element(Q{http://www.w3.org/2002/xforms}bind)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='bind';"/>
          </slash>
          <ifCall line="124" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
           <check card="1" diag="0|0||map:entry">
            <cast as="xs:string" emptiable="1">
             <choose>
              <fn name="exists">
               <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
              </fn>
              <attVal name="Q{}id" chk="0"/>
              <true/>
              <attVal name="Q{}nodeset" chk="0"/>
             </choose>
            </cast>
           </check>
           <dot type="element(Q{http://www.w3.org/2002/xforms}bind)"/>
          </ifCall>
         </forEach>
         <map size="2">
          <str val="duplicates"/>
          <str val="reject"/>
          <str val="duplicates-error-code"/>
          <str val="XTDE3365"/>
         </map>
        </ifCall>
        <let line="166" var="RelevantBindings" as="map(xs:string, xs:string)" slot="8" eval="7">
         <treat line="168" as="map(xs:string, xs:string)" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.Atomic.string.matches(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="3|0|XTTE0570|RelevantBindings">
          <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}merge" type="map(*)">
           <forEach>
            <ifCall line="164" name="Q{http://www.w3.org/2005/xpath-functions/map}keys" type="xs:anyAtomicType*">
             <varRef name="bindings" slot="7"/>
            </ifCall>
            <let line="169" var="bindingNode" as="element(Q{http://www.w3.org/2002/xforms}bind)" slot="9" eval="7">
             <check card="1" diag="3|0|XTTE0570|bindingNode">
              <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
               <varRef name="bindings" slot="7"/>
               <cast as="xs:string" emptiable="0">
                <dot type="xs:anyAtomicType"/>
               </cast>
              </ifCall>
             </check>
             <choose line="171">
              <fn name="exists">
               <filter flags="b">
                <varRef name="bindingNode" slot="9"/>
                <fn name="exists">
                 <axis name="attribute" nodeTest="attribute(Q{}relevant)" jsTest="return item.name==='relevant'"/>
                </fn>
               </filter>
              </fn>
              <ifCall line="173" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
               <check line="172" card="1" diag="3|0|XTTE0570|keyi">
                <cast as="xs:string" emptiable="1">
                 <data>
                  <slash simple="1">
                   <varRef name="bindingNode" slot="9"/>
                   <axis name="attribute" nodeTest="attribute(Q{}nodeset)" jsTest="return item.name==='nodeset'"/>
                  </slash>
                 </data>
                </cast>
               </check>
               <cast as="xs:string" emptiable="1">
                <data>
                 <slash simple="1">
                  <varRef name="bindingNode" slot="9"/>
                  <axis name="attribute" nodeTest="attribute(Q{}relevant)" jsTest="return item.name==='relevant'"/>
                 </slash>
                </data>
               </cast>
              </ifCall>
             </choose>
            </let>
           </forEach>
           <map size="2">
            <str val="duplicates"/>
            <str val="reject"/>
            <str val="duplicates-error-code"/>
            <str val="XTDE3365"/>
           </map>
          </ifCall>
         </treat>
         <sequence line="180">
          <message>
           <sequence role="select">
            <valueOf>
             <str val="&#xA;            RelevantBindings = "/>
            </valueOf>
            <fn line="181" name="serialize">
             <varRef name="RelevantBindings" slot="8"/>
            </fn>
           </sequence>
           <str role="terminate" val="no"/>
           <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
          </message>
          <choose line="186">
           <gc op="=" card="M:N" comp="GAC|http://www.w3.org/2005/xpath-functions/collation/codepoint">
            <data>
             <slash>
              <slash simple="1">
               <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}page" type="document-node()?"/>
               <axis name="descendant" nodeTest="element(Q{}script)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri===''&amp;&amp;q.local==='script';"/>
              </slash>
              <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
             </slash>
            </data>
            <data>
             <gVarRef name="Q{}xforms-cache-id" bSlot="0"/>
            </data>
           </gc>
           <sequence line="187">
            <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
             <check card="1" diag="0|0||ixsl:call">
              <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
             </check>
             <str val="setXFormsDoc"/>
             <arrayBlock>
              <varRef name="xforms-doc" slot="0"/>
             </arrayBlock>
            </ifCall>
            <ifCall line="188" name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
             <check card="1" diag="0|0||ixsl:call">
              <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
             </check>
             <str val="setXFormsID"/>
             <arrayBlock>
              <varRef name="xFormsId" slot="3"/>
             </arrayBlock>
            </ifCall>
            <ifCall line="189" name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
             <check card="1" diag="0|0||ixsl:call">
              <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
             </check>
             <str val="setRelevantMap"/>
             <arrayBlock>
              <varRef name="RelevantBindings" slot="8"/>
             </arrayBlock>
            </ifCall>
           </sequence>
           <true/>
           <sequence line="200">
            <forEach>
             <slash simple="1">
              <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}page" type="document-node()?"/>
              <axis name="descendant" nodeTest="element(Q{}head)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri===''&amp;&amp;q.local==='head';"/>
             </slash>
             <resultDoc line="209" global="#&#xD;&#xA;#Fri Jun 29 11:35:20 BST 2018&#xD;&#xA;indent=no&#xD;&#xA;doctype-system=http\://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#xD;&#xA;encoding=utf-8&#xD;&#xA;doctype-public=-//W3C//DTD XHTML 1.0 Transitional//EN&#xD;&#xA;omit-xml-declaration=no&#xD;&#xA;method=html&#xD;&#xA;" local="#&#xD;&#xA;#Fri Jun 29 11:35:20 BST 2018&#xD;&#xA;">
              <str role="href" val="?."/>
              <elem role="content" line="217" name="script" nsuri="" namespaces="rdf xhtml js in fn map array ev">
               <sequence>
                <att name="type" flags="l">
                 <str val="text/javascript"/>
                </att>
                <att name="id" flags="l">
                 <fn name="string-join">
                  <convert from="xs:anyAtomicType" to="xs:string">
                   <data>
                    <mergeAdj>
                     <gVarRef name="Q{}xforms-cache-id" bSlot="1"/>
                    </mergeAdj>
                   </data>
                  </convert>
                  <str val=" "/>
                 </fn>
                </att>
                <valueOf flags="l">
                 <str val="                &#xA;                            var XFormsDoc = null;&#xA;                            var defaultInstanceDoc = null;&#xA;                            &#xA;                            // var instanceDoc = null;&#xA;                            // MD 2018: OND's suggestion for multiple instances&#xA;                            var instanceDocs = {};&#xA;                            &#xA;                            var pendingUpdatesMap = null;&#xA;                            var updatesMap = null;&#xA;                            var XFormsID= 'xForm';&#xA;                            var actions = {};&#xA;                            var relevantMap = {};&#xA;                            &#xA;                            var getCurrentDate = function(){&#xA;                            var today = new Date();&#xA;                            var dd = today.getDate();&#xA;                            var mm = today.getMonth()+1; //January is 0!&#xA;                            var yyyy = today.getFullYear();&#xA;                            &#xA;                            if(dd &lt; 10) {&#xA;                            dd = '0'+dd&#xA;                            } &#xA;                            &#xA;                            if(mm &lt; 10) {&#xA;                            mm = '0'+mm&#xA;                            } &#xA;                            &#xA;                            today = yyyy + '-' + mm + '-' + dd;&#xA;                            return today;&#xA;                            }&#xA;                            &#xA;                            &#xA;                            var setXFormsDoc = function(doc) {&#xA;                                XFormsDoc = doc;&#xA;                            }&#xA;                            &#xA;                            var getXFormsDoc = function() {&#xA;                                return XFormsDoc;&#xA;                            }&#xA;                            var setXFormsID = function(id) {&#xA;                                XFormsID = id;&#xA;                            }&#xA;                            &#xA;                            var getXFormsID = function() {&#xA;                                return XFormsID;&#xA;                            }&#xA;                            &#xA;                            &#xA;                            //var setInstance = function(doc) {&#xA;                            //    instanceDoc = doc;&#xA;                            //}&#xA;                            var setInstance = function(name, value) {&#xA;                                instanceDocs[name] = value;&#xA;                            } &#xA;                            &#xA;                            //var getInstance = function() {&#xA;                            //    return instanceDoc;&#xA;                            //}&#xA;                            &#xA;                            var getInstance = function(name) {&#xA;                                return instanceDocs[name];&#xA;                            }&#xA;                            &#xA;                            &#xA;                            //[OND] Maybe we can just set the key-&gt; value without having to copy the entire instanceDocs object.&#xA;                            var updateInstance = function(instanceDocs, key, value){&#xA;                                instanceDocs[key] = value;&#xA;                                return instanceDocs;&#xA;                            }&#xA;                            &#xA;                            &#xA;                            var setDefaultInstance = function(doc) {&#xA;                            defaultInstanceDoc = doc;&#xA;                            }&#xA;                            &#xA;                            var getDefaultInstance = function() {&#xA;                            return defaultInstanceDoc;&#xA;                            }&#xA;                            &#xA;                            var setPendingUpdates = function(map1) {&#xA;                            pendingUpdatesMap = map1;&#xA;                            }&#xA;                            &#xA;                            var clearPendingUpdates = function() {&#xA;                            pendingUpdatesMap = null;&#xA;                            }&#xA;                            &#xA;                            var getPendingUpdates = function() {&#xA;                            return pendingUpdatesMap;&#xA;                            }&#xA;                            &#xA;                            var setUpdates = function(map1) {&#xA;                                updatesMap = map1;&#xA;                            }&#xA;                            &#xA;                            var clearUpdates = function() {&#xA;                                updatesMap = null;&#xA;                            }&#xA;                            &#xA;                            var getUpdates = function() {&#xA;                            return updatesMap;&#xA;                            }&#xA;                            &#xA;                            var addAction = function(name, value){&#xA;                                actions[name] = value;&#xA;                            }&#xA;&#xA;                            var getAction = function(name){&#xA;                                return actions[name];&#xA;                            }&#xA;                            &#xA;                            var updateAction = function(actioni, key, value){&#xA;                                actioni[key] = value;&#xA;                                return actioni;&#xA;                            }&#xA;                            &#xA;                            var setRelevantMap = function(map1) {&#xA;                                relevantMap = map1;                            &#xA;                            }&#xA;                            &#xA;                            var getRelevantMap = function() {&#xA;                                return relevantMap;&#xA;                            }&#xA;                            &#xA;  &#xA;                            var startTime = function(name) {&#xA;                                console.time(name);&#xA;                            }&#xA;                            &#xA;                            var endTime = function(name) {&#xA;                            console.timeEnd(name);&#xA;                            }&#xA;                            &#xA;                        "/>
                </valueOf>
               </sequence>
              </elem>
             </resultDoc>
            </forEach>
            <ifCall line="355" name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
             <check card="1" diag="0|0||ixsl:call">
              <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
             </check>
             <str val="setXFormsDoc"/>
             <arrayBlock>
              <varRef name="xforms-doc" slot="0"/>
             </arrayBlock>
            </ifCall>
            <ifCall line="356" name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
             <check card="1" diag="0|0||ixsl:call">
              <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
             </check>
             <str val="setRelevantMap"/>
             <arrayBlock>
              <varRef name="RelevantBindings" slot="8"/>
             </arrayBlock>
            </ifCall>
           </sequence>
          </choose>
          <forEach line="365">
           <varRef name="xforms-instances" slot="6"/>
           <choose line="367">
            <fn name="exists">
             <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
            </fn>
            <sequence line="368">
             <message>
              <sequence role="select">
               <valueOf>
                <str val="Setting instance with ID '"/>
               </valueOf>
               <valueOf>
                <convert from="xs:untypedAtomic" to="xs:string">
                 <attVal name="Q{}id" chk="0"/>
                </convert>
               </valueOf>
               <valueOf flags="S">
                <str val="'"/>
               </valueOf>
              </sequence>
              <str role="terminate" val="no"/>
              <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
             </message>
             <ifCall line="369" name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
              <check card="1" diag="0|0||ixsl:call">
               <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
              </check>
              <str val="setInstance"/>
              <arrayBlock>
               <cast as="xs:string" emptiable="1">
                <attVal name="Q{}id" chk="0"/>
               </cast>
               <dot type="element()"/>
              </arrayBlock>
             </ifCall>
            </sequence>
            <true/>
            <ifCall line="372" name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
             <check card="1" diag="0|0||ixsl:call">
              <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
             </check>
             <str val="setInstance"/>
             <arrayBlock>
              <str val="saxon-forms-default"/>
              <dot type="element()"/>
             </arrayBlock>
            </ifCall>
           </choose>
          </forEach>
          <resultDoc line="379" global="#&#xD;&#xA;#Fri Jun 29 11:35:20 BST 2018&#xD;&#xA;indent=no&#xD;&#xA;doctype-system=http\://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#xD;&#xA;encoding=utf-8&#xD;&#xA;doctype-public=-//W3C//DTD XHTML 1.0 Transitional//EN&#xD;&#xA;omit-xml-declaration=no&#xD;&#xA;method=html&#xD;&#xA;" local="#&#xD;&#xA;#Fri Jun 29 11:35:20 BST 2018&#xD;&#xA;method={http\://saxonica.com/ns/interactiveXSLT}replace-content&#xD;&#xA;">
           <fn role="href" name="concat">
            <str val="#"/>
            <varRef name="xFormsId" slot="3"/>
           </fn>
           <applyT role="content" line="385" bSlot="2">
            <slash role="select" simple="1">
             <varRef name="xforms-doci" slot="4"/>
             <axis name="child" nodeTest="element(Q{http://www.w3.org/2002/xforms}xform)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='xform';"/>
            </slash>
            <withParam name="Q{}instance1" flags="t" as="document-node()">
             <varRef line="386" name="instance-doc" slot="5"/>
            </withParam>
            <withParam name="Q{}instances" flags="t" as="element()*">
             <varRef line="387" name="xforms-instances" slot="6"/>
            </withParam>
            <withParam name="Q{}bindings" flags="t" as="map(xs:string, node())">
             <varRef line="388" name="bindings" slot="7"/>
            </withParam>
            <withParam name="Q{}submissions" flags="t" as="map(xs:string, xs:string)">
             <ifCall line="133" name="Q{http://www.w3.org/2005/xpath-functions/map}merge" type="map(*)">
              <forEach>
               <slash>
                <slash>
                 <slash simple="1">
                  <varRef name="xforms-doci" slot="4"/>
                  <axis name="child" nodeTest="element(Q{http://www.w3.org/2002/xforms}xform)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='xform';"/>
                 </slash>
                 <axis name="child" nodeTest="element(Q{http://www.w3.org/2002/xforms}model)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='model';"/>
                </slash>
                <axis name="child" nodeTest="element(Q{http://www.w3.org/2002/xforms}submission)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri==='http://www.w3.org/2002/xforms'&amp;&amp;q.local==='submission';"/>
               </slash>
               <ifCall line="152" name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
                <choose line="146">
                 <fn name="exists">
                  <axis name="attribute" nodeTest="attribute(Q{}id)" jsTest="return item.name==='id'"/>
                 </fn>
                 <check card="1" diag="3|0|XTTE0570|map-key">
                  <cast as="xs:string" emptiable="1">
                   <attVal name="Q{}id" chk="0"/>
                  </cast>
                 </check>
                 <fn name="exists">
                  <axis name="attribute" nodeTest="attribute(Q{}ref)" jsTest="return item.name==='ref'"/>
                 </fn>
                 <check card="1" diag="3|0|XTTE0570|map-key">
                  <cast as="xs:string" emptiable="1">
                   <attVal name="Q{}ref" chk="0"/>
                  </cast>
                 </check>
                 <true/>
                 <str val="null"/>
                </choose>
                <choose line="151">
                 <fn name="exists">
                  <axis name="attribute" nodeTest="attribute(Q{}resource)" jsTest="return item.name==='resource'"/>
                 </fn>
                 <check card="1" diag="3|0|XTTE0570|map-value">
                  <cast as="xs:string" emptiable="1">
                   <attVal name="Q{}resource" chk="0"/>
                  </cast>
                 </check>
                 <fn name="exists">
                  <axis name="attribute" nodeTest="attribute(Q{}action)" jsTest="return item.name==='action'"/>
                 </fn>
                 <check card="1" diag="3|0|XTTE0570|map-value">
                  <cast as="xs:string" emptiable="1">
                   <attVal name="Q{}action" chk="0"/>
                  </cast>
                 </check>
                 <true/>
                 <str val="null"/>
                </choose>
               </ifCall>
              </forEach>
              <map size="2">
               <str val="duplicates"/>
               <str val="reject"/>
               <str val="duplicates-error-code"/>
               <str val="XTDE3365"/>
              </map>
             </ifCall>
            </withParam>
           </applyT>
          </resultDoc>
         </sequence>
        </let>
       </let>
      </let>
     </let>
    </let>
   </sequence>
  </template>
 </co>
 <co id="44" binds="39">
  <template name="Q{}HTTPsubmit" cxt="map(*)" jsTest="return SaxonJS.U.isMap(item)" flags="s" line="1094" module="saxon-xforms.xsl" slots="1">
   <let role="body" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="1099" var="responseXML" as="item()*" slot="0" eval="3">
    <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
     <dot type="map(*)"/>
     <str val="body"/>
    </ifCall>
    <sequence line="1103">
     <message>
      <sequence role="select">
       <valueOf>
        <str val="Response: "/>
       </valueOf>
       <valueOf>
        <fn name="serialize">
         <dot line="1102" type="map(*)"/>
        </fn>
       </valueOf>
      </sequence>
      <str role="terminate" val="no"/>
      <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
     </message>
     <choose line="1106">
      <fn name="empty">
       <varRef name="responseXML" slot="0"/>
      </fn>
      <callT line="1107" name="serverError" bSlot="0" flags="t">
       <withParam name="Q{}responseMap" flags="c" as="map(*)">
        <dot line="1108" type="map(*)"/>
       </withParam>
      </callT>
      <true/>
      <message line="1114">
       <sequence role="select">
        <valueOf>
         <str val="Response: "/>
        </valueOf>
        <valueOf>
         <fn name="serialize">
          <varRef name="responseXML" slot="0"/>
         </fn>
        </valueOf>
       </sequence>
       <str role="terminate" val="no"/>
       <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
      </message>
     </choose>
    </sequence>
   </let>
  </template>
 </co>
 <co id="36" binds="">
  <function name="Q{http://www.w3.org/2002/xforms}instance" line="86" module="xforms-function-library.xsl" eval="7" flags="pU" as="document-node()" slots="1">
   <arg name="instance-id" as="xs:string"/>
   <doc role="body" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="89">
    <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
     <check card="1" diag="0|0||ixsl:call">
      <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
     </check>
     <str val="getInstance"/>
     <arrayBlock>
      <varRef name="instance-id" slot="0"/>
     </arrayBlock>
    </ifCall>
   </doc>
  </function>
 </co>
 <co id="45" binds="4 35 34 14 34 7 29 12 44">
  <mode name="Q{http://saxonica.com/ns/interactiveXSLT}onclick" onNo="TC" flags="W" patternSlots="0">
   <templateRule prec="0" prio="0.5" seq="1" rank="0" minImp="0" slots="0" flags="s" line="2092" module="saxon-xforms.xsl">
    <p.withPredicate role="match">
     <p.nodeTest test="element(Q{}select)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri===''&amp;&amp;q.local==='select';"/>
     <fn ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2092" name="exists">
      <axis name="attribute" nodeTest="attribute(Q{}data-action)" jsTest="return item.name==='data-action'"/>
     </fn>
    </p.withPredicate>
    <empty role="action"/>
   </templateRule>
   <templateRule prec="0" prio="0.5" seq="2" rank="0" minImp="0" slots="30" flags="s" line="2095" module="saxon-xforms.xsl">
    <p.withPredicate role="match">
     <p.nodeTest test="element(Q{}button)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri===''&amp;&amp;q.local==='button';"/>
     <fn ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2095" name="exists">
      <axis name="attribute" nodeTest="attribute(Q{}data-action)" jsTest="return item.name==='data-action'"/>
     </fn>
    </p.withPredicate>
    <let role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2097" var="action-ref" as="attribute(Q{}data-action)?" slot="0" eval="8">
     <axis name="attribute" nodeTest="attribute(Q{}data-action)" jsTest="return item.name==='data-action'"/>
     <let line="2100" var="action-map" as="item()?" slot="1" eval="8">
      <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
       <check card="1" diag="0|0||ixsl:call">
        <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
       </check>
       <str val="getAction"/>
       <arrayBlock>
        <fn name="string">
         <axis name="attribute" nodeTest="attribute(Q{}data-action)" jsTest="return item.name==='data-action'"/>
        </fn>
       </arrayBlock>
      </ifCall>
      <let line="2117" var="updatedInstanceXML" as="document-node()" slot="2" eval="7">
       <doc line="2119" validation="preserve">
        <applyT mode="Q{}form-check-initial" bSlot="0">
         <ufCall role="select" line="2116" name="Q{http://www.w3.org/2002/xforms}getInstance-JS" tailCall="false" bSlot="1" eval="7">
          <check card="1" diag="0|0||xforms:getInstance-JS">
           <cvUntyped to="xs:string">
            <data>
             <varRef name="action-ref" slot="0"/>
            </data>
           </cvUntyped>
          </check>
         </ufCall>
        </applyT>
       </doc>
       <sequence line="2122">
        <ufCall name="Q{http://www.w3.org/2002/xforms}setInstance-JS" tailCall="false" bSlot="2" eval="7 6">
         <check card="1" diag="0|0||xforms:setInstance-JS">
          <cvUntyped to="xs:string">
           <data>
            <varRef name="action-ref" slot="0"/>
           </data>
          </cvUntyped>
         </check>
         <varRef name="updatedInstanceXML" slot="2"/>
        </ufCall>
        <let line="2125" var="xforms-doc" as="item()?" slot="3" eval="8">
         <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
          <check card="1" diag="0|0||ixsl:call">
           <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
          </check>
          <str val="getXFormsDoc"/>
          <arrayBlock/>
         </ifCall>
         <sequence line="2127">
          <message>
           <sequence role="select">
            <valueOf>
             <str val=" instanceXML XXX= "/>
            </valueOf>
            <valueOf line="2128">
             <fn name="serialize">
              <varRef name="updatedInstanceXML" slot="2"/>
             </fn>
            </valueOf>
           </sequence>
           <str role="terminate" val="no"/>
           <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
          </message>
          <forEach line="2133">
           <ifCall line="2102" name="Q{http://www.w3.org/2005/xpath-functions/map}keys" type="xs:anyAtomicType*">
            <treat as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="0|0||map:keys">
             <check card="1" diag="0|0||map:keys">
              <varRef name="action-map" slot="1"/>
             </check>
            </treat>
           </ifCall>
           <choose line="2136">
            <gc op="=" card="1:1" comp="GAC|http://www.w3.org/2005/xpath-functions/collation/codepoint">
             <dot type="xs:anyAtomicType"/>
             <str val="insert"/>
            </gc>
            <let line="2167" var="vv:v1" as="xs:string" slot="4" eval="13">
             <check card="1" diag="0|0||xforms:setInstance-JS">
              <cvUntyped to="xs:string">
               <data>
                <varRef name="action-ref" slot="0"/>
               </data>
              </cvUntyped>
             </check>
             <let line="2151" var="vv:v0" as="xs:string" slot="5" eval="13">
              <fn name="serialize">
               <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
                <treat as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="0|0||map:get">
                 <check card="1" diag="0|0||map:get">
                  <varRef name="action-map" slot="1"/>
                 </check>
                </treat>
                <str val="insert"/>
               </ifCall>
              </fn>
              <forEach line="2142">
               <ifCall name="Q{http://www.w3.org/2005/xpath-functions/array}flatten" type="item()*">
                <ifCall line="2139" name="Q{http://www.w3.org/2005/xpath-functions/array}flatten" type="item()*">
                 <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
                  <treat as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="0|0||map:get">
                   <check card="1" diag="0|0||map:get">
                    <varRef name="action-map" slot="1"/>
                   </check>
                  </treat>
                  <str val="insert"/>
                 </ifCall>
                </ifCall>
               </ifCall>
               <let line="2144" var="map-ref" as="item()*" slot="6" eval="3">
                <let var="vv:LHS1586189170" as="function(*)" slot="7" eval="7">
                 <treat as="function(*)" jsTest="return SaxonJS.U.isMap(item) || SaxonJS.U.isArray(item);" diag="3|0||vv:LHS1586189170">
                  <dot/>
                 </treat>
                 <choose>
                  <instance of="map(*)" jsTest="return SaxonJS.U.isMap(item)">
                   <varRef name="vv:LHS1586189170" slot="7"/>
                  </instance>
                  <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
                   <treat as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="0|0||map:get">
                    <varRef name="vv:LHS1586189170" slot="7"/>
                   </treat>
                   <str val="ref"/>
                  </ifCall>
                  <true/>
                  <error message="First argument of '?' must be a sequence of maps" code="XPTY0004" isTypeErr="0"/>
                 </choose>
                </let>
                <let line="2198" var="vv:v4" as="xs:anyAtomicType*" slot="8" eval="4">
                 <data>
                  <varRef name="map-ref" slot="6"/>
                 </data>
                 <let line="2172" var="vv:v3" as="xs:anyAtomicType*" slot="9" eval="4">
                  <data>
                   <varRef name="map-ref" slot="6"/>
                  </data>
                  <let line="2169" var="vv:v2" as="xs:anyAtomicType*" slot="10" eval="4">
                   <data>
                    <varRef name="map-ref" slot="6"/>
                   </data>
                   <let line="2145" var="insert-node" as="node()" slot="11" eval="7">
                    <treat line="2148" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="3|0|XTTE0570|insert-node">
                     <check card="1" diag="3|0|XTTE0570|insert-node">
                      <evaluate dxns="">
                       <fn role="xpath" name="concat">
                        <atomSing card="?" diag="0|0||fn:concat">
                         <varRef name="map-ref" slot="6"/>
                        </atomSing>
                        <str val="["/>
                        <str val="last()"/>
                        <str val="]"/>
                       </fn>
                       <varRef role="cxt" name="updatedInstanceXML" slot="2"/>
                       <str role="sa" val="no"/>
                       <map role="wp" size="0"/>
                      </evaluate>
                     </check>
                    </treat>
                    <sequence line="2150">
                     <message>
                      <sequence role="select">
                       <valueOf>
                        <str val="insert found !!!! insert = "/>
                       </valueOf>
                       <valueOf line="2151">
                        <varRef name="vv:v0" slot="5"/>
                       </valueOf>
                       <valueOf>
                        <str val=" ref = "/>
                       </valueOf>
                       <valueOf line="2152">
                        <fn name="string-join">
                         <convert from="xs:anyAtomicType" to="xs:string">
                          <data>
                           <mergeAdj>
                            <varRef name="map-ref" slot="6"/>
                           </mergeAdj>
                          </data>
                         </convert>
                         <str val=" "/>
                        </fn>
                       </valueOf>
                      </sequence>
                      <str role="terminate" val="no"/>
                      <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
                     </message>
                     <let line="2155" var="instance-with-insert" as="document-node()" slot="12" eval="7">
                      <doc line="2157" validation="preserve">
                       <applyT mode="Q{}insert-node" bSlot="3">
                        <varRef role="select" name="updatedInstanceXML" slot="2"/>
                        <withParam name="Q{}insert-node" as="node()">
                         <varRef line="2158" name="insert-node" slot="11"/>
                        </withParam>
                        <withParam name="Q{}path" as="xs:string">
                         <fn line="2160" name="concat">
                          <str val="/"/>
                          <atomSing card="?" diag="0|1||fn:concat">
                           <varRef name="map-ref" slot="6"/>
                          </atomSing>
                         </fn>
                        </withParam>
                       </applyT>
                      </doc>
                      <sequence line="2167">
                       <ufCall name="Q{http://www.w3.org/2002/xforms}setInstance-JS" tailCall="false" bSlot="4" eval="6 6">
                        <varRef name="vv:v1" slot="4"/>
                        <varRef name="instance-with-insert" slot="12"/>
                       </ufCall>
                       <let line="2169" var="node-to-copyi" as="element(Q{}div)" slot="13" eval="7">
                        <check card="1" diag="3|0|XTTE0570|node-to-copyi">
                         <docOrder intra="1">
                          <filter flags="b">
                           <slash>
                            <slash>
                             <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}page" type="document-node()?"/>
                             <fn name="key">
                              <str val="Q{http://saxon.sf.net/}kk103"/>
                              <varRef name="vv:v2" slot="10"/>
                              <dot type="document-node()"/>
                             </fn>
                            </slash>
                            <axis name="child" nodeTest="element(Q{}div)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri===''&amp;&amp;q.local==='div';"/>
                           </slash>
                           <fn name="empty">
                            <axis module="saxon-xforms.xsl" line="2169" name="following-sibling" nodeTest="element(Q{}div)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri===''&amp;&amp;q.local==='div';"/>
                           </fn>
                          </filter>
                         </docOrder>
                        </check>
                        <let line="2172" var="newNodePosition" as="xs:integer" slot="14" eval="7">
                         <arith op="+" calc="i+i">
                          <fn name="count">
                           <docOrder intra="1">
                            <slash>
                             <slash>
                              <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}page" type="document-node()?"/>
                              <fn name="key">
                               <str val="Q{http://saxon.sf.net/}kk103"/>
                               <varRef name="vv:v3" slot="9"/>
                               <dot type="document-node()"/>
                              </fn>
                             </slash>
                             <axis name="child" nodeTest="element(Q{}div)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri===''&amp;&amp;q.local==='div';"/>
                            </slash>
                           </docOrder>
                          </fn>
                          <int val="1"/>
                         </arith>
                         <let line="2174" var="newNodeCPath" as="xs:string" slot="15" eval="7">
                          <treat as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="3|0|XTTE0570|newNodeCPath">
                           <check card="1" diag="3|0|XTTE0570|newNodeCPath">
                            <cvUntyped to="xs:string">
                             <data>
                              <varRef name="map-ref" slot="6"/>
                             </data>
                            </cvUntyped>
                           </check>
                          </treat>
                          <let line="2177" var="path-updated" as="xs:string" slot="16" eval="7">
                           <choose>
                            <compareToInt op="gt" val="0">
                             <varRef name="newNodePosition" slot="14"/>
                            </compareToInt>
                            <fn name="concat">
                             <varRef name="newNodeCPath" slot="15"/>
                             <str val="["/>
                             <varRef name="newNodePosition" slot="14"/>
                             <str val="]"/>
                            </fn>
                            <true/>
                            <varRef name="newNodeCPath" slot="15"/>
                           </choose>
                           <let line="2184" var="copied-node" as="node()" slot="17" eval="7">
                            <treat line="2185" as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="3|0|XTTE0570|copied-node">
                             <check card="1" diag="3|0|XTTE0570|copied-node">
                              <applyT mode="Q{}update-ref" bSlot="5">
                               <varRef role="select" name="node-to-copyi" slot="13"/>
                               <withParam name="Q{}path">
                                <varRef line="2186" name="map-ref" slot="6"/>
                               </withParam>
                               <withParam name="Q{}position" as="xs:integer">
                                <varRef line="2187" name="newNodePosition" slot="14"/>
                               </withParam>
                              </applyT>
                             </check>
                            </treat>
                            <sequence line="2193">
                             <message>
                              <sequence role="select">
                               <valueOf>
                                <str val="node to copy= "/>
                               </valueOf>
                               <valueOf>
                                <fn name="serialize">
                                 <varRef name="node-to-copyi" slot="13"/>
                                </fn>
                               </valueOf>
                               <valueOf>
                                <str val="&#xA;                            node to copy with updated ref = "/>
                               </valueOf>
                               <valueOf line="2194">
                                <fn name="serialize">
                                 <varRef name="copied-node" slot="17"/>
                                </fn>
                               </valueOf>
                              </sequence>
                              <str role="terminate" val="no"/>
                              <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
                             </message>
                             <forEach line="2198">
                              <slash>
                               <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}page" type="document-node()?"/>
                               <fn name="key">
                                <str val="Q{http://saxon.sf.net/}kk103"/>
                                <varRef name="vv:v4" slot="8"/>
                                <dot type="document-node()"/>
                               </fn>
                              </slash>
                              <resultDoc line="2200" global="#&#xD;&#xA;#Fri Jun 29 11:35:20 BST 2018&#xD;&#xA;indent=no&#xD;&#xA;doctype-system=http\://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#xD;&#xA;encoding=utf-8&#xD;&#xA;doctype-public=-//W3C//DTD XHTML 1.0 Transitional//EN&#xD;&#xA;omit-xml-declaration=no&#xD;&#xA;method=html&#xD;&#xA;" local="#&#xD;&#xA;#Fri Jun 29 11:35:20 BST 2018&#xD;&#xA;method={http\://saxonica.com/ns/interactiveXSLT}append-content&#xD;&#xA;">
                               <str role="href" val="?."/>
                               <copyOf role="content" line="2201" flags="vc">
                                <varRef name="copied-node" slot="17"/>
                               </copyOf>
                              </resultDoc>
                             </forEach>
                             <forEach line="2209">
                              <filter line="2208" flags="b">
                               <slash simple="1">
                                <varRef name="node-to-copyi" slot="13"/>
                                <axis name="descendant" nodeTest="element()" jsTest="return item.nodeType===1;"/>
                               </slash>
                               <or op="or">
                                <fn name="exists">
                                 <axis name="attribute" nodeTest="attribute(Q{}data-ref)" jsTest="return item.name==='data-ref'"/>
                                </fn>
                                <fn name="exists">
                                 <axis name="attribute" nodeTest="attribute(Q{}data-action)" jsTest="return item.name==='data-action'"/>
                                </fn>
                               </or>
                              </filter>
                              <let line="2211" var="dataActionRef" as="xs:string?" slot="18" eval="8">
                               <cvUntyped to="xs:string">
                                <attVal name="Q{}data-action" chk="0"/>
                               </cvUntyped>
                               <choose line="2213">
                                <fn name="exists">
                                 <varRef name="dataActionRef" slot="18"/>
                                </fn>
                                <let line="2215" var="actionEvents" as="map(*)?" slot="19" eval="7">
                                 <treat as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="3|0|XTTE0570|actionEvents">
                                  <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
                                   <check card="1" diag="0|0||ixsl:call">
                                    <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
                                   </check>
                                   <str val="getAction"/>
                                   <arrayBlock>
                                    <fn name="string">
                                     <varRef name="dataActionRef" slot="18"/>
                                    </fn>
                                   </arrayBlock>
                                  </ifCall>
                                 </treat>
                                 <let line="2219" var="dataRefForNewNode" as="xs:string?" slot="20" eval="7">
                                  <check card="?" diag="3|0|XTTE0570|dataRefForNewNode">
                                   <cvUntyped to="xs:string">
                                    <data>
                                     <slash>
                                      <filter flags="b">
                                       <slash simple="1">
                                        <varRef name="copied-node" slot="17"/>
                                        <axis name="descendant" nodeTest="element()" jsTest="return item.nodeType===1;"/>
                                       </slash>
                                       <gc op="=" card="1:1" comp="CCC">
                                        <attVal name="Q{}data-old-action" chk="0"/>
                                        <varRef name="dataActionRef" slot="18"/>
                                       </gc>
                                      </filter>
                                      <axis name="attribute" nodeTest="attribute(Q{}data-ref)" jsTest="return item.name==='data-ref'"/>
                                     </slash>
                                    </data>
                                   </cvUntyped>
                                  </check>
                                  <ifCall line="2248" name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
                                   <check card="1" diag="0|0||ixsl:call">
                                    <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
                                   </check>
                                   <str val="addAction"/>
                                   <arrayBlock>
                                    <check line="2218" card="1" diag="3|0|XTTE0570|newActionId">
                                     <cvUntyped to="xs:string">
                                      <data>
                                       <slash>
                                        <filter flags="b">
                                         <slash simple="1">
                                          <varRef name="copied-node" slot="17"/>
                                          <axis name="descendant" nodeTest="element()" jsTest="return item.nodeType===1;"/>
                                         </slash>
                                         <gc op="=" card="1:1" comp="CCC">
                                          <attVal name="Q{}data-old-action" chk="0"/>
                                          <varRef name="dataActionRef" slot="18"/>
                                         </gc>
                                        </filter>
                                        <axis name="attribute" nodeTest="attribute(Q{}data-action)" jsTest="return item.name==='data-action'"/>
                                       </slash>
                                      </data>
                                     </cvUntyped>
                                    </check>
                                    <forEach line="2222">
                                     <varRef name="actionEvents" slot="19"/>
                                     <let line="2223" var="myContext" as="map(*)" slot="21" eval="7">
                                      <dot type="map(*)"/>
                                      <let line="2225" var="refExsists" as="xs:boolean" slot="22" eval="8">
                                       <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}contains" type="xs:boolean">
                                        <varRef name="myContext" slot="21"/>
                                        <str val="@ref"/>
                                       </ifCall>
                                       <choose line="2228">
                                        <and op="and">
                                         <varRef name="refExsists" slot="22"/>
                                         <fn name="exists">
                                          <varRef name="dataRefForNewNode" slot="20"/>
                                         </fn>
                                        </and>
                                        <ifCall line="2231" name="Q{http://www.w3.org/2005/xpath-functions/map}put" type="map(*)">
                                         <varRef name="myContext" slot="21"/>
                                         <str val="@ref"/>
                                         <fn name="string">
                                          <varRef name="dataRefForNewNode" slot="20"/>
                                         </fn>
                                        </ifCall>
                                        <varRef line="2233" name="refExsists" slot="22"/>
                                        <ifCall line="2237" name="Q{http://www.w3.org/2005/xpath-functions/map}put" type="map(*)">
                                         <varRef name="myContext" slot="21"/>
                                         <str val="@ref"/>
                                         <fn line="2235" name="concat">
                                          <varRef name="path-updated" slot="16"/>
                                          <fn line="2234" name="substring">
                                           <treat as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="3|0|XTTE0570|contextRef">
                                            <check card="1" diag="3|0|XTTE0570|contextRef">
                                             <cvUntyped to="xs:string">
                                              <data>
                                               <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
                                                <varRef name="myContext" slot="21"/>
                                                <str val="@ref"/>
                                               </ifCall>
                                              </data>
                                             </cvUntyped>
                                            </check>
                                           </treat>
                                           <arith line="2235" op="+" calc="i+i">
                                            <fn name="string-length">
                                             <varRef name="path-updated" slot="16"/>
                                            </fn>
                                            <int val="1"/>
                                           </arith>
                                          </fn>
                                         </fn>
                                        </ifCall>
                                        <true/>
                                        <dot line="2240" type="map(*)"/>
                                       </choose>
                                      </let>
                                     </let>
                                    </forEach>
                                   </arrayBlock>
                                  </ifCall>
                                 </let>
                                </let>
                               </choose>
                              </let>
                             </forEach>
                            </sequence>
                           </let>
                          </let>
                         </let>
                        </let>
                       </let>
                      </sequence>
                     </let>
                    </sequence>
                   </let>
                  </let>
                 </let>
                </let>
               </let>
              </forEach>
             </let>
            </let>
            <gc line="2256" op="=" card="1:1" comp="GAC|http://www.w3.org/2005/xpath-functions/collation/codepoint">
             <dot type="xs:anyAtomicType"/>
             <str val="delete"/>
            </gc>
            <let line="2262" var="action-refi" as="xs:string?" slot="23" eval="7">
             <treat as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="3|0|XTTE0570|action-refi">
              <check card="?" diag="3|0|XTTE0570|action-refi">
               <cvUntyped to="xs:string">
                <data>
                 <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
                  <treat as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="0|0||map:get">
                   <check card="1" diag="0|0||map:get">
                    <varRef name="action-map" slot="1"/>
                   </check>
                  </treat>
                  <str val="@ref"/>
                 </ifCall>
                </data>
               </cvUntyped>
              </check>
             </treat>
             <forEach line="2264">
              <ifCall line="2259" name="Q{http://www.w3.org/2005/xpath-functions/array}flatten" type="item()*">
               <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
                <treat as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="0|0||map:get">
                 <check card="1" diag="0|0||map:get">
                  <varRef name="action-map" slot="1"/>
                 </check>
                </treat>
                <str val="delete"/>
               </ifCall>
              </ifCall>
              <let line="2265" var="if-clause" as="xs:string" slot="24" eval="7">
               <treat as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="3|0|XTTE0570|if-clause">
                <check card="1" diag="3|0|XTTE0570|if-clause">
                 <cvUntyped to="xs:string">
                  <let var="vv:LHS204261088" as="function(*)" slot="25" eval="7">
                   <treat as="function(*)" jsTest="return SaxonJS.U.isMap(item) || SaxonJS.U.isArray(item);" diag="3|0||vv:LHS204261088">
                    <dot/>
                   </treat>
                   <choose>
                    <instance of="map(*)" jsTest="return SaxonJS.U.isMap(item)">
                     <varRef name="vv:LHS204261088" slot="25"/>
                    </instance>
                    <data>
                     <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
                      <treat module="saxon-xforms.xsl" line="2265" as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="0|0||map:get">
                       <varRef name="vv:LHS204261088" slot="25"/>
                      </treat>
                      <str val="if"/>
                     </ifCall>
                    </data>
                    <true/>
                    <data>
                     <error message="First argument of '?' must be a sequence of maps" code="XPTY0004" isTypeErr="0"/>
                    </data>
                   </choose>
                  </let>
                 </cvUntyped>
                </check>
               </treat>
               <let line="2266" var="delete-ref" as="xs:string" slot="26" eval="7">
                <treat as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="3|0|XTTE0570|delete-ref">
                 <check card="1" diag="3|0|XTTE0570|delete-ref">
                  <cvUntyped to="xs:string">
                   <let var="vv:LHS1141848496" as="function(*)" slot="27" eval="7">
                    <treat as="function(*)" jsTest="return SaxonJS.U.isMap(item) || SaxonJS.U.isArray(item);" diag="3|0||vv:LHS1141848496">
                     <dot/>
                    </treat>
                    <choose>
                     <instance of="map(*)" jsTest="return SaxonJS.U.isMap(item)">
                      <varRef name="vv:LHS1141848496" slot="27"/>
                     </instance>
                     <data>
                      <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
                       <treat module="saxon-xforms.xsl" line="2266" as="map(*)" jsTest="return SaxonJS.U.isMap(item)" diag="0|0||map:get">
                        <varRef name="vv:LHS1141848496" slot="27"/>
                       </treat>
                       <str val="ref"/>
                      </ifCall>
                     </data>
                     <true/>
                     <data>
                      <error message="First argument of '?' must be a sequence of maps" code="XPTY0004" isTypeErr="0"/>
                     </data>
                    </choose>
                   </let>
                  </cvUntyped>
                 </check>
                </treat>
                <let line="2268" var="if-statement" as="xs:boolean" slot="28" eval="7">
                 <choose line="2270">
                  <fn name="empty">
                   <varRef name="if-clause" slot="24"/>
                  </fn>
                  <true/>
                  <true/>
                  <treat line="2273" as="xs:boolean" jsTest="return SaxonJS.U.Atomic.boolean.matches(item);" diag="3|0|XTTE0570|if-statement">
                   <check card="1" diag="3|0|XTTE0570|if-statement">
                    <cvUntyped to="xs:boolean">
                     <data>
                      <evaluate dxns="">
                       <varRef role="xpath" name="if-clause" slot="24"/>
                       <varRef role="cxt" name="updatedInstanceXML" slot="2"/>
                       <str role="sa" val="no"/>
                       <map role="wp" size="0"/>
                      </evaluate>
                     </data>
                    </cvUntyped>
                   </check>
                  </treat>
                 </choose>
                 <choose line="2282">
                  <varRef name="if-statement" slot="28"/>
                  <let line="2283" var="instance-with-delete" as="document-node()" slot="29" eval="7">
                   <doc line="2285" validation="preserve">
                    <applyT mode="Q{}delete-node" bSlot="6">
                     <varRef role="select" name="updatedInstanceXML" slot="2"/>
                     <withParam name="Q{}path" as="xs:string">
                      <choose line="2279">
                       <vc op="eq" onEmpty="0" comp="CCC">
                        <varRef name="delete-ref" slot="26"/>
                        <str val="."/>
                       </vc>
                       <fn name="concat">
                        <str val="/"/>
                        <varRef name="action-refi" slot="23"/>
                       </fn>
                       <true/>
                       <fn name="concat">
                        <choose>
                         <fn name="exists">
                          <varRef name="action-refi" slot="23"/>
                         </fn>
                         <fn name="concat">
                          <str val="/"/>
                          <varRef name="action-refi" slot="23"/>
                         </fn>
                         <true/>
                         <str val=""/>
                        </choose>
                        <str val="/"/>
                        <varRef name="delete-ref" slot="26"/>
                       </fn>
                      </choose>
                     </withParam>
                    </applyT>
                   </doc>
                   <sequence line="2294">
                    <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
                     <check card="1" diag="0|0||ixsl:call">
                      <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
                     </check>
                     <str val="setInstance"/>
                     <arrayBlock>
                      <varRef name="instance-with-delete" slot="29"/>
                     </arrayBlock>
                    </ifCall>
                    <callT line="2307" name="xformsjs-main" bSlot="7">
                     <withParam name="Q{}xforms-doc" flags="c" as="document-node()?">
                      <treat line="2308" as="document-node()" jsTest="return SaxonJS.U.isNode(item) &amp;&amp; (item.nodeType===9||item.nodeType===11);" diag="8|0|XTTE0590|xforms-doc">
                       <varRef name="xforms-doc" slot="3"/>
                      </treat>
                     </withParam>
                     <withParam name="Q{}instance-xml" flags="c" as="document-node()">
                      <varRef line="2309" name="instance-with-delete" slot="29"/>
                     </withParam>
                     <withParam name="Q{}xFormsId" flags="c" as="xs:string">
                      <treat line="2310" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="8|0|XTTE0590|xFormsId">
                       <check card="1" diag="8|0|XTTE0590|xFormsId">
                        <cvUntyped to="xs:string">
                         <data>
                          <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}call" type="item()?">
                           <check card="1" diag="0|0||ixsl:call">
                            <ifCall name="Q{http://saxonica.com/ns/interactiveXSLT}window" type="item()?"/>
                           </check>
                           <str val="getXFormsID"/>
                           <arrayBlock/>
                          </ifCall>
                         </data>
                        </cvUntyped>
                       </check>
                      </treat>
                     </withParam>
                    </callT>
                   </sequence>
                  </let>
                 </choose>
                </let>
               </let>
              </let>
             </forEach>
            </let>
            <gc line="2321" op="=" card="1:1" comp="GAC|http://www.w3.org/2005/xpath-functions/collation/codepoint">
             <dot type="xs:anyAtomicType"/>
             <str val="reset"/>
            </gc>
            <message line="2322">
             <valueOf role="select">
              <str val="reset found !!!!"/>
             </valueOf>
             <str role="terminate" val="no"/>
             <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
            </message>
           </choose>
          </forEach>
         </sequence>
        </let>
       </sequence>
      </let>
     </let>
    </let>
   </templateRule>
   <templateRule prec="0" prio="0.5" seq="0" rank="0" minImp="0" slots="1" flags="s" line="999" module="saxon-xforms.xsl">
    <p.withPredicate role="match">
     <p.nodeTest test="element(Q{}button)" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1 &amp;&amp; q.uri===''&amp;&amp;q.local==='button';"/>
     <fn ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="999" name="exists">
      <axis name="attribute" nodeTest="attribute(Q{}data-submit)" jsTest="return item.name==='data-submit'"/>
     </fn>
    </p.withPredicate>
    <let role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="1021" var="action" as="document-node()" slot="0" eval="7">
     <doc line="1026" flags="t" validation="preserve">
      <valueOf flags="l">
       <convert from="xs:untypedAtomic" to="xs:string">
        <attVal name="Q{}data-submit" chk="0"/>
       </convert>
      </valueOf>
     </doc>
     <sequence line="1057">
      <message>
       <sequence role="select">
        <valueOf>
         <str val="&#xA;                    Sending HTTP request to '"/>
        </valueOf>
        <valueOf line="1058">
         <convert from="xs:untypedAtomic" to="xs:string">
          <data>
           <varRef name="action" slot="0"/>
          </data>
         </convert>
        </valueOf>
        <valueOf>
         <str val="'&#xA;                "/>
        </valueOf>
       </sequence>
       <str role="terminate" val="no"/>
       <str role="error" val="Q{http://www.w3.org/2005/xqt-errors}XTMM9000"/>
      </message>
      <ifCall line="1070" name="Q{http://saxonica.com/ns/interactiveXSLT}schedule-action" type="item()*">
       <int val="0"/>
       <empty/>
       <callT name="HTTPsubmit" bSlot="8"/>
       <ifCall line="1065" name="Q{http://www.w3.org/2005/xpath-functions/map}merge" type="map(*)">
        <sequence>
         <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
          <str val="body"/>
          <fn line="1036" name="serialize">
           <elem line="1033" name="TEST" nsuri="" namespaces="rdf xhtml js in fn map array ev">
            <elem name="surname" nsuri="" flags="l">
             <valueOf flags="Sl">
              <str val="Dunn"/>
             </valueOf>
            </elem>
           </elem>
          </fn>
         </ifCall>
         <map size="1">
          <str val="method"/>
          <str val="POST"/>
         </map>
         <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}entry" type="map(*)">
          <str val="href"/>
          <varRef name="action" slot="0"/>
         </ifCall>
         <map size="1">
          <str val="media-type"/>
          <str val="text/plain"/>
         </map>
        </sequence>
        <map size="2">
         <str val="duplicates"/>
         <str val="reject"/>
         <str val="duplicates-error-code"/>
         <str val="XQDY0137"/>
        </map>
       </ifCall>
      </ifCall>
     </sequence>
    </let>
   </templateRule>
  </mode>
 </co>
 <co id="31" binds="46">
  <template name="Q{}getBinding" flags="os" line="3311" module="saxon-xforms.xsl" slots="3">
   <sequence role="body" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="3312">
    <param name="Q{}this" slot="0" flags="r" as="element()">
     <treat role="conversion" as="element()" jsTest="return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1;" diag="8|0|XTTE0590|this">
      <check card="1" diag="8|0|XTTE0590|this">
       <supplied slot="0"/>
      </check>
     </treat>
    </param>
    <param line="3313" name="Q{}bindings" slot="1" flags="ti" as="map(xs:string, node())">
     <treat role="conversion" as="map(xs:string, node())" jsTest="function k(item) {return SaxonJS.U.Atomic.string.matches(item);};function v(item) {return SaxonJS.U.isNode(item);};function c(n) {return n==1;};return SaxonJS.U.isMap(item) &amp;&amp; item.conforms(k, v, c);" diag="8|0|XTTE0590|bindings">
      <check card="1" diag="8|0|XTTE0590|bindings">
       <supplied slot="1"/>
      </check>
     </treat>
    </param>
    <let line="3315" var="ref-binding" as="xs:string" slot="2" eval="7">
     <treat line="3316" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="3|0|XTTE0570|ref-binding">
      <check card="1" diag="3|0|XTTE0570|ref-binding">
       <cvUntyped to="xs:string">
        <data>
         <callT name="getBindingRef" bSlot="0">
          <withParam name="Q{}this" flags="c" as="element()">
           <treat line="3317" as="element()" jsTest="return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1;" diag="8|0|XTTE0590|this">
            <dot flags="a"/>
           </treat>
          </withParam>
         </callT>
        </data>
       </cvUntyped>
      </check>
     </treat>
     <choose line="3325">
      <fn name="empty">
       <varRef name="ref-binding" slot="2"/>
      </fn>
      <empty/>
      <true/>
      <ifCall name="Q{http://www.w3.org/2005/xpath-functions/map}get" type="item()*">
       <varRef name="bindings" slot="1"/>
       <varRef name="ref-binding" slot="2"/>
      </ifCall>
     </choose>
    </let>
   </sequence>
  </template>
 </co>
 <co id="47" binds="">
  <globalVariable name="Q{}default-instance-id" type="xs:string" line="32" module="saxon-xforms.xsl" visibility="PRIVATE" jsAcceptor="return SaxonJS.U.Atomic.string.cast(val);" jsCardCheck="function c(n) {return n==1;};">
   <str val="saxon-forms-default"/>
  </globalVariable>
 </co>
 <co id="46" binds="">
  <template name="Q{}getBindingRef" flags="os" line="3329" module="saxon-xforms.xsl" slots="1">
   <sequence role="body" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="3330">
    <param name="Q{}this" slot="0" flags="r" as="element()">
     <treat role="conversion" as="element()" jsTest="return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1;" diag="8|0|XTTE0590|this">
      <check card="1" diag="8|0|XTTE0590|this">
       <supplied slot="0"/>
      </check>
     </treat>
    </param>
    <choose line="3333">
     <fn name="exists">
      <slash simple="1">
       <varRef name="this" slot="0"/>
       <axis name="attribute" nodeTest="attribute(Q{}ref)" jsTest="return item.name==='ref'"/>
      </slash>
     </fn>
     <valueOf line="3334">
      <convert from="xs:untypedAtomic" to="xs:string">
       <data>
        <slash simple="1">
         <varRef name="this" slot="0"/>
         <axis name="attribute" nodeTest="attribute(Q{}ref)" jsTest="return item.name==='ref'"/>
        </slash>
       </data>
      </convert>
     </valueOf>
     <fn line="3336" name="exists">
      <slash simple="1">
       <varRef name="this" slot="0"/>
       <axis name="attribute" nodeTest="attribute(Q{}bind)" jsTest="return item.name==='bind'"/>
      </slash>
     </fn>
     <valueOf line="3337">
      <convert from="xs:untypedAtomic" to="xs:string">
       <data>
        <slash simple="1">
         <varRef name="this" slot="0"/>
         <axis name="attribute" nodeTest="attribute(Q{}bind)" jsTest="return item.name==='bind'"/>
        </slash>
       </data>
      </convert>
     </valueOf>
     <true/>
     <valueOf line="3340" flags="S">
      <str val=""/>
     </valueOf>
    </choose>
   </sequence>
  </template>
 </co>
 <co id="48" binds="">
  <globalVariable name="Q{}debugTiming" type="xs:boolean" line="31" module="saxon-xforms.xsl" visibility="PRIVATE" jsAcceptor="return SaxonJS.U.Atomic.boolean.cast(val);" jsCardCheck="function c(n) {return n==1;};">
   <false/>
  </globalVariable>
 </co>
 <co id="16" binds="16 16 16">
  <mode name="Q{}jxml-xml" onNo="TC" flags="W" patternSlots="0">
   <templateRule prec="0" prio="-0.25" seq="2" rank="0" minImp="0" slots="2" flags="s" line="3012" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="*:array" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1&amp;&amp;q.local==='array'"/>
    <let role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="3013" var="keyVar" as="attribute(Q{}key)?" slot="0" eval="8">
     <axis name="attribute" nodeTest="attribute(Q{}key)" jsTest="return item.name==='key'"/>
     <let line="3016" var="vv:v0" as="xs:string" slot="1" eval="13">
      <fn name="string">
       <convert from="xs:untypedAtomic" to="xs:string">
        <data>
         <varRef name="keyVar" slot="0"/>
        </data>
       </convert>
      </fn>
      <forEach line="3015">
       <axis name="child" nodeTest="element()" jsTest="return item.nodeType===1;"/>
       <compElem line="3016">
        <varRef role="name" name="vv:v0" slot="1"/>
        <applyT role="content" line="3017" mode="Q{}jxml-xml" bSlot="0">
         <dot role="select" type="element()"/>
        </applyT>
       </compElem>
      </forEach>
     </let>
    </let>
   </templateRule>
   <templateRule prec="0" prio="-0.25" seq="1" rank="0" minImp="0" slots="0" flags="s" line="2998" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="*:number" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1&amp;&amp;q.local==='number'"/>
    <choose role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="3000">
     <fn name="starts-with">
      <cvUntyped to="xs:string">
       <attVal name="Q{}key" chk="0"/>
      </cvUntyped>
      <str val="@"/>
     </fn>
     <compAtt line="3001">
      <fn role="name" name="substring">
       <cvUntyped to="xs:string">
        <attVal name="Q{}key" chk="0"/>
       </cvUntyped>
       <int val="2"/>
      </fn>
      <fn role="select" name="string-join">
       <convert from="xs:untypedAtomic" to="xs:string">
        <data>
         <mergeAdj>
          <axis name="child" nodeTest="text()" jsTest="return item.nodeType===3;"/>
         </mergeAdj>
        </data>
       </convert>
       <str val=" "/>
      </fn>
     </compAtt>
     <true/>
     <compElem line="3004">
      <fn role="name" name="string">
       <convert from="xs:untypedAtomic" to="xs:string">
        <attVal name="Q{}key" chk="0"/>
       </convert>
      </fn>
      <valueOf role="content" line="3005" flags="l">
       <fn name="string-join">
        <convert from="xs:untypedAtomic" to="xs:string">
         <data>
          <mergeAdj>
           <axis name="child" nodeTest="text()" jsTest="return item.nodeType===3;"/>
          </mergeAdj>
         </data>
        </convert>
        <str val=" "/>
       </fn>
      </valueOf>
     </compElem>
    </choose>
   </templateRule>
   <templateRule prec="0" prio="-0.25" seq="1" rank="0" minImp="0" slots="0" flags="s" line="2998" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="*:string" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1&amp;&amp;q.local==='string'"/>
    <choose role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="3000">
     <fn name="starts-with">
      <cvUntyped to="xs:string">
       <attVal name="Q{}key" chk="0"/>
      </cvUntyped>
      <str val="@"/>
     </fn>
     <compAtt line="3001">
      <fn role="name" name="substring">
       <cvUntyped to="xs:string">
        <attVal name="Q{}key" chk="0"/>
       </cvUntyped>
       <int val="2"/>
      </fn>
      <fn role="select" name="string-join">
       <convert from="xs:untypedAtomic" to="xs:string">
        <data>
         <mergeAdj>
          <axis name="child" nodeTest="text()" jsTest="return item.nodeType===3;"/>
         </mergeAdj>
        </data>
       </convert>
       <str val=" "/>
      </fn>
     </compAtt>
     <true/>
     <compElem line="3004">
      <fn role="name" name="string">
       <convert from="xs:untypedAtomic" to="xs:string">
        <attVal name="Q{}key" chk="0"/>
       </convert>
      </fn>
      <valueOf role="content" line="3005" flags="l">
       <fn name="string-join">
        <convert from="xs:untypedAtomic" to="xs:string">
         <data>
          <mergeAdj>
           <axis name="child" nodeTest="text()" jsTest="return item.nodeType===3;"/>
          </mergeAdj>
         </data>
        </convert>
        <str val=" "/>
       </fn>
      </valueOf>
     </compElem>
    </choose>
   </templateRule>
   <templateRule prec="0" prio="-0.25" seq="0" rank="0" minImp="0" slots="0" flags="s" line="2974" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="*:map" jsTest="var q=SaxonJS.U.nameOfNode(item); return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1&amp;&amp;q.local==='map'"/>
    <choose role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2976">
     <fn name="empty">
      <axis name="attribute" nodeTest="attribute(Q{}key)" jsTest="return item.name==='key'"/>
     </fn>
     <applyT line="2978" mode="Q{}jxml-xml" flags="t" bSlot="1">
      <axis role="select" name="child" nodeTest="element()" jsTest="return item.nodeType===1;"/>
     </applyT>
     <fn line="2983" name="starts-with">
      <cvUntyped to="xs:string">
       <attVal name="Q{}key" chk="0"/>
      </cvUntyped>
      <str val="@"/>
     </fn>
     <compAtt line="2984">
      <fn role="name" name="substring">
       <cvUntyped to="xs:string">
        <attVal name="Q{}key" chk="0"/>
       </cvUntyped>
       <int val="2"/>
      </fn>
      <convert role="select" from="xs:untypedAtomic" to="xs:string">
       <data>
        <dot type="*:map"/>
       </data>
      </convert>
     </compAtt>
     <true/>
     <compElem line="2987">
      <fn role="name" name="string">
       <convert from="xs:untypedAtomic" to="xs:string">
        <attVal name="Q{}key" chk="0"/>
       </convert>
      </fn>
      <applyT role="content" line="2988" mode="Q{}jxml-xml" bSlot="2">
       <axis role="select" name="child" nodeTest="element()" jsTest="return item.nodeType===1;"/>
      </applyT>
     </compElem>
    </choose>
   </templateRule>
  </mode>
 </co>
 <co id="2" binds="">
  <template name="Q{}getInstance" flags="os" as="element()?" line="3294" module="saxon-xforms.xsl" slots="2">
   <check role="body" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="3295" card="?" diag="7|0|XTTE0505|getInstance">
    <sequence>
     <param name="Q{}instance-id" slot="0" as="xs:string">
      <str role="select" val=""/>
      <treat role="conversion" as="xs:string" jsTest="return SaxonJS.U.Atomic.string.matches(item);" diag="8|0|XTTE0590|instance-id">
       <check card="1" diag="8|0|XTTE0590|instance-id">
        <cvUntyped to="xs:string">
         <data>
          <supplied slot="0"/>
         </data>
        </cvUntyped>
       </check>
      </treat>
     </param>
     <param line="3296" name="Q{}instances" slot="1" flags="t" as="element()*">
      <empty role="select"/>
      <treat role="conversion" as="element()" jsTest="return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1;" diag="8|0|XTTE0590|instances">
       <supplied slot="1"/>
      </treat>
     </param>
     <choose line="3300">
      <varRef name="instance-id" slot="0"/>
      <docOrder line="3301" intra="0">
       <slash>
        <filter flags="b">
         <varRef name="instances" slot="1"/>
         <gc op="=" card="1:1" comp="CCC">
          <attVal name="Q{}id" chk="0"/>
          <varRef name="instance-id" slot="0"/>
         </gc>
        </filter>
        <axis name="child" nodeTest="element()" jsTest="return item.nodeType===1;"/>
       </slash>
      </docOrder>
      <true/>
      <copyOf line="3306" flags="vc">
       <slash simple="1">
        <first>
         <varRef name="instances" slot="1"/>
        </first>
        <axis name="child" nodeTest="element()" jsTest="return item.nodeType===1;"/>
       </slash>
      </copyOf>
     </choose>
    </sequence>
   </check>
  </template>
 </co>
 <co id="41" binds="41 41 41">
  <mode name="Q{}json-xml" onNo="TC" flags="W" patternSlots="0">
   <templateRule prec="0" prio="-0.5" seq="0" rank="0" minImp="0" slots="0" flags="s" line="2894" module="saxon-xforms.xsl">
    <p.nodeTest role="match" test="element()" jsTest="return SaxonJS.U.isNode(item) &amp;&amp; item.nodeType===1;"/>
    <choose role="action" ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2899">
     <fn name="exists">
      <axis name="child" nodeTest="element()" jsTest="return item.nodeType===1;"/>
     </fn>
     <forEachGroup line="2900" algorithm="by">
      <sequence role="select">
       <axis name="attribute" nodeTest="attribute()" jsTest="return SaxonJS.U.isAttr(item)"/>
       <axis name="child" nodeTest="element()" jsTest="return item.nodeType===1;"/>
      </sequence>
      <fn role="key" name="local-name">
       <dot type="node()"/>
      </fn>
      <str role="collation" val="http://www.w3.org/2005/xpath-functions/collation/codepoint"/>
      <choose role="content" line="2902">
       <fn name="exists">
        <tail start="2">
         <currentGroup/>
        </tail>
       </fn>
       <elem line="2905" name="array" nsuri="http://www.w3.org/2005/xpath-functions" flags="d">
        <sequence>
         <att name="key" flags="l">
          <fn name="string-join">
           <convert from="xs:anyAtomicType" to="xs:string">
            <currentGroupingKey/>
           </convert>
           <str val=" "/>
          </fn>
         </att>
         <forEach line="2906">
          <currentGroup/>
          <elem line="2909" name="map" nsuri="http://www.w3.org/2005/xpath-functions" flags="dl">
           <applyT mode="Q{}json-xml" bSlot="0">
            <dot role="select"/>
           </applyT>
          </elem>
         </forEach>
        </sequence>
       </elem>
       <filter line="2916" flags="b">
        <currentGroup/>
        <fn name="exists">
         <slash simple="1">
          <treat as="node()" jsTest="return SaxonJS.U.isNode(item);" diag="14|12|XPTY0020|">
           <dot/>
          </treat>
          <axis name="self" nodeTest="attribute()" jsTest="return SaxonJS.U.isAttr(item)"/>
         </slash>
        </fn>
       </filter>
       <elem line="2921" name="string" nsuri="http://www.w3.org/2005/xpath-functions" flags="d">
        <sequence>
         <att name="key" flags="l">
          <fn name="concat">
           <str val="@"/>
           <check card="?" diag="0|1||fn:concat">
            <currentGroupingKey/>
           </check>
          </fn>
         </att>
         <valueOf line="2922" flags="l">
          <convert from="xs:anyAtomicType" to="xs:string">
           <data>
            <dot type="node()"/>
           </data>
          </convert>
         </valueOf>
        </sequence>
       </elem>
       <fn line="2927" name="exists">
        <slash>
         <currentGroup/>
         <axis name="child" nodeTest="element()" jsTest="return item.nodeType===1;"/>
        </slash>
       </fn>
       <elem line="2930" name="map" nsuri="http://www.w3.org/2005/xpath-functions" flags="d">
        <sequence>
         <att name="key" flags="l">
          <fn name="string-join">
           <convert from="xs:anyAtomicType" to="xs:string">
            <currentGroupingKey/>
           </convert>
           <str val=" "/>
          </fn>
         </att>
         <applyT line="2931" mode="Q{}json-xml" bSlot="1">
          <currentGroup role="select"/>
         </applyT>
        </sequence>
       </elem>
       <true/>
       <applyT line="2936" mode="Q{}json-xml" bSlot="2">
        <currentGroup role="select"/>
       </applyT>
      </choose>
     </forEachGroup>
     <fn line="2942" name="matches">
      <cvUntyped to="xs:string">
       <data>
        <dot type="element()"/>
       </data>
      </cvUntyped>
      <str val="^[0-9]+$"/>
      <str val=""/>
     </fn>
     <elem line="2944" name="number" nsuri="http://www.w3.org/2005/xpath-functions" flags="d">
      <sequence>
       <att name="key" flags="l">
        <fn name="local-name">
         <dot type="element()"/>
        </fn>
       </att>
       <valueOf line="2945" flags="l">
        <fn name="string-join">
         <convert from="xs:untypedAtomic" to="xs:string">
          <data>
           <mergeAdj>
            <axis name="child" nodeTest="text()" jsTest="return item.nodeType===3;"/>
           </mergeAdj>
          </data>
         </convert>
         <str val=" "/>
        </fn>
       </valueOf>
      </sequence>
     </elem>
     <true/>
     <elem line="2950" name="string" nsuri="http://www.w3.org/2005/xpath-functions" flags="d">
      <sequence>
       <att name="key" flags="l">
        <fn name="local-name">
         <dot type="element()"/>
        </fn>
       </att>
       <valueOf line="2951" flags="l">
        <fn name="string-join">
         <convert from="xs:untypedAtomic" to="xs:string">
          <data>
           <mergeAdj>
            <axis name="child" nodeTest="text()" jsTest="return item.nodeType===3;"/>
           </mergeAdj>
          </data>
         </convert>
         <str val=" "/>
        </fn>
       </valueOf>
      </sequence>
     </elem>
    </choose>
   </templateRule>
  </mode>
 </co>
 <overridden/>
 <key name="Q{http://saxon.sf.net/}kk101" line="0" binds="" flags="u">
  <p.nodeSet type="element()">
   <axis ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="596" name="descendant" nodeTest="element()" jsTest="return item.nodeType===1;"/>
  </p.nodeSet>
  <attVal ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="-1" name="Q{}data-ref" chk="0"/>
 </key>
 <key name="Q{http://saxon.sf.net/}kk102" line="0" binds="" flags="u">
  <p.nodeSet type="element()">
   <axis ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2054" name="child" nodeTest="element()" jsTest="return item.nodeType===1;"/>
  </p.nodeSet>
  <data ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2054">
   <axis name="child" nodeTest="element(Q{}data-action)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri===''&amp;&amp;q.local==='data-action';"/>
  </data>
 </key>
 <key name="Q{http://saxon.sf.net/}kk103" line="0" binds="" flags="u">
  <p.nodeSet type="element(Q{}div)">
   <axis ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="2169" name="descendant" nodeTest="element(Q{}div)" jsTest="var q=SaxonJS.U.nameOfNode(item); return item.nodeType===1 &amp;&amp; q.uri===''&amp;&amp;q.local==='div';"/>
  </p.nodeSet>
  <attVal ns="xforms=http://www.w3.org/2002/xforms in=http://www.w3.org/2002/xforms-instance fn=~ js=~ saxon=~ xf=http://www.w3.org/2002/xforms xhtml=http://www.w3.org/1999/xhtml xsl=~ ev=http://www.w3.org/2001/xml-events rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns# array=http://www.w3.org/2005/xpath-functions/array sfl=http://saxonica.com/ns/forms-local ixsl=~ xs=~ math=http://www.w3.org/2005/xpath-functions/math map=http://www.w3.org/2005/xpath-functions/map" line="-1" name="Q{}data-repeatable-context" chk="0"/>
 </key>
 <output>
  <property name="indent" value="no"/>
  <property name="doctype-system" value="http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"/>
  <property name="encoding" value="utf-8"/>
  <property name="doctype-public" value="-//W3C//DTD XHTML 1.0 Transitional//EN"/>
  <property name="omit-xml-declaration" value="no"/>
  <property name="{http://saxon.sf.net/}stylesheet-version" value="30"/>
  <property name="method" value="html"/>
 </output>
 <decimalFormat/>
</package>
<?Σ d056a2a2?>
